{
  "rules": [
    {
      "technology": "MuleSoft 4",
      "project_markers": [
        { "file": "pom.xml", "content": "mule-maven-plugin" },
        { "file": "mule-artifact.json", "content": "" } 
      ],
      "api_indicators": [
        { "file": "*.xml", "content": "http:listener-config", "score": 100, "description": "HTTP Listener Config", "extraction_regex": "basePath=\"([^\"]+)\"" },
        { "file": "*.xml", "content": "http:listener-config", "score": 0, "description": "HTTP Port", "extraction_regex": "port=\"([^\"]+)\"" },
        { "file": "*.xml", "content": "apikit:router", "score": 100, "description": "APIKit Router found" },
        { "file": "*.xml", "content": "soapkit:router", "score": 100, "description": "SOAPKit Router found" },
        { "file": "*.xml", "content": "batch:job", "score": 50, "description": "Batch Job detected" },
        { "file": "*.xml", "content": "jms:listener", "score": 20, "description": "JMS Listener detected" },
        { "file": "*.xml", "content": "scheduler", "score": 20, "description": "Scheduler detected", "extraction_regex": "frequency=\"([^\"]+)\"" }
      ]
    },
    {
      "technology": "Spring Boot",
      "project_markers": [
        { "file": "pom.xml", "content": "spring-boot-starter-web" }
      ],
      "api_indicators": [
        { "file": "*.java", "content": "@RestController", "score": 100, "description": "Spring RestController found" },
        { "file": "pom.xml", "content": "springdoc", "score": 20, "description": "OpenAPI/Swagger Dependency" },
        { "file": "*.java", "content": "@Scheduled", "score": 10, "description": "Scheduled Task detected" }
      ]
    },
    { "technology": "Tibco BW 5", "project_markers": [ { "file": "*.vcrepo", "content": "" }, { "file": ".folder", "content": "" }, { "file": "AESchema", "content": "" } ], "api_indicators": [ { "file": "*.archive", "content": "transport_http", "content_regex": "transport_http|http:connector|http:connection", "score": 100, "description": "HTTP Transport" } ] },
    { "technology": "Python Flask", "project_markers": [ { "file": "requirements.txt", "content": "flask" } ], "api_indicators": [ { "file": "*.py", "content": "@app.route", "score": 100, "description": "Flask Route", "extraction_regex": "@app\\.route\\(['\"]([^'\"]+)['\"]\\)" } ] }
  ],
  "metadata_rules": [
    { "category": "Documentation", "file": "README.md", "content": "", "value": "Present", "caseInsensitive": true },
    { "category": "Documentation", "file": "*.raml", "content": "", "value": "API Specification Found", "caseInsensitive": true },
    { "category": "Documentation", "file": "*.yaml", "content": "openapi", "value": "OpenAPI Specification Found", "caseInsensitive": true },
    
    { "category": "Security", "file": "pom.xml", "content": "spring-security", "value": "Spring Security Configured", "caseInsensitive": true },
    { "category": "Security", "file": "pom.xml", "content": "mule-secure-configuration-property", "value": "Mule Secure Properties Configured", "caseInsensitive": true },
    { "category": "Security", "file": "*.properties", "content": "secure::", "value": "Encrypted Properties Used", "caseInsensitive": false },
    
    { "category": "Logging", "file": "log4j2.xml", "content": "Console", "value": "Plain Text Logging (Bad Practice)", "caseInsensitive": true },
    { "category": "Logging", "file": "logback.xml", "content": "ConsoleAppender", "value": "Plain Text Logging (Bad Practice)", "caseInsensitive": true },
    { "category": "Logging", "file": "log4j2.xml", "content": "RollingFile", "value": "File-based Logging", "caseInsensitive": true },
    { "category": "Logging", "file": "*.java", "content": "System.out.println", "value": "Plain Text Logging (Bad Practice)", "caseInsensitive": false },
    
    { "category": "PII Risk", "file": "*.properties", "content": "password", "value": "Hardcoded Password Risk", "caseInsensitive": true },
    { "category": "PII Risk", "file": "*.properties", "content": "secret", "value": "Hardcoded Secret Risk", "caseInsensitive": true },
    { "category": "PII Risk", "file": "*.properties", "content": "key", "value": "API/Access Key Exposure", "caseInsensitive": true },
    { "category": "PII Risk", "file": "*.properties", "content": "aws", "value": "AWS Credentials Risk", "caseInsensitive": true },
    { "category": "PII Risk", "file": "*.properties", "content": "token", "value": "Token Exposure Risk", "caseInsensitive": true },
    { "category": "PII Risk", "file": "*.py", "content": "SECRET_KEY", "value": "Hardcoded Secret Risk", "caseInsensitive": true },
    { "category": "PII Risk", "file": "*.py", "content": "API_KEY", "value": "API Key Exposure", "caseInsensitive": true },
    { "category": "PII Risk", "file": "*.xml", "content": "password", "value": "Hardcoded Password Risk", "caseInsensitive": true },
    { "category": "PII Risk", "file": "*.xml", "content": "password", "value": "Hardcoded Password Risk", "caseInsensitive": true },
    { "category": "PII Risk", "file": "*.java", "content": "ssn", "value": "Potential PII (SSN) in Code", "caseInsensitive": true },

    { "category": "Governance: Standards", "file": "*.xml", "content": "http:listener", "value": "RESTful Architecture Followed", "caseInsensitive": true },
    { "category": "Governance: Standards", "file": "*.archive", "content": "transport_http", "value": "RESTful Architecture Followed", "caseInsensitive": true },
    { "category": "Governance: Documentation", "file": "*.raml", "content": "", "value": "RAML Specification Present", "caseInsensitive": true },
    { "category": "Governance: Documentation", "file": "*.yaml", "content": "openapi", "value": "OpenAPI Specification Present", "caseInsensitive": true },
    { "category": "Governance: Documentation", "file": "*.wsdl", "content": "", "value": "WSDL Specification Present", "caseInsensitive": true },
    { "category": "Governance: Gateway", "file": "*.xml", "content": "api-gateway:autodiscovery", "value": "API Gateway Managed", "caseInsensitive": true },
    { "category": "Governance: Gateway", "file": "pom.xml", "content": "mule.env", "value": "Environment Properties Configured", "caseInsensitive": true },
    { "category": "Governance: Versioning", "file": "pom.xml", "contentRegex": "<version>\\d+\\.\\d+\\.\\d+</version>", "value": "Semantic Versioning Used", "caseInsensitive": true },
    { "category": "Governance: Logging", "file": "log4j2.xml", "content": "SplunkHttp", "value": "Centralized Splunk Logging", "caseInsensitive": true },
    { "category": "Governance: Logging", "file": "log4j2.xml", "content": "SyslogAppender", "value": "Centralized Syslog Logging", "caseInsensitive": true },
    { "category": "Governance: Security", "file": "*.xml", "content": "oauth2-provider:config", "value": "OAuth2 Provider Enforced", "caseInsensitive": true },
    { "category": "Governance: Security", "file": "*.xml", "content": "client-id-enforcement", "value": "Client ID Enforcement", "caseInsensitive": true },
    { "category": "Governance: Security", "file": "*.xml", "content": "https:listener-config", "value": "HTTPS Secured Endpoint", "caseInsensitive": true }
  ]
}
