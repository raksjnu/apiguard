<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Aegis - Standard Rule Guide</title>
    <style>
        :root {
            --raks-purple: #663399;
            --raks-purple-light: #7d4fb2;
            --text-white: #FFFFFF;
            --sidebar-width: 300px;
        }
        html { height: 100%; margin: 0; padding: 0; }
        body { font-family: Arial, sans-serif; margin: 0; background-color: #f0f0f0; display: flex; height: 100%; overflow: hidden; width: 100%; }
        .sidebar {
            width: var(--sidebar-width);
            background: white;
            border-right: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
            min-width: 200px;
            max-width: 600px;
            flex-shrink: 0;
        }
        .sidebar-header {
            padding: 20px;
            background: var(--raks-purple);
            color: white;
        }
        .sidebar-header h2 { margin: 0; font-size: 1.2rem; color: white; }
        .sidebar-nav { list-style-type: none; padding: 0; overflow-y: auto; flex-grow: 1; }
        .sidebar-nav li { border-bottom: 1px solid #eee; }
        .sidebar-nav a { display: block; color: #333; padding: 15px 20px; text-decoration: none; font-size: 14px; display: flex; justify-content: space-between; align-items: center; }
        .sidebar-nav a:hover { background-color: #f5f5f5; color: #000; }
        .sidebar-nav a.active { background-color: var(--raks-purple); color: white; border-left: 4px solid #7d4fb2; }

        .rule-header { display: flex; align-items: center; width: 100%; cursor: pointer; }
        .rule-header:hover { background-color: #f5f5f5; }
        .rule-header a { flex-grow: 1; padding: 15px 10px; border: none; }
        .toggle-icon { padding: 15px 10px; color: #666; cursor: pointer; font-size: 10px; width: 20px; text-align: center; }
        .toggle-icon:hover { color: #000; }
        .sub-nav { list-style-type: none; padding: 0; display: none; background-color: #f9f9f9; border-top: 1px solid #eee; }
        .sub-nav.expanded { display: block; }
        .sub-nav li { border-bottom: 1px solid #eee; }
        .sub-nav a { padding: 8px 10px 8px 45px; font-size: 13px; color: #555; }
        .sub-nav a:hover { color: #000; background-color: #eee; }
        .sub-nav a.active { background-color: var(--raks-purple); color: white; font-weight: bold; }

        .main-content { flex: 1; padding: 40px; overflow-y: auto; background-color: white; position: relative; }
        .report-container {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 1400px;
            margin: 0 auto;
            border: 5px solid var(--raks-purple);
            position: relative;
        }
        .top-nav-container {
            position: absolute;
            top: 20px;
            right: 40px;
            display: flex;
            gap: 10px;
            z-index: 100;
        }
        .top-nav-button {
            background-color: var(--raks-purple);
            color: var(--text-white);
            border: none;
            padding: 8px 16px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .top-nav-button:hover { background-color: var(--raks-purple-light); }
        h1 { color: var(--raks-purple) !important; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 0; }
        h2 { color: var(--raks-purple) !important; margin-top: 30px; }
        h3 { color: var(--raks-purple-light) !important; }
        h4 { color: var(--raks-purple-light) !important; font-size: 1.1em; margin-top: 20px; }
        .rule-content { color: #333 !important; line-height: 1.6; }
        pre { background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto; border: 1px solid #ddd; }
        code { font-family: Consolas, monospace; color: #0078d4 !important; }
        code.inline-token { color: #0078d4 !important; font-weight: bold; }
        pre code { color: #333 !important; } /* Code blocks should be black text */
        table { border-collapse: collapse; width: 100%; margin: 20px 0; color: #333 !important; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: #f1f1f1; color: #333 !important; }
        blockquote { border-left: 4px solid var(--raks-purple); margin: 20px 0; padding: 10px 20px; color: #555; background-color: #f9f9f9; }
        .alert { padding: 15px; margin: 20px 0; border-left: 5px solid #eee; border-radius: 4px; }
        .alert.tip { background-color: #f3f9f1; border-color: #28a745; color: #1e4620; }
        .alert.important { background-color: #f5f0ff; border-color: #663399; color: #3c1e5a; }
        .alert.note { background-color: #f0f7ff; border-color: #0366d6; color: #004085; }
        .alert.warning { background-color: #fff9e6; border-color: #ffc107; color: #856404; }
        .alert.caution { background-color: #fff5f5; border-color: #dc3545; color: #721c24; }
        .search-highlight { background-color: #ffeb3b; color: black; font-weight: bold; border-radius: 2px; }
        ::highlight(search-results) { background-color: #ffeb3b; color: black; }
        .match-count { background: #663399; color: white; border-radius: 10px; padding: 2px 8px; font-size: 0.8em; margin-left: 10px; font-weight: bold; white-space: nowrap; }
        .resizer {
            width: 5px;
            background-color: #ddd;
            cursor: col-resize;
            transition: background-color 0.2s;
            z-index: 10;
        }
        .resizer:hover, .resizer.resizing {
            background-color: var(--raks-purple);
        }
    </style>
    <script>
        var currentFilter = "";
        var searchTimeout = null;
        var searchIndex = []; // { id: ruleId, content: upperCaseText }

        function buildIndex() {
            var rules = document.querySelectorAll('.rule-content');
            rules.forEach(function(el) {
                var id = el.id;
                var text = (el.textContent || el.innerText).toUpperCase();

                searchIndex.push({ id: id, content: text });
            });
            console.log("Search index built: " + searchIndex.length + " items.");
        }

        function showRule(event, ruleId, sectionId) {
            if (event) event.preventDefault();
            document.querySelectorAll('.rule-content').forEach(el => el.style.display = 'none');
            var contentDiv = document.getElementById(ruleId);
            if (contentDiv) {
                contentDiv.style.display = 'block';

                expandRuleTree(ruleId);

                if (sectionId) {
                    var section = document.getElementById(sectionId);
                    if (section) section.scrollIntoView({block: 'start'});
                } else {

                    document.querySelector('.main-content').scrollTop = 0;
                }

                setTimeout(function(){
                    applyHighlight(contentDiv, currentFilter, false);
                }, 0);
            }

            document.querySelectorAll('.sidebar-nav a').forEach(el => {
                el.classList.remove('active');
                var onclick = el.getAttribute('onclick');

                if (onclick && onclick.includes("'" + ruleId + "'")) {

                    if (!sectionId || (sectionId && onclick.includes("'" + sectionId + "'"))) {
                         el.classList.add('active');
                    }
                }
            });
        }

        function toggleSubNav(event, ruleId) {
            if(event) event.stopPropagation();
            var subNav = document.getElementById('sub-' + ruleId);
            var icon = event.target;
            if (subNav) {
                if (subNav.classList.contains('expanded')) {
                    subNav.classList.remove('expanded');
                    icon.innerHTML = '&#9654;'; // Right Arrow
                } else {
                    subNav.classList.add('expanded');
                    icon.innerHTML = '&#9660;'; // Down Arrow
                }
            }
        }

        function expandRuleTree(ruleId) {
            var subNav = document.getElementById('sub-' + ruleId);
            if (subNav && !subNav.classList.contains('expanded')) {
                subNav.classList.add('expanded');

                var header = subNav.previousElementSibling;
                if (header) {
                    var icon = header.querySelector('.toggle-icon');
                    if (icon) icon.innerHTML = '&#9660;';
                }
            }
        }

        function escapeRegExp(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        function applyHighlight(container, term, shouldScroll) {
            if (!container) return;

            if (window.CSS && CSS.highlights) {
                CSS.highlights.clear();
            }

            if (!term || term.length < 2) return;

            var ranges = [];
            var termUpper = term.toUpperCase();
            var walker = document.createTreeWalker(container, NodeFilter.SHOW_TEXT, null, false);
            var node;
            var matchCount = 0;
            var maxMatches = 100;

            while (node = walker.nextNode()) {
                if (matchCount >= maxMatches) break;
                var text = node.nodeValue;
                var valUpper = text.toUpperCase();
                var idx = valUpper.indexOf(termUpper);

                while (idx >= 0 && matchCount < maxMatches) {
                    var range = new Range();
                    range.setStart(node, idx);
                    range.setEnd(node, idx + term.length);
                    ranges.push(range);
                    matchCount++;
                    idx = valUpper.indexOf(termUpper, idx + term.length);
                }
            }

            if (window.CSS && CSS.highlights) {
                var highlight = new Highlight(...ranges);
                CSS.highlights.set("search-results", highlight);
            }

            if (shouldScroll && ranges.length > 0) {
                var firstRange = ranges[0];
                if (firstRange) {
                    var startNode = firstRange.startContainer;
                    var element = startNode.nodeType === 3 ? startNode.parentElement : startNode;
                    if (element) {
                        element.scrollIntoView({block: "center"});
                    }
                }
            }
        }

        function onSearchInput() {
            if (searchTimeout) clearTimeout(searchTimeout);

            searchTimeout = setTimeout(filterSidebar, 300);
        }

        function filterSidebar() {
            var input = document.getElementById("filterInput");
            currentFilter = input.value.trim().toUpperCase();

            var matchedIds = new Set();
            var matchesMap = {}; // id -> count

            if (currentFilter.length < 2) {

                var lis = document.getElementById("sidebarNav").getElementsByTagName("li");
                for (var i = 0; i < lis.length; i++) {
                    lis[i].style.display = "";
                    var a = lis[i].getElementsByTagName("a")[0];
                    var oldBadge = a.querySelector('.match-count');
                    if (oldBadge) oldBadge.remove();
                }
                return;
            }

            for (var i = 0; i < searchIndex.length; i++) {
                var item = searchIndex[i];
                var count = 0;

                if (item.id.toUpperCase().indexOf(currentFilter) > -1) {
                    count++;
                }

                var pos = item.content.indexOf(currentFilter);
                while (pos !== -1 && count < 101) {
                    count++;
                    pos = item.content.indexOf(currentFilter, pos + currentFilter.length);
                }

                if (count > 0) {
                    matchedIds.add(item.id);
                    matchesMap[item.id] = count;
                }
            }

            var ul = document.getElementById("sidebarNav");
            var lis = ul.getElementsByTagName("li");

            requestAnimationFrame(() => {
                for (var i = 0; i < lis.length; i++) {
                    var a = lis[i].getElementsByTagName("a")[0];

                    // Use data-rule-id for robustness
                    var ruleId = a.getAttribute("data-rule-id");
                    if (!ruleId) continue;

                    var oldBadge = a.querySelector('.match-count');
                    if (oldBadge) oldBadge.remove();

                    if (matchedIds.has(ruleId) || currentFilter === "") {
                        lis[i].style.display = "";
                        var count = matchesMap[ruleId] || 0;
                        if (count > 0) {
                            var badge = document.createElement("span");
                            badge.className = "match-count";
                            badge.innerText = count > 100 ? "100+" : count;
                            a.appendChild(badge);
                        }
                    } else {
                        lis[i].style.display = "none";
                    }
                }

                var visible = document.querySelector('.rule-content[style*="block"]');
                if (visible) {
                    applyHighlight(visible, currentFilter, false);
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function() {

            setTimeout(buildIndex, 100);

            var hash = window.location.hash;
            if (hash && hash.length > 1) {
                var ruleId = hash.substring(1); // Remove #

                if (document.getElementById(ruleId)) {
                    showRule(null, ruleId);
                }
            }

            const sidebar = document.getElementById('sidebar');
            const resizer = document.getElementById('resizer');
            if (!sidebar || !resizer) return;
            let isResizing = false;

            resizer.addEventListener('mousedown', function(e) {
                e.preventDefault(); // Critical: Prevents text selection during drag
                isResizing = true;
                resizer.classList.add('resizing');
                document.body.style.cursor = 'col-resize';
            });

            document.addEventListener('mousemove', function(e) {
                if (!isResizing) return;
                const newWidth = e.clientX;
                if (newWidth > 200 && newWidth < 800) {
                    sidebar.style.width = newWidth + 'px';
                }
            });

            document.addEventListener('mouseup', function(e) {
                if (isResizing) {
                    isResizing = false;
                    resizer.classList.remove('resizing');
                    document.body.style.cursor = '';
                }
            });
        });
    </script>
</head>
<body>
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                <div style="background: white; padding: 10px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <img src="logo.svg" alt="Aegis" style="height: 35px; display: block;">
                </div>
                <h1 style="margin: 0; font-size: 2rem; color: white !important; font-weight: bold; letter-spacing: 2px; border-bottom: none !important; padding-bottom: 0 !important;">AEGIS</h1>
            </div>
            <h2>Aegis Rules</h2>
            <input type="text" id="filterInput" onkeyup="onSearchInput()" placeholder="Search rules..."
                   style="width: 100%; padding: 8px; margin-top: 10px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px;">
        </div>
        <ul class="sidebar-nav" id="sidebarNav">
            <li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'QUICK_REFERENCE')">&#9654;</span><a href="#" onclick="showRule(event, 'QUICK_REFERENCE')" data-rule-id="QUICK_REFERENCE">QUICK_REFERENCE</a></div><ul class="sub-nav" id="sub-QUICK_REFERENCE"><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_1GlobalParameters')">1. Global Parameters</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_2PropertyResolutionProjectContext')">2. Property Resolution & Project Context</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_3RuleTypesParameters')">3. Rule Types & Parameters</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_4AvoidingFalsePositives')">4. Avoiding False Positives</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_5MessageTokensReference')">5. Message Tokens Reference</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'PROJECT_IDENTIFICATION')">&#9654;</span><a href="#" onclick="showRule(event, 'PROJECT_IDENTIFICATION')" data-rule-id="PROJECT_IDENTIFICATION">PROJECT_IDENTIFICATION</a></div><ul class="sub-nav" id="sub-PROJECT_IDENTIFICATION"><li><a href="#" onclick="showRule(event, 'PROJECT_IDENTIFICATION', 'PROJECT_IDENTIFICATION_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'PROJECT_IDENTIFICATION', 'PROJECT_IDENTIFICATION_Configuration')">Configuration</a></li><li><a href="#" onclick="showRule(event, 'PROJECT_IDENTIFICATION', 'PROJECT_IDENTIFICATION_ManagingMultipleTechnologies')">Managing Multiple Technologies</a></li><li><a href="#" onclick="showRule(event, 'PROJECT_IDENTIFICATION', 'PROJECT_IDENTIFICATION_BestPractices')">Best Practices</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'FILE_EXISTS')">&#9654;</span><a href="#" onclick="showRule(event, 'FILE_EXISTS')" data-rule-id="FILE_EXISTS">FILE_EXISTS</a></div><ul class="sub-nav" id="sub-FILE_EXISTS"><li><a href="#" onclick="showRule(event, 'FILE_EXISTS', 'FILE_EXISTS_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'FILE_EXISTS', 'FILE_EXISTS_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'FILE_EXISTS', 'FILE_EXISTS_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'FILE_EXISTS', 'FILE_EXISTS_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'FILE_EXISTS', 'FILE_EXISTS_RelatedCheckTypes')">Related Check Types</a></li><li><a href="#" onclick="showRule(event, 'FILE_EXISTS', 'FILE_EXISTS_SolutionPatternsandTechnologyReferences')">Solution Patterns and Technology References</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'GENERIC_TOKEN_SEARCH')">&#9654;</span><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH')" data-rule-id="GENERIC_TOKEN_SEARCH">GENERIC_TOKEN_SEARCH</a></div><ul class="sub-nav" id="sub-GENERIC_TOKEN_SEARCH"><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_ErrorConfigurationCustomization')">Error Configuration & Customization</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_RelatedRuleTypes')">Related Rule Types</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_SolutionPatternsandTechnologyReference')">Solution Patterns and Technology Reference</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN')">&#9654;</span><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN')" data-rule-id="GENERIC_TOKEN_SEARCH_FORBIDDEN">GENERIC_TOKEN_SEARCH_FORBIDDEN</a></div><ul class="sub-nav" id="sub-GENERIC_TOKEN_SEARCH_FORBIDDEN"><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_RelatedRuleTypes')">Related Rule Types</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_SolutionPatternsandTechnologyReference')">Solution Patterns and Technology Reference</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'GENERIC_TOKEN_SEARCH_REQUIRED')">&#9654;</span><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED')" data-rule-id="GENERIC_TOKEN_SEARCH_REQUIRED">GENERIC_TOKEN_SEARCH_REQUIRED</a></div><ul class="sub-nav" id="sub-GENERIC_TOKEN_SEARCH_REQUIRED"><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_RelatedRuleTypes')">Related Rule Types</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_SolutionPatternsandTechnologyReference')">Solution Patterns and Technology Reference</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'JSON_VALIDATION_FORBIDDEN')">&#9654;</span><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN')" data-rule-id="JSON_VALIDATION_FORBIDDEN">JSON_VALIDATION_FORBIDDEN</a></div><ul class="sub-nav" id="sub-JSON_VALIDATION_FORBIDDEN"><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN', 'JSON_VALIDATION_FORBIDDEN_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN', 'JSON_VALIDATION_FORBIDDEN_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN', 'JSON_VALIDATION_FORBIDDEN_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN', 'JSON_VALIDATION_FORBIDDEN_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN', 'JSON_VALIDATION_FORBIDDEN_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN', 'JSON_VALIDATION_FORBIDDEN_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'JSON_VALIDATION_REQUIRED')">&#9654;</span><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED')" data-rule-id="JSON_VALIDATION_REQUIRED">JSON_VALIDATION_REQUIRED</a></div><ul class="sub-nav" id="sub-JSON_VALIDATION_REQUIRED"><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'POM_VALIDATION_FORBIDDEN')">&#9654;</span><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN')" data-rule-id="POM_VALIDATION_FORBIDDEN">POM_VALIDATION_FORBIDDEN</a></div><ul class="sub-nav" id="sub-POM_VALIDATION_FORBIDDEN"><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_SolutionPatternsandTechnologyReferences')">Solution Patterns and Technology References</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'POM_VALIDATION_REQUIRED')">&#9654;</span><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED')" data-rule-id="POM_VALIDATION_REQUIRED">POM_VALIDATION_REQUIRED</a></div><ul class="sub-nav" id="sub-POM_VALIDATION_REQUIRED"><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_EnhancedReportingNEW')">Enhanced Reporting (NEW)</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_VersionComparisonLogicNEW')">Version Comparison Logic (NEW)</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_SolutionPatternsandTechnologyReferences')">Solution Patterns and Technology References</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'XML_ATTRIBUTE_EXISTS')">&#9654;</span><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS')" data-rule-id="XML_ATTRIBUTE_EXISTS">XML_ATTRIBUTE_EXISTS</a></div><ul class="sub-nav" id="sub-XML_ATTRIBUTE_EXISTS"><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_ValidationModes')">Validation Modes</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_SolutionPatternsandTechnologyReferences')">Solution Patterns and Technology References</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'XML_ATTRIBUTE_NOT_EXISTS')">&#9654;</span><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS')" data-rule-id="XML_ATTRIBUTE_NOT_EXISTS">XML_ATTRIBUTE_NOT_EXISTS</a></div><ul class="sub-nav" id="sub-XML_ATTRIBUTE_NOT_EXISTS"><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'XML_ELEMENT_CONTENT_FORBIDDEN')">&#9654;</span><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN')" data-rule-id="XML_ELEMENT_CONTENT_FORBIDDEN">XML_ELEMENT_CONTENT_FORBIDDEN</a></div><ul class="sub-nav" id="sub-XML_ELEMENT_CONTENT_FORBIDDEN"><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'XML_ELEMENT_CONTENT_REQUIRED')">&#9654;</span><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED')" data-rule-id="XML_ELEMENT_CONTENT_REQUIRED">XML_ELEMENT_CONTENT_REQUIRED</a></div><ul class="sub-nav" id="sub-XML_ELEMENT_CONTENT_REQUIRED"><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'XML_XPATH_EXISTS')">&#9654;</span><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')" data-rule-id="XML_XPATH_EXISTS">XML_XPATH_EXISTS</a></div><ul class="sub-nav" id="sub-XML_XPATH_EXISTS"><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_RelatedRuleTypes')">Related Rule Types</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_SolutionPatternsandTechnologyReferences')">Solution Patterns and Technology References</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'XML_XPATH_NOT_EXISTS')">&#9654;</span><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')" data-rule-id="XML_XPATH_NOT_EXISTS">XML_XPATH_NOT_EXISTS</a></div><ul class="sub-nav" id="sub-XML_XPATH_NOT_EXISTS"><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'CONDITIONAL_CHECK')">&#9654;</span><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK')" data-rule-id="CONDITIONAL_CHECK">CONDITIONAL_CHECK</a></div><ul class="sub-nav" id="sub-CONDITIONAL_CHECK"><li><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK', 'CONDITIONAL_CHECK_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK', 'CONDITIONAL_CHECK_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK', 'CONDITIONAL_CHECK_HowItWorks')">How It Works</a></li><li><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK', 'CONDITIONAL_CHECK_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK', 'CONDITIONAL_CHECK_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK', 'CONDITIONAL_CHECK_RelatedCheckTypes')">Related Check Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'GENERIC_PROPERTY_FILE_CHECK')">&#9654;</span><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK')" data-rule-id="GENERIC_PROPERTY_FILE_CHECK">GENERIC_PROPERTY_FILE_CHECK</a></div><ul class="sub-nav" id="sub-GENERIC_PROPERTY_FILE_CHECK"><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_ErrorConfigurationCustomization')">Error Configuration & Customization</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">&#9654;</span><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')" data-rule-id="MANDATORY_PROPERTY_VALUE_CHECK">MANDATORY_PROPERTY_VALUE_CHECK</a></div><ul class="sub-nav" id="sub-MANDATORY_PROPERTY_VALUE_CHECK"><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'MANDATORY_SUBSTRING_CHECK')">&#9654;</span><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK')" data-rule-id="MANDATORY_SUBSTRING_CHECK">MANDATORY_SUBSTRING_CHECK</a></div><ul class="sub-nav" id="sub-MANDATORY_SUBSTRING_CHECK"><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_ErrorConfigurationCustomization')">Error Configuration & Customization</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'OPTIONAL_PROPERTY_VALUE_CHECK')">&#9654;</span><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK')" data-rule-id="OPTIONAL_PROPERTY_VALUE_CHECK">OPTIONAL_PROPERTY_VALUE_CHECK</a></div><ul class="sub-nav" id="sub-OPTIONAL_PROPERTY_VALUE_CHECK"><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_ValidationLogic')">Validation Logic</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_RelatedRuleTypes')">Related Rule Types</a></li></ul></li>
        </ul>
    </div>
    <div class="resizer" id="resizer"></div>
    <div class="main-content">
        <div class="top-nav-container">
            <a href="CONSOLIDATED-REPORT.html" id="dashboardBtn" class="top-nav-button" title="Return to main dashboard">‚Üê Dashboard</a>
            <a href="#" id="mainPageBtn" class="top-nav-button" title="Go to Home" style="display: none; background-color: #0078d4;">üè† Home</a>
        </div>
        <div class="report-container">
            <div id="QUICK_REFERENCE" class="rule-content" style="display: block;"><h1>Aegis Quick Reference Guide</h1>
<br>
This document is the <strong>single source of truth</strong> for all Aegis configuration parameters, rule types, and best practices.
<br>
<h2 id="QUICK_REFERENCE_1GlobalParameters">1. Global Parameters</h2>
These parameters apply to almost <strong>ALL</strong> rule types and control file selection, property resolution, and evaluation logic.
<table><tr><td> Parameter </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> (Required) </td><td> List of glob patterns for target files (e.g. <code class='inline-token'>["**/*.xml"]</code>). </td></tr><tr><td> <code class='inline-token'>matchMode</code> </td><td> <code class='inline-token'>ALL_FILES</code> </td><td> Controls file-level quantifier: <code class='inline-token'>ALL_FILES</code>, <code class='inline-token'>ANY_FILE</code>, <code class='inline-token'>NONE_OF_FILES</code>, <code class='inline-token'>AT_LEAST_N</code>. </td></tr><tr><td> <code class='inline-token'>logic</code> </td><td> <code class='inline-token'>AND</code> / <code class='inline-token'>OR</code> </td><td> Combining logic for multiple tokens/checks. Defaults to <code class='inline-token'>OR</code> for forbidden, <code class='inline-token'>AND</code> for required. </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> <code class='inline-token'>true</code> </td><td> <strong>Master Switch</strong>. Enables <code class='inline-token'>${property}</code> resolution within the check. </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code> </td><td> <code class='inline-token'>false</code> </td><td> Search properties in the <strong>linked CONFIG project</strong> with <strong>Priority</strong> over the local project. </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code> </td><td> <code class='inline-token'>false</code> </td><td> Alias for <code class='inline-token'>includeLinkedConfig</code> (supported for backward compatibility). </td></tr><tr><td> <code class='inline-token'>ignoreComments</code> </td><td> <code class='inline-token'>true</code> </td><td> Skip commented lines or XML comments during evaluation. </td></tr><tr><td> <code class='inline-token'>environments</code> </td><td> <code class='inline-token'>[]</code> </td><td> List of environments (e.g., <code class='inline-token'>["PROD", "QA"]</code>) where this rule applies. </td></tr><tr><td> <code class='inline-token'>appliesTo</code> </td><td> <code class='inline-token'>[]</code> </td><td> List of project types (e.g., <code class='inline-token'>["CODE", "CONFIG"]</code>) this rule targets. </td></tr></table>
<hr>
<br>
<h2 id="QUICK_REFERENCE_2PropertyResolutionProjectContext">2. Property Resolution & Project Context</h2>
Aegis interprets the context of a project (Mule app, Java project, or configuration project) and enables sharing properties between them.
<h3>Resolution Priority</h3>
1. <strong>Linked CONFIG Project</strong>: If <code class='inline-token'>includeLinkedConfig: true</code>, Aegis searches the linked configuration project <strong>FIRST</strong>.
2. <strong>Local Project</strong>: If not found in CONFIG, it searches the project's own <code class='inline-token'>.properties</code> or YAML files.
3. <strong>Environment/System</strong>: Finally, it searches system environment variables.
<h3>Project Context & Analytics</h3>
When running rules, Aegis automatically detects and validates:
<li><strong>Environment Context</strong>: Distinguishes between PROD, QA, and SIT profiles.</li>
<li><strong>Dependency Integrity</strong>: Validation of <code class='inline-token'>pom.xml</code> versions and dependency scopes.</li>
<li><strong>Resource Placement</strong>: Ensuring mandatory properties exist in the correct project sub-folders.</li>
<div class='alert tip'><strong>TIP:</strong> > <strong>Property Resolution Detail:</strong> Use the <code class='inline-token'>{PROPERTY_RESOLVED}</code> token in your messages to see exactly which value was used and from which source (labeled as <code class='inline-token'>CONFIG - </code> in reports).</div>
<hr>
<br>
<h2 id="QUICK_REFERENCE_3RuleTypesParameters">3. Rule Types & Parameters</h2>
<h3>XML Checks (<code class='inline-token'>XmlGenericCheck</code>)</h3>
Used for validating XML structure and values using XPath. Supports the following types:
<li><code class='inline-token'>XML_XPATH_EXISTS</code>: Fails if XPath is missing.</li>
<li><code class='inline-token'>XML_XPATH_OPTIONAL</code>: <strong>NEW</strong>. Passes if XPath is missing; validates only if found.</li>
<li><code class='inline-token'>XML_XPATH_NOT_EXISTS</code>: Fails if XPath is found.</li>
<li><code class='inline-token'>XML_ATTRIBUTE_EXISTS</code> / <code class='inline-token'>NOT_EXISTS</code>.</li>
<li><code class='inline-token'>XML_ELEMENT_CONTENT_REQUIRED</code> / <code class='inline-token'>FORBIDDEN</code>.</li>
<table><tr><td> Parameter </td><td> Mandatory </td><td> Description </td></tr><tr><td> <code class='inline-token'>xpath</code> </td><td> No* </td><td> The primary XPath expression to evaluate. </td></tr><tr><td> <code class='inline-token'>xpathExpressions</code> </td><td> No* </td><td> List of XPaths (legacy support). </td></tr><tr><td> <code class='inline-token'>forbiddenValue</code> </td><td> No </td><td> Value that triggers a failure if found at the XPath. </td></tr><tr><td> <code class='inline-token'>expectedValue</code> </td><td> No </td><td> Value that must be present at the XPath. </td></tr><tr><td> <code class='inline-token'>operator</code> </td><td> No </td><td> Match operator: <code class='inline-token'>EQ</code> (default), <code class='inline-token'>CONTAINS</code>, <code class='inline-token'>MATCHES</code>, <code class='inline-token'>GTE</code>, <code class='inline-token'>LTE</code>. </td></tr><tr><td> <code class='inline-token'>valueType</code> </td><td> No </td><td> <code class='inline-token'>STRING</code> (default), <code class='inline-token'>NUMBER</code>, <code class='inline-token'>SEMVER</code>. </td></tr></table>
<div class='alert note'><strong>NOTE:</strong> > At least one of <code class='inline-token'>xpath</code>, <code class='inline-token'>requiredFields</code>, <code class='inline-token'>minVersions</code>, or <code class='inline-token'>exactVersions</code> must be provided.</div>
<h3>JSON Checks (<code class='inline-token'>JsonGenericCheck</code>)</h3>
Used for validating JSON structure and values. Supports the following types:
<li><code class='inline-token'>JSON_VALIDATION_REQUIRED</code>: Fails if JSONPath is missing.</li>
<li><code class='inline-token'>JSON_VALIDATION_OPTIONAL</code>: <strong>NEW</strong>. Passes if JSONPath is missing; validates only if found.</li>
<li><code class='inline-token'>JSON_VALIDATION_FORBIDDEN</code>: Fails if JSONPath is found.</li>
<table><tr><td> Parameter </td><td> Mandatory </td><td> Description </td></tr><tr><td> <code class='inline-token'>jsonPath</code> </td><td> No </td><td> JsonPath expression (defaults to <code class='inline-token'>$</code>). </td></tr><tr><td> <code class='inline-token'>expectedValue</code> </td><td> No </td><td> Value to match (triggers <code class='inline-token'>VALUE_MATCH</code> mode). </td></tr><tr><td> <code class='inline-token'>requiredFields</code> </td><td> No </td><td> Map of field names to expected values. </td></tr></table>
<h3>Token Search (<code class='inline-token'>TokenSearchCheck</code>)</h3>
Fast text-based searching for keywords or regex patterns.
<table><tr><td> Parameter </td><td> Mandatory </td><td> Description </td></tr><tr><td> <code class='inline-token'>tokens</code> </td><td> Yes </td><td> List of strings or regex patterns to search for. </td></tr><tr><td> <code class='inline-token'>isRegex</code> </td><td> No </td><td> Set to <code class='inline-token'>true</code> if <code class='inline-token'>tokens</code> are regular expressions. </td></tr><tr><td> <code class='inline-token'>wholeWord</code> </td><td> No </td><td> Ensure the token matches a complete word (<code class='inline-token'>\b</code> boundaries). </td></tr><tr><td> <code class='inline-token'>wholeFile</code> </td><td> No </td><td> Read the entire file as a single string (useful for multi-line regex). </td></tr></table>
<hr>
<br>
<h2 id="QUICK_REFERENCE_4AvoidingFalsePositives">4. Avoiding False Positives</h2>
The most common cause of "noise" in reports is rules running on files where they don't apply. Follow these patterns to create "silent" and precise rules.
<h3>Pattern A: Specific File Scoping</h3>
Instead of scanning all XMLs, target only the relevant configuration files.
<pre><code class='language-yaml'># ‚ùå Bad: Scans everything and fails if xpath not found
filePatterns: ["src/main/mule/*.xml"]
# ‚úÖ Good: Only scans specific config files
filePatterns: ["src/main/mule/global-config.xml", "src/main/mule/*-config.xml"]
</code></pre>
<h3>Pattern B: Using CONDITIONAL_CHECK</h3>
Use a precondition to ensure the rule ONLY executes on projects or files that actually contain the feature.
<pre><code class='language-yaml'># Only validate SOAP Version if the project actually uses the apikit-soap router
type: CONDITIONAL_CHECK
params:
  preconditions:
    - type: XML_XPATH_EXISTS
      params:
        matchMode: ANY_FILE
        filePatterns: ["src/main/mule/*.xml"]
        xpath: "//*[local-name()='config' and contains(namespace-uri(), '/mule/apikit-soap')]"
  onSuccess:
    - type: XML_XPATH_NOT_EXISTS
      params:
        # Now we can safely check for forbidden values
        forbiddenValue: "SOAP11"
        # ...
</code></pre>
<h3>Pattern C: Negative Logic for Deprecation</h3>
When forbidding an attribute, use <code class='inline-token'>NOT_EXISTS</code> mode. This ensures that if the attribute is missing entirely, the rule <strong>PASSES</strong> (since the forbidden item is not there).
<pre><code class='language-yaml'>type: XML_ATTRIBUTE_NOT_EXISTS
params:
  elements: ["http:listener-config"]
  forbiddenAttributes: ["deprecated-attr"]
# Result: If file has no &lt;http:listener-config&gt;, it PASSES silently.
</code></pre>
<h3>Pattern D: Optional Validation (New & Recommended)</h3>
Use <code class='inline-token'>XML_XPATH_OPTIONAL</code> or <code class='inline-token'>JSON_VALIDATION_OPTIONAL</code> for "Validate only if present" logic. This is more efficient than <code class='inline-token'>CONDITIONAL_CHECK</code> and prevents report noise.
<pre><code class='language-yaml'># Only validate JKS if jce-config is present
type: XML_XPATH_OPTIONAL
params:
  xpath: "//*[local-name()='jce-config']/@type"
  expectedValue: "JKS"
  filePatterns: ["**/*.xml"]
# Result: Files without &lt;jce-config&gt; pass silently.
</code></pre>
<h3>Pattern E: Conditional Existence Checks</h3>
Aegis allows you to precisely control rule execution based on the existence of specific elements. This is commonly used in <code class='inline-token'>CONDITIONAL_CHECK</code> to skip rules when certain "feature flags" (like a batch job) are found.
<br>
Using <code class='inline-token'>XML_XPATH_NOT_EXISTS</code> without a <code class='inline-token'>forbiddenValue</code> will fail if the element is found in the XML, effectively allowing you to say "Run this check ONLY IF this other element is NOT present."
<br>
<strong>Example (Excluding Batch Projects):</strong>
<pre><code class='language-yaml'>type: CONDITIONAL_CHECK
params:
  preconditions:
    - type: XML_XPATH_NOT_EXISTS
      params:
        xpath: "//*[local-name()='job']" # Skips if &lt;batch:job&gt; exists
  # ...
</code></pre>
<h3>Pattern F: Enhanced Reporting Context</h3>
Aegis can be configured to provide deep context in failure reports (like showing the exact hardcoded version string) entirely through YAML configuration:
<br>
1.  <strong>Direct Pointing</strong>: Set the <code class='inline-token'>xpath</code> to point directly to the data of interest (e.g., the <code class='inline-token'>&lt;version&gt;</code> text).
2.  <strong>Smart Filtering</strong>: Use an XPath predicate to select only the invalid nodes (e.g., <code class='inline-token'>not(contains(., '${'))</code>).
3.  <strong>Capture Mode</strong>: Use <code class='inline-token'>XML_ELEMENT_CONTENT_FORBIDDEN</code> with <code class='inline-token'>forbiddenValue: ".+"</code>.
4.  <strong>Automatic Detail</strong>: Because every match is an intentional failure, Aegis captures the matched text and displays it in the <strong>"Items Found"</strong> section, making the issue immediately obvious to the developer.
<br>
<strong>Example:</strong>
<pre><code class='language-yaml'>type: XML_ELEMENT_CONTENT_FORBIDDEN
params:
  xpath: "//*[local-name()='version'][not(contains(., '${'))]"
  forbiddenValue: ".+"
  operator: "MATCHES"
  isRegex: true
</code></pre>
<hr>
<br>
<h2 id="QUICK_REFERENCE_5MessageTokensReference">5. Message Tokens Reference</h2>
Use these tokens in <code class='inline-token'>successMessage</code> and <code class='inline-token'>errorMessage</code> for dynamic reporting.
<li><code class='inline-token'>{RULE_ID}</code>: The ID of the rule.</li>
<li><code class='inline-token'>{CHECKED_FILES}</code>: List of files scanned.</li>
<li><code class='inline-token'>{MATCHING_FILES}</code>: List of files that passed the criteria.</li>
<li><code class='inline-token'>{FOUND_ITEMS}</code>: Specific forbidden items found (e.g., tokens, XPath results).</li>
<li><code class='inline-token'>{DEFAULT_MESSAGE}</code>: Full technical details of the result.</li>
<li><code class='inline-token'>{PROPERTY_RESOLVED}</code>: Detailed trail of resolved property placeholders.</li>
</div><div id="PROJECT_IDENTIFICATION" class="rule-content" style="display: none;"><h1>Project Identification</h1>
<br>
Aegis identifies projects to scan based on <strong>Marker Files</strong>. It does not semantically "auto-detect" technology types like Java or Python unless told what files signify the root of such a project.
<br>
<h2 id="PROJECT_IDENTIFICATION_Overview">Overview</h2>
<br>
When Aegis scans a directory, it looks for specific "markers" to decide if a folder should be treated as a project and subjected to the validation rules. This is controlled in the <code class='inline-token'>config</code> section of your <code class='inline-token'>rules.yaml</code>.
<br>
<h2 id="PROJECT_IDENTIFICATION_Configuration">Configuration</h2>
<br>
The <code class='inline-token'>projectIdentification</code> block in <code class='inline-token'>rules.yaml</code> defines these settings:
<br>
<pre><code class='language-yaml'>config:
  projectIdentification:
    targetProject:
      matchMode: ANY      # ANY or ALL
      markerFiles:        # Files that identify a project
      - pom.xml           # Signifies a Maven/Java project
      - package.json       # Signifies a Node.js project
      - requirements.txt  # Signifies a Python project
      - mule-artifact.json # Signifies a MuleSoft project
    configFolder:
      namePattern: .*_config.* # Pattern for identifying configuration projects
</code></pre>
<h3>Match Modes</h3>
<li><strong>ANY</strong>: A folder is considered a project if <strong>AT LEAST ONE</strong> of the marker files exists.</li>
<li><strong>ALL</strong>: A folder is considered a project ONLY if <strong>EVERY</strong> marker file in the list exists.</li>
<br>
<h2 id="PROJECT_IDENTIFICATION_ManagingMultipleTechnologies">Managing Multiple Technologies</h2>
<br>
Because Aegis is technology-agnostic, you can scan a mixed repository (e.g., containing both Java and Python services) by simply including markers for both:
<br>
1. <strong>Shared Scan</strong>: Add both <code class='inline-token'>pom.xml</code> and <code class='inline-token'>requirements.txt</code> to <code class='inline-token'>markerFiles</code>.
2. <strong>Targeted Rules</strong>: Use <code class='inline-token'>filePatterns</code> in your rules to ensure Java rules only run on Java files (<code class='inline-token'>**/*.java</code>) and Python rules only on Python files (<code class='inline-token'>**/*.py</code>).
<br>
<h2 id="PROJECT_IDENTIFICATION_BestPractices">Best Practices</h2>
<li><strong>Narrow the Markers</strong>: Only use files that truly represent the root of a project. Using a very common file like <code class='inline-token'>README.md</code> as a marker might cause Aegis to scan many folders that aren't actually code projects.</li>
<li><strong>Excluded Folders</strong>: Use the <code class='inline-token'>ignoredFolders</code> configuration to skip directories like <code class='inline-token'>node_modules</code>, <code class='inline-token'>target</code>, or <code class='inline-token'>.git</code> to speed up the discovery process.</li>
</div><div id="FILE_EXISTS" class="rule-content" style="display: none;"><h1>FILE_EXISTS</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> </td><td> <strong>Trigger Engine</strong>
<br>
<h2 id="FILE_EXISTS_Overview">Overview</h2>
<br>
A trigger that checks for the presence of one or more files in the project. It is typically used within a <code class='inline-token'>CONDITIONAL_CHECK</code> to ensure specific templates, security files, or configuration assets exist. This rule helps enforce project structure standards across different technologies.
<br>
<h2 id="FILE_EXISTS_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List </td><td> Glob patterns to search for files (e.g., <code class='inline-token'>src/resources/secure-*.properties</code>) </td></tr></table>
<h3>Optional Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>failureMessage</code> </td><td> String </td><td> (Default) </td><td> Custom message if expected files are not found </td></tr></table>
<br>
<h2 id="FILE_EXISTS_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Mandatory Security Documentation</h3>
<br>
Ensures that any project must have a <code class='inline-token'>SECURITY.md</code> file in the root directory.
<br>
<pre><code class='language-yaml'>- id: "RULE-FILE-SECURITY"
  name: "Mandatory Security Documentation"
  description: "Ensures every project contains a security policy file"
  enabled: true
  severity: HIGH
  checks:
    - type: FILE_EXISTS
      params:
        filePatterns: ["SECURITY.md"]
        failureMessage: "Project missing mandatory SECURITY.md file in root"
</code></pre>
<h3>Example 2: API Specification Trigger</h3>
<br>
Ensures that an API specification file (RAML, OAS, or Swagger) exists in the expected directory for projects tagged as APIs.
<br>
<pre><code class='language-yaml'>- id: "RULE-API-SPEC-EXISTS"
  checks:
    - type: CONDITIONAL_CHECK
      params:
        preconditions:
          - type: PROJECT_CONTEXT
            params: { nameContains: "-api-" }
        onSuccess:
          - type: FILE_EXISTS
            params:
              filePatterns: 
                - "src/main/resources/api/*.raml"
                - "src/main/resources/api/*.yaml"
                - "src/main/resources/api/*.json"
              failureMessage: "API project missing specification file in src/main/resources/api/"
</code></pre>
<br>
<h2 id="FILE_EXISTS_BestPractices">Best Practices</h2>
<li><strong>Use as a Precondition</strong>: detect "legacy" projects (e.g., presence of old framework files) to apply specific migration or compatibility rules.</li>
<li><strong>Enforce Readme/Security</strong>: Use <strong>FILE_EXISTS</strong> as an <code class='inline-token'>onSuccess</code> check to ensure standard documentation is always present.</li>
<li><strong>Technology Detection</strong>: Combine with <strong><a href="#" onclick="showRule(event, 'PROJECT_CONTEXT')">PROJECT_CONTEXT</a></strong> to target specific file requirements for specific project types.</li>
<br>
<h2 id="FILE_EXISTS_RelatedCheckTypes">Related Check Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'PROJECT_CONTEXT')">PROJECT_CONTEXT</a></strong>: Trigger based on project metadata or folder names.</li>
<br>
<h2 id="FILE_EXISTS_SolutionPatternsandTechnologyReferences">Solution Patterns and Technology References</h2>
<br>
The following table serves as a quick reference for enforcing file existence across various project types.
<table><tr><td> Technology </td><td> Best Practice Goal </td><td> Key Files Checked </td><td> Purpose </td></tr><tr><td> <strong>‚òï Java/Maven</strong> </td><td> Build Consistency </td><td> <code class='inline-token'>pom.xml</code> </td><td> Dependency management </td></tr><tr><td> <strong>üì¶ Node.js</strong> </td><td> Project Metadata </td><td> <code class='inline-token'>package.json</code> </td><td> Scripts and dependencies </td></tr><tr><td> <strong>üêé MuleSoft 4</strong> </td><td> Project Structure </td><td> <code class='inline-token'>mule-artifact.json</code> </td><td> Core runtime configuration </td></tr><tr><td> <strong>üêç Python</strong> </td><td> Environment Setup </td><td> <code class='inline-token'>requirements.txt</code> </td><td> Package dependencies </td></tr><tr><td> <strong>‚ö° TIBCO BW</strong> </td><td> Module Validity </td><td> <code class='inline-token'>*.module</code>, <code class='inline-token'>MANIFEST.MF</code> </td><td> OSGi/Module configuration </td></tr><tr><td> <strong>üê≥ Docker</strong> </td><td> Containerization </td><td> <code class='inline-token'>Dockerfile</code> </td><td> Image build definition </td></tr></table>
<h3>‚òï Java / Spring Boot Patterns</h3>
<br>
Ensure that Maven or Gradle build files are present to guarantee the project can be built in CI/CD.
<br>
<pre><code class='language-yaml'>id: "JAVA-BUILD-DESCRIPTOR"
name: "Require Build Descriptor"
checks:
  - type: FILE_EXISTS
    params:
      filePatterns: ["pom.xml", "build.gradle", "build.gradle.kts"]
      failureMessage: "Java projects must have a pom.xml or build.gradle file"
</code></pre>
<h3>üì¶ Node.js Patterns</h3>
<br>
The <code class='inline-token'>package.json</code> file is the heart of any Node.js application.
<br>
<pre><code class='language-yaml'>id: "NODE-PACKAGE-JSON"
name: "Require Package.json"
checks:
  - type: FILE_EXISTS
    params:
      filePatterns: ["package.json"]
      failureMessage: "Node.js projects must contain a package.json file"
</code></pre>
<h3>üê≥ DevOps / Docker Patterns</h3>
<br>
For projects intended for containerization, a <code class='inline-token'>Dockerfile</code> is essential.
<br>
<pre><code class='language-yaml'>id: "DOCKER-FILE-REQUIRED"
name: "Require Dockerfile"
checks:
  - type: FILE_EXISTS
    params:
      filePatterns: ["Dockerfile", "docker-compose.yml"]
</code></pre>
</div><div id="GENERIC_TOKEN_SEARCH" class="rule-content" style="display: none;"><h1>GENERIC_TOKEN_SEARCH</h1>
<br>
<strong>Primary Capacity:</strong> Universal Pattern & Token Engine </td><td> <strong>Validation Target:</strong> Any Text-Based File (Scripts, XML, Java, YAML)
<br>
<h2 id="GENERIC_TOKEN_SEARCH_Overview">Overview</h2>
<br>
Advanced token search with <strong>environment filtering</strong> and <strong>regex support</strong>. This rule acts as a versatile engine that can operate in both <code class='inline-token'>REQUIRED</code> and <code class='inline-token'>FORBIDDEN</code> modes, with additional awareness of target environments. It is the core engine behind more specialized substring and token checks.
<br>
<h2 id="GENERIC_TOKEN_SEARCH_UseCases">Use Cases</h2>
<li>Detect environment-specific anti-patterns (e.g., "localhost" in Production).</li>
<li>Enforce mandatory headers or license blocks in source files.</li>
<li>Validate configuration compliance across different build stages.</li>
<li>Target specific XML element attributes or plain text strings.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List </td><td> Glob patterns to match source or configuration files </td></tr><tr><td> <code class='inline-token'>tokens</code> </td><td> List </td><td> List of tokens or patterns to search for </td></tr></table>
<h3>Optional Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>environments</code> </td><td> List </td><td> N/A </td><td> Filter files by environment keys (e.g., <code class='inline-token'>PROD</code>, <code class='inline-token'>QA</code>) </td></tr><tr><td> <code class='inline-token'>searchMode</code> </td><td> String </td><td> <code class='inline-token'>FORBIDDEN</code> </td><td> Choose <code class='inline-token'>REQUIRED</code> or <code class='inline-token'>FORBIDDEN</code> </td></tr><tr><td> <code class='inline-token'>matchMode</code> </td><td> String </td><td> <code class='inline-token'>SUBSTRING</code> </td><td> Choose <code class='inline-token'>SUBSTRING</code>, <code class='inline-token'>REGEX</code>, or <code class='inline-token'>ELEMENT_ATTRIBUTE</code>. Setting to <code class='inline-token'>REGEX</code> automatically enables regex matching. </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Whether token matching is case-sensitive </td></tr><tr><td> <code class='inline-token'>wholeWord</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> If <code class='inline-token'>true</code>, ensures exact word matching (wraps tokens in <code class='inline-token'>\b</code>). Ignored if <code class='inline-token'>matchMode: REGEX</code>. </td></tr><tr><td> <code class='inline-token'>message</code> </td><td> String </td><td> (Default) </td><td> Custom message to display on failure </td></tr><tr><td> <code class='inline-token'>elementName</code> </td><td> String </td><td> N/A </td><td> For XML element-specific attribute searches </td></tr></table>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Environment-Specific Policy</h3>
<br>
Ensure that production configurations do not contain references to local development servers.
<br>
<pre><code class='language-yaml'>- id: "RULE-PROD-NO-LOCALHOST"
  name: "No Localhost in Production"
  severity: CRITICAL
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: ["*.properties", "*.yaml"]
        environments: ["PROD"]
        tokens: ["localhost", "127.0.0.1"]
        searchMode: FORBIDDEN
</code></pre>
<h3>Example 2: Detect IP Addresses</h3>
<br>
Identify hardcoded IP addresses in configuration files for higher environments.
<br>
<pre><code class='language-yaml'>- id: "RULE-NOMADIC-IP-CHECK"
  name: "IP Address Detection"
  severity: HIGH
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: ["config/*.yaml"]
        environments: ["QA", "PROD"]
        tokens: ["\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b"]
        matchMode: REGEX
        searchMode: FORBIDDEN
</code></pre>
<h3>Example 3: Mandatory Cloud Metadata</h3>
<br>
Ensure all property files in any environment contain a specific metadata reference.
<br>
<pre><code class='language-yaml'>- id: "RULE-MANDATORY-CLOUDFLARE"
  name: "Cloud Providers Metadata"
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: ["**/*.properties"]
        environments: ["ALL"]
        tokens: ["${cloud.provider}", "${region.id}"]
        searchMode: REQUIRED
</code></pre>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_ErrorConfigurationCustomization">Error Configuration & Customization</h2>
<br>
By default, Aegis generates a technical description of the failure. You can override this by providing a custom <code class='inline-token'>message</code> parameter in your rule configuration.
<br>
<pre><code class='language-yaml'>      params:
        tokens: ["localhost"]
        searchMode: FORBIDDEN
        message: "Critical violation: Hardcoded localhost reference found in production config!"
</code></pre>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_BestPractices">Best Practices</h2>
<li><strong>Filter by Environment</strong>: Use the <code class='inline-token'>environments</code> parameter to avoid noise in development or test configurations while keeping production strictly compliant.</li>
<li><strong>Regex for Complexity</strong>: Use <code class='inline-token'>matchMode: REGEX</code> to search for patterns rather than literal strings (e.g., version formats, ID patterns).</li>
<li><strong>Mode Clarity</strong>: Clearly label whether a rule is for blocking (<code class='inline-token'>FORBIDDEN</code>) or enforcing (<code class='inline-token'>REQUIRED</code>) to make failure messages intuitive.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED')">GENERIC_TOKEN_SEARCH_REQUIRED</a></strong> - Simplified mandatory token check.</li>
<li><strong><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN')">GENERIC_TOKEN_SEARCH_FORBIDDEN</a></strong> - Simplified forbidden token check.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_SolutionPatternsandTechnologyReference">Solution Patterns and Technology Reference</h2>
<br>
Standard configurations for validating multi-technology stacks.
<table><tr><td> Technology </td><td> Scenario </td><td> Search Mode </td><td> Target File </td></tr><tr><td> <strong>‚òï Java</strong> </td><td> Block <code class='inline-token'>System.out</code> </td><td> <code class='inline-token'>FORBIDDEN</code> </td><td> <code class='inline-token'>*.java</code> </td></tr><tr><td> <strong>üêç Python</strong> </td><td> Block <code class='inline-token'>print()</code> </td><td> <code class='inline-token'>FORBIDDEN</code> </td><td> <code class='inline-token'>*.py</code> </td></tr><tr><td> <strong>üì¶ Node.js</strong> </td><td> Block <code class='inline-token'>console.log</code> </td><td> <code class='inline-token'>FORBIDDEN</code> </td><td> <code class='inline-token'>*.js</code> </td></tr><tr><td> <strong>üê≥ Docker</strong> </td><td> Require standard base image </td><td> <code class='inline-token'>REQUIRED</code> </td><td> <code class='inline-token'>Dockerfile</code> </td></tr><tr><td> <strong>üêé MuleSoft</strong> </td><td> Block non-persistent stores </td><td> <code class='inline-token'>FORBIDDEN</code> </td><td> <code class='inline-token'>*.xml</code> </td></tr></table>
<h3>‚òï Java Patterns</h3>
<br>
Enterprise standards for logging and output management.
<br>
<pre><code class='language-yaml'>- id: "JAVA-LOG-CLEAN"
  name: "No System.out Usage"
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: ["src/**/*.java"]
        tokens: ["System.out.print", "System.err.print"]
        searchMode: FORBIDDEN
</code></pre>
<h3>üêç Python Patterns</h3>
<br>
Ensuring logging standards in production scripts.
<br>
<pre><code class='language-yaml'>- id: "PY-LOG-ENFORCEMENT"
  name: "No Print Statements"
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: ["*.py"]
        tokens: ["print("]
        searchMode: FORBIDDEN
</code></pre>
</div><div id="GENERIC_TOKEN_SEARCH_FORBIDDEN" class="rule-content" style="display: none;"><h1>GENERIC_TOKEN_SEARCH_FORBIDDEN</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> Any text-based source files
<br>
<h2 id="GENERIC_TOKEN_SEARCH_FORBIDDEN_Overview">Overview</h2>
<br>
Validates that <strong>forbidden tokens or patterns do NOT exist</strong> in files matching specified patterns. This rule <strong>fails</strong> if any of the specified forbidden tokens are <strong>found</strong> within the file content. It is a powerful tool for blocking deprecated functions, hardcoded credentials, and unsafe coding patterns.
<br>
<h2 id="GENERIC_TOKEN_SEARCH_FORBIDDEN_UseCases">Use Cases</h2>
<li>Prevent usage of deprecated APIs, legacy functions, or insecure libraries.</li>
<li>Block hardcoded credentials (passwords, API keys, secrets) in source and config files.</li>
<li>Disallow specific imports or dependencies that violate architectural standards.</li>
<li>Enforce cleanup of debug code, temporary comments, or test-only artifacts in production.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_FORBIDDEN_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List </td><td> Glob patterns to match source or configuration files </td></tr><tr><td> <code class='inline-token'>tokens</code> </td><td> List </td><td> List of tokens that must NOT be found in the files </td></tr></table>
<h3>Optional Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>excludePatterns</code> </td><td> List </td><td> <code class='inline-token'>[]</code> </td><td> Glob patterns to exclude specific files </td></tr><tr><td> <code class='inline-token'>matchMode</code> </td><td> String </td><td> <code class='inline-token'>SUBSTRING</code> </td><td> Choose <code class='inline-token'>SUBSTRING</code> or <code class='inline-token'>REGEX</code>. Setting to <code class='inline-token'>REGEX</code> automatically enables regex matching. </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Whether token matching is case-sensitive </td></tr><tr><td> <code class='inline-token'>wholeWord</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> If <code class='inline-token'>true</code>, ensures exact word matching (wraps tokens in <code class='inline-token'>\b</code>). Ignored if <code class='inline-token'>matchMode: REGEX</code>. </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr><tr><td> <code class='inline-token'>ignoreComments</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Removes comments before searching. Recommended to avoid false positives. </td></tr><tr><td> <strong><code class='inline-token'>wholeFile</code></strong> </td><td> <strong>Boolean</strong> </td><td> <strong><code class='inline-token'>false</code></strong> </td><td> <strong>If <code class='inline-token'>true</code>, reads the entire file as a single string. Recommended for multi-line regex validation.</strong> </td></tr></table>
<h3>üéØ Comment Handling (<code class='inline-token'>ignoreComments</code>)</h3>
<br>
<strong>NEW FEATURE:</strong> The <code class='inline-token'>ignoreComments</code> parameter allows you to choose between <strong>strict mode</strong> (comments ignored) and <strong>normal mode</strong> (comments included).
<h4>Why This Matters</h4>
<br>
By default, token searches include commented code, which can cause <strong>false positives</strong> for FORBIDDEN rules:
<br>
<pre><code class='language-xml'>&lt;!-- &lt;logger level="DEBUG" /&gt; --&gt;  ‚ùå FALSE POSITIVE without ignoreComments
&lt;logger level="INFO" /&gt;             ‚úÖ This should be checked
</code></pre>
<h4>Supported File Types</h4>
<table><tr><td> File Type </td><td> Extensions </td><td> Comment Syntax </td><td> Single-Line </td><td> Multi-Line Block </td></tr><tr><td> <strong>XML</strong> </td><td> <code class='inline-token'>.xml</code>, <code class='inline-token'>.process</code>, <code class='inline-token'>.bwp</code> </td><td> <code class='inline-token'>&lt;!-- --&gt;</code> </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>Java</strong> </td><td> <code class='inline-token'>.java</code> </td><td> <code class='inline-token'>//</code>, <code class='inline-token'>/* */</code> </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>Groovy</strong> </td><td> <code class='inline-token'>.groovy</code> </td><td> <code class='inline-token'>//</code>, <code class='inline-token'>/* */</code> </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>DataWeave</strong> </td><td> <code class='inline-token'>.dwl</code> </td><td> <code class='inline-token'>//</code>, <code class='inline-token'>/* */</code> </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>JavaScript</strong> </td><td> <code class='inline-token'>.js</code> </td><td> <code class='inline-token'>//</code>, <code class='inline-token'>/* */</code> </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>JSON</strong> </td><td> <code class='inline-token'>.json</code> </td><td> <code class='inline-token'>//</code>, <code class='inline-token'>/* */</code> (non-standard) </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>Properties</strong> </td><td> <code class='inline-token'>.properties</code>, <code class='inline-token'>.substvar</code> </td><td> <code class='inline-token'>#</code>, <code class='inline-token'>!</code> (line start only) </td><td> ‚úÖ </td><td> ‚ùå </td></tr><tr><td> <strong>YAML</strong> </td><td> <code class='inline-token'>.yaml</code>, <code class='inline-token'>.yml</code> </td><td> <code class='inline-token'>#</code> (inline supported) </td><td> ‚úÖ </td><td> ‚ùå </td></tr><tr><td> <strong>SQL</strong> </td><td> <code class='inline-token'>.sql</code> </td><td> <code class='inline-token'>--</code>, <code class='inline-token'>#</code>, <code class='inline-token'>/* */</code> </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>Shell</strong> </td><td> <code class='inline-token'>.sh</code>, <code class='inline-token'>.bash</code> </td><td> <code class='inline-token'>#</code> </td><td> ‚úÖ </td><td> ‚ùå </td></tr></table>
<h4>When to Use</h4>
<li><strong>FORBIDDEN Rules:</strong> ‚úÖ <strong>Always use <code class='inline-token'>ignoreComments: true</code></strong> to avoid false positives</li>
<li><strong>REQUIRED Rules:</strong> ‚ö†Ô∏è Use <code class='inline-token'>ignoreComments: false</code> (default) to check documentation</li>
<li><strong>Documentation Files:</strong> ‚ö†Ô∏è Use <code class='inline-token'>ignoreComments: false</code> to ensure content exists</li>
<h4>Example: Strict Mode (Recommended)</h4>
<br>
<pre><code class='language-yaml'>- id: "BANK-002"
  name: "Forbid Legacy Logger Attributes"
  type: "CODE_GENERIC_TOKEN_SEARCH_FORBIDDEN"
  severity: "HIGH"
  checks:
    - type: "TOKEN_SEARCH"
      params:
        filePatterns: ["**/*.xml"]
        tokens: ["toApplicationCode", "DEBUG"]
        ignoreComments: true  # ‚úÖ Strict mode - ignore commented code
</code></pre>
<br>
<strong>Test Case:</strong>
<pre><code class='language-xml'>&lt;!-- &lt;logger level="DEBUG" /&gt; --&gt;  ‚úÖ IGNORED (in comment)
&lt;logger level="INFO" /&gt;             ‚úÖ CHECKED (active code)
</code></pre>
<strong>Result:</strong> PASS ‚úÖ (no forbidden tokens in active code)
<h4>Example: Normal Mode</h4>
... (existing content) ...
<h3>üìÑ Whole File Search (<code class='inline-token'>wholeFile</code>)</h3>
<br>
<strong>NEW FEATURE:</strong> When <code class='inline-token'>wholeFile: true</code> is enabled, the check processes the entire file content as a single block of text rather than line-by-line.
<h4>Why Use This?</h4>
Standard line-by-line regex cannot see relationships between different lines. With <code class='inline-token'>wholeFile</code>, you can use <strong>DOTALL</strong> regex <code class='inline-token'>(?s)</code> to validate that if a property exists on line 1, its value must be correct even if it's defined on line 10.
<h4>Example: Per-File Conditional Validation</h4>
Fails if a policy is <code class='inline-token'>applied=true</code> but its <code class='inline-token'>version</code> is not <code class='inline-token'>3.0.0</code> within the same file.
<br>
<pre><code class='language-yaml'>- id: "BANK-109"
  name: "Enforce Policy Versions"
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns: ["**/Policies/**/*.policy"]
        wholeFile: true # ‚úÖ Read entire file for cross-line checking
        isRegex: true
        tokens:
          # Fails if 'applied=true' is found, but 'version=3.0.0' is NOT found
          - '(?s)^(?=.*policy\.applied\s*=\s*true)(?!.*policy\.version\s*=\s*"3\.0\.0").*$'
</code></pre>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_FORBIDDEN_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Block Deprecated Global Functions</h3>
<br>
Prevent the usage of a deprecated transformation function across all scripts.
<br>
<pre><code class='language-yaml'>- id: "RULE-DEPRECATED-TRANSFORM"
  name: "No Legacy Transformations"
  severity: HIGH
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns: ["**/*.dwl", "**/*.js"]
        tokens: ["toBase64Legacy()", "oldEncrypt()"]
</code></pre>
<h3>Example 2: Block Hardcoded Credentials</h3>
<br>
Identify potential hardcoded secrets in properties or XML configuration files.
<br>
<pre><code class='language-yaml'>- id: "RULE-NO-HARDCODED-SECRETS"
  name: "No Hardcoded Credentials"
  severity: CRITICAL
  errorMessage: "Security Violation: Hardcoded credentials found.\n{DEFAULT_MESSAGE}"
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns: ["**/*.xml", "**/*.properties", "**/*.yaml"]
        tokens: ["password=", "pwd=", "aws_secret="]
        caseSensitive: false

### Example 3: Exact Word Match (Whole Word)
Prevent false positives by ensuring only exact words are matched (e.g., match "admin" but not "administrator").

</code></pre>yaml
<li>id: "RULE-EXACT-WORD"</li>
  name: "Forbid 'admin' User"
  checks:
<li>type: GENERIC_TOKEN_SEARCH_FORBIDDEN</li>
      params:
        filePatterns: ["**/*.properties"]
        tokens: ["admin"]
        wholeWord: true  # Matches 'admin' but not 'administrator'
<pre><code class='language-text'>
### Example 3: Detect IP Addresses (Regex)
Block hardcoded IP addresses in source code directory to enforce hostname usage.

</code></pre>yaml
<li>id: "RULE-HOSTNAME-ENFORCEMENT"</li>
  name: "No Hardcoded IP Addresses"
  severity: HIGH
  checks:
<li>type: GENERIC_TOKEN_SEARCH_FORBIDDEN</li>
      params:
        filePatterns: ["src/<strong>/*.java", "src/</strong>/*.py"]
        excludePatterns: ["<strong>/test/</strong>"]
        tokens: ["\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b"]
        matchMode: REGEX
<pre><code class='language-text'>
&lt;h2 id="GENERIC_TOKEN_SEARCH_FORBIDDEN_ErrorMessages"&gt;Error Messages&lt;/h2&gt;

</code></pre>text
AuthService.java: Forbidden token found: password=
legacy-script.js: Forbidden token found: toBase64Legacy()
DatabaseConfig.xml: Forbidden IP pattern found: 192.168.1.1
<pre><code class='language-text'>
&lt;h2 id="GENERIC_TOKEN_SEARCH_FORBIDDEN_BestPractices"&gt;Best Practices&lt;/h2&gt;

- **Case Sensitivity**: Set `caseSensitive: false` when blocking configuration keys (like `PWD=`) to catch variants like `pwd=` or `Pwd=`.
- **Targeted Exclusions**: Use `excludePatterns` for third-party libraries or internal test suites where forbidden patterns might be legitimate for testing purposes.
- **Whole Word Matching**: Use `wholeWord: true` instead of complex Regex `\b` patterns for simple exact word matching.
- **Regex Guardrails**: When using REGEX, ensure patterns are specific to avoid false positives (e.g., use word boundaries `\\b`).

&lt;h2 id="GENERIC_TOKEN_SEARCH_FORBIDDEN_RelatedRuleTypes"&gt;Related Rule Types&lt;/h2&gt;

- **[GENERIC_TOKEN_SEARCH_REQUIRED](GENERIC_TOKEN_SEARCH_REQUIRED.md)** - Opposite: ensures tokens DO exist.
- **[XML_XPATH_NOT_EXISTS](XML_XPATH_NOT_EXISTS.md)** - Precise blocking of XML structures.

&lt;h2 id="GENERIC_TOKEN_SEARCH_FORBIDDEN_SolutionPatternsandTechnologyReference"&gt;Solution Patterns and Technology Reference&lt;/h2&gt;

Standard configurations for blocking anti-patterns.

| Technology | Scenario | Mode | Target File |
| :--- | :--- | :--- | :--- |
| **‚òï Java** | Block `System.out` | `FORBIDDEN` | `**/*.java` |
| **üêç Python** | Block Debugger | `FORBIDDEN` | `**/*.py` |
| **üì¶ Node.js** | Block `eval()` | `FORBIDDEN` | `**/*.js` |
| **üêé MuleSoft** | Block legacy MEL | `FORBIDDEN` | `**/*.xml` |

### ‚òï Java / Spring Boot Patterns

Prevent developers from using standard output streams for logging.

</code></pre>yaml
<li>id: "JAVA-LOGGING-STANDARDS"</li>
  name: "No System.out"
  checks:
<li>type: GENERIC_TOKEN_SEARCH_FORBIDDEN</li>
      params:
        filePatterns: ["**/*.java"]
        tokens: ["System.out.println", "System.err.println"]
<pre><code class='language-text'>
### üêé MuleSoft Patterns

Block legacy Mule Expression Language (MEL) patterns in modern projects.

</code></pre>yaml
<li>id: "MULE-MODERNIZATION"</li>
  name: "No Legacy MEL"
  checks:
<li>type: GENERIC_TOKEN_SEARCH_FORBIDDEN</li>
      params:
        filePatterns: ["**/*.xml"]
        tokens: ["message.inboundProperties", "message.outboundProperties"]
```
</div><div id="GENERIC_TOKEN_SEARCH_REQUIRED" class="rule-content" style="display: none;"><h1>GENERIC_TOKEN_SEARCH_REQUIRED</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> Any text-based source files
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_Overview">Overview</h2>
<br>
Validates that <strong>required tokens or patterns exist</strong> in files matching specified patterns. This rule <strong>fails</strong> if any of the required tokens are <strong>NOT found</strong>. It is ideal for enforcing mandatory boilerplate, specific imports, or standard configuration keys across different frameworks.
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_UseCases">Use Cases</h2>
<li>Ensure specific imports or modules are present in source files.</li>
<li>Verify that required configuration keys or property placeholders exist.</li>
<li>Validate the presence of mandatory legal headers, author tags, or security annotations.</li>
<li>Check for required framework-specific metadata files or structures.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List </td><td> Glob patterns to match source or configuration files </td></tr><tr><td> <code class='inline-token'>tokens</code> </td><td> List </td><td> List of tokens that must be found in the files </td></tr></table>
<h3>Optional Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>excludePatterns</code> </td><td> List </td><td> <code class='inline-token'>[]</code> </td><td> Glob patterns to exclude specific files </td></tr><tr><td> <code class='inline-token'>matchMode</code> </td><td> String </td><td> <code class='inline-token'>SUBSTRING</code> </td><td> Choose <code class='inline-token'>SUBSTRING</code> or <code class='inline-token'>REGEX</code>. Setting to <code class='inline-token'>REGEX</code> automatically enables regex matching. </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Whether token matching is case-sensitive </td></tr><tr><td> <code class='inline-token'>wholeWord</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> If <code class='inline-token'>true</code>, ensures exact word matching (wraps tokens in <code class='inline-token'>\b</code>). Ignored if <code class='inline-token'>matchMode: REGEX</code>. </td></tr><tr><td> <code class='inline-token'>requireAll</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> If <code class='inline-token'>true</code>, ALL tokens must be found. If <code class='inline-token'>false</code>, at least ONE </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> If <code class='inline-token'>true</code>, resolves properties from the linked configuration project as a fallback. </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> If <code class='inline-token'>true</code>, scans files in BOTH the target project and the linked configuration project. </td></tr><tr><td> <code class='inline-token'>ignoreComments</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> If <code class='inline-token'>true</code>, removes comments before searching. </td></tr><tr><td> <strong><code class='inline-token'>wholeFile</code></strong> </td><td> <strong>Boolean</strong> </td><td> <strong><code class='inline-token'>false</code></strong> </td><td> <strong>If <code class='inline-token'>true</code>, reads the entire file as a single string. Recommended for multi-line regex validation.</strong> </td></tr></table>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Required Framework Import</h3>
<br>
Ensure that all implementation files in a project contain the necessary framework imports for logging.
<br>
<pre><code class='language-yaml'>- id: "RULE-JAVA-REQD-LOGGER"
  name: "Required Logger Import"
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: ["src/**/*.java"]
        tokens: ["import org.slf4j.Logger", "import org.slf4j.LoggerFactory"]
        requireAll: true
</code></pre>
<h3>Example 2: Mandatory Error Handling Pattern</h3>
<br>
Ensure that application configuration files contain mandatory error handling blocks (either "continue" or "propagate" strategies).
<br>
<pre><code class='language-yaml'>- id: "RULE-CONFIG-ERROR-POLICY"
  name: "Required Error Handling"
  severity: HIGH
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: ["src/main/resources/*.xml"]
        tokens: ["on-error-continue", "on-error-propagate"]
        requireAll: false  # At least one must exist
</code></pre>
<br>
<pre><code class='language-yaml'>- id: "RULE-VERSION-SEMVER"
  name: "Required SemVer Descriptor"
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: ["**/pom.xml", "**/package.json"]
        tokens: ["\\d+\\.\\d+\\.\\d+"]
        matchMode: REGEX
</code></pre>
<h3>Example 4: Cross-Project Validation (New)</h3>
<br>
Validate that a property defined in the linked configuration project is correctly referenced in the source code.
<br>
<pre><code class='language-yaml'>- id: "RULE-CROSS-CONFIG-VALIDATION"
  name: "Linked Config Property Validation"
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: ["src/main/mule/*.xml"]
        tokens: ["${secure.key}"]
        resolveProperties: true
        resolveLinkedConfig: true     # Resolves from linked project if not found in current
        includeLinkedConfig: true      # Also scans files in the linked project
</code></pre>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>DatabaseConfig.java: Missing required token: import org.slf4j.Logger
app-descriptor.xml: Missing at least one required token: [on-error-continue, on-error-propagate]
</code></pre>
<h3>üìÑ Whole File Search (<code class='inline-token'>wholeFile</code>)</h3>
<br>
<strong>NEW FEATURE:</strong> When <code class='inline-token'>wholeFile: true</code> is enabled, the check processes the entire file content as a single block of text rather than line-by-line. 
<h4>Why Use This?</h4>
Standard line-by-line regex cannot see relationships between different lines. With <code class='inline-token'>wholeFile</code>, you can use <strong>DOTALL</strong> regex <code class='inline-token'>(?s)</code> to validate patterns spanning multiple lines.
<h4>Example: Cross-Line Requirement</h4>
Ensures that if a certain property is present, a related property must also exist anywhere in the same file.
<br>
<pre><code class='language-yaml'>- id: "BANK-MANDATORY-REFS"
  name: "Enforce Property References"
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: ["**/*.properties"]
        wholeFile: true
        isRegex: true
        tokens:
          # Match a file that contains BOTH property A and property B
          - '(?s)^(?=.*prop\.A=.*)(?=.*prop\.B=.*).*$'
</code></pre>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_BestPractices">Best Practices</h2>
<li><strong>Broad File Patterns</strong>: Use this rule at a high level to ensure that *every* file of a certain type adheres to structural requirements (like license headers).</li>
<li><strong>Combine with Exclusion</strong>: Use <code class='inline-token'>excludePatterns</code> to skip generated code, third-party libraries, or test files where these rules might not apply.</li>
<li><strong>Fail on Composition</strong>: This rule is most effective when used to ensure that cross-cutting concerns (logging, security, error handling) are at least *present* in the codebase.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN')">GENERIC_TOKEN_SEARCH_FORBIDDEN</a></strong> - Opposite: ensures tokens do NOT exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></strong> - More precise XML validation using structural paths.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_SolutionPatternsandTechnologyReference">Solution Patterns and Technology Reference</h2>
<br>
Standard configurations for enforcing mandatory components.
<table><tr><td> Technology </td><td> Requirement </td><td> Mode </td><td> Target File </td></tr><tr><td> <strong>‚òï Java</strong> </td><td> Security Annotations </td><td> <code class='inline-token'>REQUIRED</code> </td><td> <code class='inline-token'>*Controller.java</code> </td></tr><tr><td> <strong>üêç Python</strong> </td><td> Shebang Reference </td><td> <code class='inline-token'>REQUIRED</code> </td><td> <code class='inline-token'>*.py</code> </td></tr><tr><td> <strong>üì¶ Node.js</strong> </td><td> Module Exports </td><td> <code class='inline-token'>REQUIRED</code> </td><td> <code class='inline-token'>*.js</code> </td></tr><tr><td> <strong>üêé MuleSoft</strong> </td><td> DataWeave Version </td><td> <code class='inline-token'>REQUIRED</code> </td><td> <code class='inline-token'>*.dwl</code> </td></tr></table>
<h3>‚òï Java / Spring Boot Patterns</h3>
<br>
Ensure controllers have standard security annotations.
<br>
<pre><code class='language-yaml'>- id: "JAVA-SECURE-CONTROLLER"
  name: "Secure Controllers"
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: ["**/*Controller.java"]
        tokens: ["@PreAuthorize", "@Secured"]
        requireAll: false
</code></pre>
<h3>üêç Python Patterns</h3>
<br>
Ensure scripts specify the required python version via shebang.
<br>
<pre><code class='language-yaml'>- id: "PY-MIN-VERSION"
  name: "Python 3 Shebang"
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: ["*.py"]
        tokens: ["#!/usr/bin/env python3"]
</code></pre>
</div><div id="JSON_VALIDATION_FORBIDDEN" class="rule-content" style="display: none;"><h1>JSON_VALIDATION_FORBIDDEN</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> JSON configuration files (package.json, config.json, etc.)
<br>
<h2 id="JSON_VALIDATION_FORBIDDEN_Overview">Overview</h2>
<br>
Validates that <strong>forbidden JSON elements do NOT exist</strong> in JSON files. This rule <strong>fails</strong> if forbidden elements <strong>ARE found</strong>. It is useful for blocking deprecated fields, insecure settings, or unapproved metadata.
<br>
<h2 id="JSON_VALIDATION_FORBIDDEN_UseCases">Use Cases</h2>
<li>Prevent usage of deprecated configuration keys in project descriptors.</li>
<li>Block sensitive data fields (e.g., <code class='inline-token'>password</code>, <code class='inline-token'>secret</code>) in configuration JSON.</li>
<li>Disallow certain unapproved metadata or development-only flags in production JSON.</li>
<li>Enforce strict JSON structure by restricting specific keys.</li>
<h3>Global Settings (Optional)</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePattern</code> </td><td> String </td><td> Filename pattern to match (e.g., <code class='inline-token'>mule-artifact.json</code>, <code class='inline-token'>package.json</code>) </td></tr></table>
<h3>Forbidden Parameters (At least one required)</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <strong><code class='inline-token'>forbiddenElements</code></strong> </td><td> List<String> </td><td> List of forbidden JSON keys (top-level or simple nested paths). Fails if <strong>Exists</strong>. </td></tr><tr><td> <strong><code class='inline-token'>forbiddenFields</code></strong> </td><td> Map </td><td> Fails if field <strong>Matches Value</strong> (String equality). Logic: <code class='inline-token'>Actual == ForbiddenValue</code> -> Fail. </td></tr><tr><td> <strong><code class='inline-token'>forbiddenVersions</code></strong> </td><td> Map </td><td> Fails if field <strong>Matches Version</strong> (SemVer equality). Logic: <code class='inline-token'>Actual == ForbiddenVersion</code> -> Fail. </td></tr></table>
<br>
<h2 id="JSON_VALIDATION_FORBIDDEN_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Block Deprecated Project Fields</h3>
Prevents usage of legacy configuration fields in project descriptors.
<br>
<pre><code class='language-yaml'>- id: "RULE-JSON-FORBIDDEN-01"
  name: "No Deprecated Project Fields"
  description: "Prevent usage of legacy fields in project descriptors"
  enabled: true
  severity: MEDIUM
  checks:
    - type: JSON_VALIDATION_FORBIDDEN
      params:
        filePattern: "project-descriptor.json"
        forbiddenElements:
          - "legacyMode"
          - "deprecatedConfig"
</code></pre>
<h3>Example 2: Block Sensitive Fields in Node.js</h3>
Ensures <code class='inline-token'>package.json</code> does not contain sensitive or development-only keys.
<br>
<pre><code class='language-yaml'>- id: "RULE-JSON-FORBIDDEN-NODE"
  name: "Clean Package JSON"
  description: "Prevent unapproved keys in package.json"
  enabled: true
  severity: HIGH
  checks:
    - type: JSON_VALIDATION_FORBIDDEN
      params:
        filePattern: "package.json"
        forbiddenElements:
          - "privateRepositoryUrl"
        forbiddenFields:
          "scripts/test": "echo 'no test'" # Forbid dummy test scripts
        forbiddenVersions:
          "engines/node": "14.17.0"      # Forbid a specific known-vulnerable version
</code></pre>
<br>
<h2 id="JSON_VALIDATION_FORBIDDEN_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>project-descriptor.json has forbidden element: legacyMode
Forbidden field value found 'scripts/test': 'echo 'no test''
Forbidden version found for 'engines/node': '14.17.0'
</code></pre>
<br>
<h2 id="JSON_VALIDATION_FORBIDDEN_BestPractices">Best Practices</h2>
<h3>When to Use This Rule</h3>
<li><strong>Deprecation</strong>: Use it to enforce a "hard cut-over" when migrating from old config formats to new ones.</li>
<li><strong>Security</strong>: Prevent hardcoded secrets or insecure flags (like <code class='inline-token'>allowInsecure: true</code>) from being committed.</li>
<li><strong>Cleanliness</strong>: Keep project descriptors streamlined by blocking unapproved experimental fields.</li>
<h4>GLOBAL Parameters (Optional)</h4>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<hr>
<br>
<h2 id="JSON_VALIDATION_FORBIDDEN_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED')">JSON_VALIDATION_REQUIRED</a></strong> - Opposite: ensures elements DO exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN')">GENERIC_TOKEN_SEARCH_FORBIDDEN</a></strong> - More flexible search for forbidden patterns across any file type.</li>
</div><div id="JSON_VALIDATION_REQUIRED" class="rule-content" style="display: none;"><h1>JSON_VALIDATION_REQUIRED</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> JSON configuration files (package.json, etc.)
<br>
<h2 id="JSON_VALIDATION_REQUIRED_Overview">Overview</h2>
<br>
Validates that <strong>required JSON elements exist</strong> in JSON files. This rule is essential for validating project descriptors like <code class='inline-token'>mule-artifact.json</code>, <code class='inline-token'>package.json</code>, or custom configuration files. It supports <strong>version checking</strong>, <strong>specific field value validation</strong>, and <strong>field existence checks</strong>.
<br>
<h2 id="JSON_VALIDATION_REQUIRED_UseCases">Use Cases</h2>
<li>Validate <code class='inline-token'>mule-artifact.json</code> structure and runtime versions.</li>
<li>Ensure <code class='inline-token'>package.json</code> contains required scripts or engines configuration.</li>
<li>Ensure required configuration keys exist in custom JSON config files.</li>
<li>Enforce specific values for critical JSON fields (e.g., <code class='inline-token'>javaSpecificationVersions</code>).</li>
<br>
<h2 id="JSON_VALIDATION_REQUIRED_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePattern</code> </td><td> String </td><td> Precise filename to match (e.g., <code class='inline-token'>mule-artifact.json</code>, <code class='inline-token'>package.json</code>) </td></tr></table>
<h3>Standard Validation Parameters (Must configure at least one)</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>minVersions</code> </td><td> Map </td><td> Checks if a field's value meets a minimum version (Supports Arrays). Logic: <code class='inline-token'>Actual &gt;= Min</code> (SemVer). If array: Pass if *any* element >= Min. </td></tr><tr><td> <strong><code class='inline-token'>exactVersions</code></strong> </td><td> Map </td><td> Checks if a field's value exactly matches a version (Supports Arrays). Logic: <code class='inline-token'>Actual == Expected</code> (SemVer). If array: Pass if *any* element == Expected. </td></tr><tr><td> <code class='inline-token'>requiredFields</code> </td><td> Map </td><td> Checks if a field matches an expected value (Supports Arrays). Logic: <code class='inline-token'>Actual == Expected</code> (String Equality). If array: Pass if *any* element matches. </td></tr><tr><td> <code class='inline-token'>requiredElements</code> </td><td> List </td><td> Checks if a field simply exists (value ignored) </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="JSON_VALIDATION_REQUIRED_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Project Descriptor Validation (MuleSoft)</h3>
Validates minimum runtime version, required Java version, and presence of secure properties.
<br>
<pre><code class='language-yaml'>- id: "RULE-JSON-MULE"
  name: "Validate Mule Project Descriptor"
  description: "Ensures mule-artifact.json meets minimum runtime requirements"
  enabled: true
  severity: HIGH
  checks:
    - type: JSON_VALIDATION_REQUIRED
      params:
        filePattern: "mule-artifact.json"
        exactVersions:
             minMuleVersion: "4.9.0"  # Must be exactly 4.9.0
        requiredFields:
          javaSpecificationVersions: "17" # String match
        requiredElements:
          - "secureProperties"
</code></pre>
<h3>Example 2: Node.js / TypeScript Package Validation</h3>
Ensures the project has a start script and requires a minimum Node engine.
<br>
<pre><code class='language-yaml'>- id: "RULE-JSON-NODE"
  name: "Validate Node.js Package"
  description: "Ensures package.json has required scripts and engines"
  enabled: true
  severity: HIGH
  errorMessage: "Package validation failed.\n{DEFAULT_MESSAGE}"
  checks:
    - type: JSON_VALIDATION_REQUIRED
      params:
        filePattern: "package.json"
        requiredFields:
          scripts/start: "node index.js"
        minVersions:
          engines/node: "18.0.0" # Must be &gt;= 18.0.0
        requiredElements:
          - "dependencies"
          - "license"
</code></pre>
<br>
<h2 id="JSON_VALIDATION_REQUIRED_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>Field 'minMuleVersion' version too low in mule-artifact.json: expected &gt;= 4.9.0, got 4.4.0
Version mismatch for 'minMuleVersion': Found='4.4.0', Expected Exactly='4.9.0'
Element 'secureProperties' missing in mule-artifact.json
</code></pre>
<br>
<br>
<h2 id="JSON_VALIDATION_REQUIRED_BestPractices">Best Practices</h2>
<h3>When to Use This Rule</h3>
<li> Validating project descriptors for runtime compatibility.</li>
<li> Ensuring minimum platform/engine versions for security.</li>
<li> Enforcing required configuration fields in application JSON.</li>
<li> Standardizing JSON structure across multiple repositories.</li>
<br>
<h2 id="JSON_VALIDATION_REQUIRED_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN')">JSON_VALIDATION_FORBIDDEN</a></strong> - Opposite: ensures elements do NOT exist</li>
</div><div id="POM_VALIDATION_FORBIDDEN" class="rule-content" style="display: none;"><h1>POM_VALIDATION_FORBIDDEN</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> Maven POM files (<code class='inline-token'>pom.xml</code>)
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_Overview">Overview</h2>
<br>
Validates that <strong>forbidden elements do NOT exist</strong> in Maven POM files (<code class='inline-token'>pom.xml</code>). This rule <strong>fails</strong> if forbidden POM elements <strong>ARE found</strong>. It is commonly used to block vulnerable libraries, deprecated plugins, or insecure configuration properties.
<br>
Supports validation of:
<li><strong>Forbidden Properties</strong> (property names)</li>
<li><strong>Forbidden Dependencies</strong> (groupId, artifactId, optional version)</li>
<li><strong>Forbidden Plugins</strong> (groupId, artifactId, optional version)</li>
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_UseCases">Use Cases</h2>
<li>Block deprecated or vulnerable dependencies (e.g., Log4j 1.x, old Struts).</li>
<li>Prevent usage of forbidden or untrusted Maven plugins.</li>
<li>Disallow specific internal properties from being hardcoded or overridden in production.</li>
<li>Enforce dependency exclusion policies by banning restricted group/artifact IDs.</li>
<li>Block specific vulnerable versions while allowing safe, patched versions.</li>
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>validationType</code> </td><td> String </td><td> Type of validation: <code class='inline-token'>PROPERTIES</code>, <code class='inline-token'>DEPENDENCIES</code>, <code class='inline-token'>PLUGINS</code>, or <code class='inline-token'>COMBINED</code> </td></tr></table>
<h3>Validation-Specific Parameters</h3>
<h4>PROPERTIES Validation</h4>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>forbiddenProperties</code> </td><td> List<String> </td><td> Yes </td><td> List of property names that must NOT exist </td></tr></table>
<h4>DEPENDENCIES Validation</h4>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>forbiddenDependencies</code> </td><td> List<Map> </td><td> Yes </td><td> List of forbidden dependencies </td></tr><tr><td> <code class='inline-token'>forbiddenDependencies[].groupId</code> </td><td> String </td><td> Yes </td><td> Dependency groupId </td></tr><tr><td> <code class='inline-token'>forbiddenDependencies[].artifactId</code> </td><td> String </td><td> Yes </td><td> Dependency artifactId </td></tr><tr><td> <code class='inline-token'>forbiddenDependencies[].version</code> </td><td> String </td><td> <strong>No</strong> </td><td> <strong>Optional</strong>: If specified, only that specific version is forbidden </td></tr></table>
<h4>PLUGINS Validation</h4>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>forbiddenPlugins</code> </td><td> List<Map> </td><td> Yes </td><td> List of forbidden plugins </td></tr><tr><td> <code class='inline-token'>forbiddenPlugins[].groupId</code> </td><td> String </td><td> Yes </td><td> Plugin groupId </td></tr><tr><td> <code class='inline-token'>forbiddenPlugins[].artifactId</code> </td><td> String </td><td> Yes </td><td> Plugin artifactId </td></tr><tr><td> <code class='inline-token'>forbiddenPlugins[].version</code> </td><td> String </td><td> <strong>No</strong> </td><td> <strong>Optional</strong>: If specified, only that specific version is forbidden </td></tr></table>
<hr>
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Forbidden Properties (Environment/Security)</h3>
<br>
Block properties that should only be handled via environment variables or CI/CD injection.
<br>
<pre><code class='language-yaml'>- id: "RULE-POM-FORBIDDEN-PROP"
  name: "No Hardcoded Credentials"
  description: "Credentials must not be stored as POM properties"
  enabled: true
  severity: CRITICAL
  checks:
    - type: POM_VALIDATION_FORBIDDEN
      params:
        validationType: PROPERTIES
        forbiddenProperties:
          - "db.password"
          - "api.key"
          - "secret.token"
</code></pre>
<hr>
<h3>Example 2: Forbidden Dependency (Security Vulnerability)</h3>
<br>
Block a specific version of Log4j known for critical vulnerabilities.
<br>
<pre><code class='language-yaml'>- id: "RULE-POM-FORBIDDEN-LOG4J"
  name: "Block Vulnerable Log4j"
  description: "Ensure vulnerable versions of log4j-core are not used"
  enabled: true
  severity: CRITICAL
  checks:
    - type: POM_VALIDATION_FORBIDDEN
      params:
        validationType: DEPENDENCIES
        forbiddenDependencies:
          - groupId: "org.apache.logging.log4j"
            artifactId: "log4j-core"
            version: "2.14.1"
</code></pre>
<hr>
<h3>Example 3: Forbidden Plugins (Standardization)</h3>
<br>
Prevent the use of problematic or redundant build plugins.
<br>
<pre><code class='language-yaml'>- id: "RULE-POM-FORBIDDEN-PLUGIN"
  name: "Plugin Restriction"
  description: "Block forbidden or deprecated build plugins"
  enabled: true
  severity: MEDIUM
  checks:
    - type: POM_VALIDATION_FORBIDDEN
      params:
        validationType: PLUGINS
        forbiddenPlugins:
          - groupId: "org.codehaus.mojo"
            artifactId: "findbugs-maven-plugin" # Replaced by SpotBugs
</code></pre>
<hr>
<h3>Example 4: Combined Validation (Policy Blocklist)</h3>
<br>
Block multiple forbidden elements in one cohesive policy.
<br>
<pre><code class='language-yaml'>- id: "RULE-POM-BLOCKLIST"
  name: "Corporate Policy Blocklist"
  description: "Block all known deprecated and insecure elements"
  enabled: true
  severity: HIGH
  checks:
    - type: POM_VALIDATION_FORBIDDEN
      params:
        validationType: COMBINED
        forbiddenProperties:
          - "legacy.mode.enabled"
        forbiddenDependencies:
          - groupId: "log4j"
            artifactId: "log4j" # 1.x version
        forbiddenPlugins:
          - groupId: "org.apache.maven.plugins"
            artifactId: "maven-antrun-plugin"
</code></pre>
<hr>
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>Forbidden property 'db.password' found in pom.xml
Forbidden dependency org.apache.logging.log4j:log4j-core:2.14.1 found in pom.xml
Forbidden plugin org.codehaus.mojo:findbugs-maven-plugin found in pom.xml
</code></pre>
<hr>
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_BestPractices">Best Practices</h2>
<li><strong>Block all versions for deprecation</strong>: If a library is completely replaced, don't specify a version so that ALL versions are forbidden.</li>
<li><strong>Specific versions for security</strong>: If only one version is vulnerable, specify that exact version to allow projects to use safe, newer releases.</li>
<li><strong>Exclusion Lists</strong>: Use combined rules for enterprise-wide policy enforcement (e.g., "Standard Blocklist 2024").</li>
<hr>
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_SolutionPatternsandTechnologyReferences">Solution Patterns and Technology References</h2>
<table><tr><td> Technology </td><td> Best Practice Goal </td><td> Forbidden Item </td><td> Reason </td></tr><tr><td> <strong>‚òï Java/Maven</strong> </td><td> Security </td><td> <code class='inline-token'>log4j</code> (1.x) </td><td> Critical vulnerabilities </td></tr><tr><td> <strong>‚òï Java/Maven</strong> </td><td> Build Safety </td><td> <code class='inline-token'>maven-antrun-plugin</code> </td><td> Unstructured build logic </td></tr><tr><td> <strong>üêé MuleSoft</strong> </td><td> Migration Safety </td><td> <code class='inline-token'>mule-module-http</code> </td><td> Deprecated in Mule 4 </td></tr></table>
<h3>‚òï Java / Maven Patterns</h3>
<br>
<strong>Scenario</strong>: Enterprise security teams often maintain a "banned library" list. Aegis enforces this automatically during the build or code review phase.
<br>
<pre><code class='language-yaml'>id: "SECURITY-BANNED-LIBS"
name: "Banned Security Libraries"
description: "Block known insecure libraries"
checks:
  - type: POM_VALIDATION_FORBIDDEN
    params:
      forbiddenDependencies:
        - groupId: "log4j"
          artifactId: "log4j"
        - groupId: "org.apache.struts"
          artifactId: "struts2-core"
          version: "2.3.20"
</code></pre>
<hr>
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED')">POM_VALIDATION_REQUIRED</a></strong> - Opposite: ensures elements DO exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')">XML_XPATH_NOT_EXISTS</a></strong> - For complex nested forbidden structures in POM/XML.</li>
<li><strong><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN')">JSON_VALIDATION_FORBIDDEN</a></strong> - Similar validation for JSON-based projects.</li>
<hr>
<br>
<br>
</div><div id="POM_VALIDATION_REQUIRED" class="rule-content" style="display: none;"><h1>POM_VALIDATION_REQUIRED</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> Maven POM files (<code class='inline-token'>pom.xml</code>)
<br>
<h2 id="POM_VALIDATION_REQUIRED_Overview">Overview</h2>
<br>
Validates that <strong>required elements exist</strong> in Maven POM files (<code class='inline-token'>pom.xml</code>). This rule <strong>fails</strong> if required POM elements are <strong>NOT found</strong> or don't match expected values.
<br>
Supports validation of:
<li><strong>Parent POM</strong> (groupId, artifactId, version)</li>
<li><strong>Properties</strong> (name and value pairs)</li>
<li><strong>Dependencies</strong> (groupId, artifactId, optional version)</li>
<li><strong>Plugins</strong> (groupId, artifactId, optional version)</li>
<br>
<h2 id="POM_VALIDATION_REQUIRED_UseCases">Use Cases</h2>
<li>Ensure required dependencies (like logging or security libs) are declared.</li>
<li>Validate Maven plugin configurations for build consistency.</li>
<li>Enforce parent POM standards across a microservices architecture.</li>
<li>Check for mandatory project metadata and versioning schemes.</li>
<li>Validate specific dependency versions for security compliance (e.g., blocking known vulnerable versions).</li>
<br>
<h2 id="POM_VALIDATION_REQUIRED_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>validationType</code> </td><td> String </td><td> Type of validation: <code class='inline-token'>PARENT</code>, <code class='inline-token'>PROPERTIES</code>, <code class='inline-token'>DEPENDENCIES</code>, <code class='inline-token'>PLUGINS</code>, or <code class='inline-token'>COMBINED</code> </td></tr></table>
<h3>Validation-Specific Parameters</h3>
<h4>PARENT Validation</h4>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>parent</code> </td><td> Map </td><td> Yes </td><td> Parent POM configuration </td></tr><tr><td> <code class='inline-token'>parent.groupId</code> </td><td> String </td><td> Yes </td><td> Expected parent groupId </td></tr><tr><td> <code class='inline-token'>parent.artifactId</code> </td><td> String </td><td> Yes </td><td> Expected parent artifactId </td></tr><tr><td> <code class='inline-token'>parent.version</code> </td><td> String </td><td> No </td><td> <strong>Exact match</strong>: Expected parent version </td></tr><tr><td> <code class='inline-token'>parent.minVersion</code> </td><td> String </td><td> No </td><td> <strong>NEW</strong>: Minimum version (>= comparison) </td></tr><tr><td> <code class='inline-token'>parent.maxVersion</code> </td><td> String </td><td> No </td><td> <strong>NEW</strong>: Maximum version (<= comparison) </td></tr></table>
<h4>PROPERTIES Validation</h4>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>properties</code> </td><td> List<Map> </td><td> Yes </td><td> List of required properties </td></tr><tr><td> <code class='inline-token'>properties[].name</code> </td><td> String </td><td> Yes </td><td> Property name </td></tr><tr><td> <code class='inline-token'>properties[].expectedValue</code> </td><td> String </td><td> No </td><td> <strong>Exact match</strong>: Expected property value </td></tr><tr><td> <code class='inline-token'>properties[].minVersion</code> </td><td> String </td><td> No </td><td> <strong>NEW</strong>: Minimum version (>= comparison) </td></tr><tr><td> <code class='inline-token'>properties[].maxVersion</code> </td><td> String </td><td> No </td><td> <strong>NEW</strong>: Maximum version (<= comparison) </td></tr><tr><td> <code class='inline-token'>properties[].greaterThan</code> </td><td> String </td><td> No </td><td> <strong>NEW</strong>: Greater than (> comparison) </td></tr><tr><td> <code class='inline-token'>properties[].lessThan</code> </td><td> String </td><td> No </td><td> <strong>NEW</strong>: Less than (< comparison) </td></tr></table>
<h4>DEPENDENCIES Validation</h4>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>dependencies</code> </td><td> List<Map> </td><td> Yes </td><td> List of required dependencies </td></tr><tr><td> <code class='inline-token'>dependencies[].groupId</code> </td><td> String </td><td> Yes </td><td> Dependency groupId </td></tr><tr><td> <code class='inline-token'>dependencies[].artifactId</code> </td><td> String </td><td> Yes </td><td> Dependency artifactId </td></tr><tr><td> <code class='inline-token'>dependencies[].version</code> </td><td> String </td><td> <strong>No</strong> </td><td> <strong>Optional</strong>: If specified, validates exact version </td></tr></table>
<h4>PLUGINS Validation</h4>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>plugins</code> </td><td> List<Map> </td><td> Yes </td><td> List of required plugins </td></tr><tr><td> <code class='inline-token'>plugins[].groupId</code> </td><td> String </td><td> Yes </td><td> Plugin groupId </td></tr><tr><td> <code class='inline-token'>plugins[].artifactId</code> </td><td> String </td><td> Yes </td><td> Plugin artifactId </td></tr></table>
<h4>GLOBAL Parameters (Optional)</h4>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<hr>
<br>
<h2 id="POM_VALIDATION_REQUIRED_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Parent POM Validation - Minimum Version (NEW)</h3>
<br>
Enforce a minimum parent POM version instead of exact match.
<br>
<pre><code class='language-yaml'>- id: "RULE-POM-PARENT"
  name: "Enforce Standard Parent POM (Minimum Version)"
  description: "All projects must use CorporateParent version &gt;= 2.5.0"
  enabled: true
  severity: HIGH
  checks:
    - type: POM_VALIDATION_REQUIRED
      params:
        validationType: PARENT
        parent:
          groupId: "com.corporation.framework"
          artifactId: "CorporateParent"
          minVersion: "2.5.0"  # NEW: Allows 2.5.0, 2.5.1, 2.6.0, 3.0.0, etc.
</code></pre>
<br>
<strong>Benefits</strong>: More flexible - allows patch/minor updates without rule changes.
<br>
<strong>Test Results</strong>:
<li>Parent version <code class='inline-token'>2.5.0</code> ‚Üí ‚úÖ PASS</li>
<li>Parent version <code class='inline-token'>2.5.5</code> ‚Üí ‚úÖ PASS  </li>
<li>Parent version <code class='inline-token'>3.0.0</code> ‚Üí ‚úÖ PASS</li>
<li>Parent version <code class='inline-token'>2.4.9</code> ‚Üí ‚ùå FAIL</li>
<hr>
<h3>Example 2: Properties Validation - Minimum Versions (NEW)</h3>
<br>
Validate minimum versions for build tools and runtime.
<br>
<pre><code class='language-yaml'>- id: "RULE-POM-PROP"
  name: "Build Tool Minimum Versions"
  description: "Ensure mule.maven.plugin.version &gt;= 4.5.0 and app.runtime &gt;= 4.9.0"
  enabled: true
  severity: HIGH
  checks:
    - type: POM_VALIDATION_REQUIRED
      params:
        validationType: PROPERTIES
        properties:
          - name: "mule.maven.plugin.version"
            minVersion: "4.5.0"  # NEW: Allows 4.5.0, 4.6.1, 5.0.0, etc.
          - name: "app.runtime"
            minVersion: "4.9.0"  # NEW: Works with 4.9.0, 4.9.LTS, 4.10.0, etc.
          - name: "cicd.mule.version"
            expectedValue: "4.9.LTS"  # Exact match still supported
</code></pre>
<br>
<strong>Alphanumeric Version Support</strong>: Versions like <code class='inline-token'>4.9.LTS</code> are supported. LTS qualifier is treated as HIGHER than no qualifier.
<br>
<strong>Test Results</strong>:
<li><code class='inline-token'>mule.maven.plugin.version: 4.6.1</code> ‚Üí ‚úÖ PASS</li>
<li><code class='inline-token'>mule.maven.plugin.version: 4.4.9</code> ‚Üí ‚ùå FAIL</li>
<li><code class='inline-token'>app.runtime: 4.9.LTS</code> ‚Üí ‚úÖ PASS (LTS >= 4.9.0)</li>
<li><code class='inline-token'>app.runtime: 4.8.5</code> ‚Üí ‚ùå FAIL</li>
<hr>
<h3>Example 3: Dependency Validation (Security Libs)</h3>
<br>
Require a specific security library version.
<br>
<pre><code class='language-yaml'>- id: "RULE-POM-DEP"
  name: "Security Library Requirement"
  description: "Standard security core must be present"
  enabled: true
  severity: CRITICAL
  checks:
    - type: POM_VALIDATION_REQUIRED
      params:
        validationType: DEPENDENCIES
        dependencies:
          - groupId: "com.corporation.security"
            artifactId: "security-core"
            version: "3.2.1"
</code></pre>
<hr>
<h3>Example 4: Version Range Validation (NEW)</h3>
<br>
Combine minVersion and maxVersion for range validation.
<br>
<pre><code class='language-yaml'>- id: "RULE-POM-VERSION-RANGE"
  name: "Plugin Version Range"
  description: "Plugin version must be between 4.5.0 and 5.0.0"
  enabled: true
  severity: MEDIUM
  checks:
    - type: POM_VALIDATION_REQUIRED
      params:
        validationType: PROPERTIES
        properties:
          - name: "plugin.version"
            minVersion: "4.5.0"
            maxVersion: "5.0.0"  # Must be between 4.5.0 and 5.0.0
</code></pre>
<br>
<strong>Test Results</strong>:
<li><code class='inline-token'>plugin.version: 4.6.1</code> ‚Üí ‚úÖ PASS (within range)</li>
<li><code class='inline-token'>plugin.version: 5.0.0</code> ‚Üí ‚úÖ PASS (at max)</li>
<li><code class='inline-token'>plugin.version: 5.0.1</code> ‚Üí ‚ùå FAIL (exceeds max)</li>
<li><code class='inline-token'>plugin.version: 4.4.9</code> ‚Üí ‚ùå FAIL (below min)</li>
<hr>
<br>
<h2 id="POM_VALIDATION_REQUIRED_EnhancedReportingNEW">Enhanced Reporting (NEW)</h2>
<br>
Success messages now include <strong>actual values found</strong> for better transparency:
<br>
<pre><code class='language-text'>‚úÖ PASS: Validate Parent POM (Minimum Version)

All required POM elements found
Files validated: pom.xml

Actual Values Found:
‚Ä¢ Parent: com.corporation.framework:CorporateParent:2.5.5 (in pom.xml)
‚Ä¢ Property 'mule.maven.plugin.version': 4.6.1 (in pom.xml)
‚Ä¢ Property 'app.runtime': 4.9.LTS (in pom.xml)
</code></pre>
<br>
This shows:
<li>‚úÖ What was expected (rule configuration)</li>
<li>‚úÖ What was actually found (actual values)</li>
<li>‚úÖ Builds confidence in validation results</li>
<hr>
<br>
<h2 id="POM_VALIDATION_REQUIRED_ErrorMessages">Error Messages</h2>
<br>
<strong>Version Comparison Errors</strong> (NEW):
<pre><code class='language-text'>Parent version too low in pom.xml: com.corp:Parent expected &gt;= '2.5.0', got '2.4.9'
Property 'mule.maven.plugin.version' version too low in pom.xml: expected &gt;= '4.5.0', got '4.4.9'
Property 'app.runtime' version too high in pom.xml: expected &lt;= '5.0.0', got '5.1.0'
</code></pre>
<br>
<strong>Exact Match Errors</strong> (Existing):
<pre><code class='language-text'>Parent version mismatch in pom.xml: expected com.corp:Parent:2.5.0, got version '1.0.0'
Property 'maven.compiler.source' has wrong value in pom.xml: expected '17', got '11'
Dependency com.corporation.security:security-core not found in pom.xml
</code></pre>
<hr>
<br>
<h2 id="POM_VALIDATION_REQUIRED_VersionComparisonLogicNEW">Version Comparison Logic (NEW)</h2>
<h3>Numeric Versions</h3>
Versions are compared numerically by major.minor.patch:
<pre><code class='language-text'>4.9.0 &lt; 4.9.1 &lt; 4.10.0 &lt; 5.0.0
</code></pre>
<h3>Alphanumeric Versions (e.g., LTS)</h3>
Versions with qualifiers like <code class='inline-token'>LTS</code> are supported:
<pre><code class='language-text'>Version: "4.9.LTS"
  ‚îú‚îÄ‚îÄ major: 4
  ‚îú‚îÄ‚îÄ minor: 9
  ‚îú‚îÄ‚îÄ patch: 0
  ‚îî‚îÄ‚îÄ qualifier: "LTS"
</code></pre>
<br>
<strong>Comparison Rules</strong>:
1. Compare major.minor.patch numerically first
2. If equal, compare qualifiers
3. <strong>LTS is treated as HIGHER than no qualifier</strong>
<br>
<strong>Examples</strong>:
<li><code class='inline-token'>4.9.LTS &gt;= 4.9.0</code> ‚Üí ‚úÖ TRUE (LTS > no qualifier)</li>
<li><code class='inline-token'>4.9.0 &gt;= 4.9.0</code> ‚Üí ‚úÖ TRUE (equal)</li>
<li><code class='inline-token'>4.10.0 &gt;= 4.9.LTS</code> ‚Üí ‚úÖ TRUE (4.10 > 4.9)</li>
<li><code class='inline-token'>4.8.5 &gt;= 4.9.0</code> ‚Üí ‚ùå FALSE (4.8 < 4.9)</li>
<hr>
<br>
<h2 id="POM_VALIDATION_REQUIRED_BestPractices">Best Practices</h2>
<li><strong>Use version validation for security</strong>: Lock critical security libraries to specific patched versions.</li>
<li><strong>Flexible utilities</strong>: For standard utilities (e.g., <code class='inline-token'>commons-lang</code>), omit the <code class='inline-token'>version</code> parameter to allow project-specific updates unless a specific version is required for compatibility.</li>
<li><strong>Combined Rules</strong>: Use <code class='inline-token'>validationType: COMBINED</code> to reduce the number of rules defined when multiple checks are related to the same "standard" (e.g., "Corporate Standard v2").</li>
<hr>
<br>
<h2 id="POM_VALIDATION_REQUIRED_SolutionPatternsandTechnologyReferences">Solution Patterns and Technology References</h2>
<table><tr><td> Technology </td><td> Best Practice Goal </td><td> Key Elements </td><td> Attributes Checked </td></tr><tr><td> <strong>‚òï Java/Maven</strong> </td><td> Parent POM Usage </td><td> <code class='inline-token'>parent</code> </td><td> <code class='inline-token'>version</code> </td></tr><tr><td> <strong>‚òï Java/Maven</strong> </td><td> Compiler Standard </td><td> <code class='inline-token'>properties</code> </td><td> <code class='inline-token'>maven.compiler.source</code> </td></tr><tr><td> <strong>üêé MuleSoft</strong> </td><td> Mule Plugin Check </td><td> <code class='inline-token'>mule-maven-plugin</code> </td><td> <code class='inline-token'>version</code> </td></tr></table>
<h3>‚òï Java / Maven Patterns</h3>
<br>
<strong>Scenario</strong>: To ensure reproducible builds, it is critical that the <code class='inline-token'>parent</code> POM is strictly versioned and that major build plugins are explicitly defined with their respective versions.
<br>
<pre><code class='language-yaml'>id: "MAVEN-PARENT-CHECK"
name: "Parent POM Validation"
description: "Ensure specific corporate parent POM is used"
checks:
  - type: POM_VALIDATION_REQUIRED
    params:
      parent:
        groupId: "com.corporation.framework"
        artifactId: "CorporateParent"
        version: "2.5.0"
</code></pre>
<hr>
<br>
<h2 id="POM_VALIDATION_REQUIRED_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN')">POM_VALIDATION_FORBIDDEN</a></strong> - Opposite: ensures elements do NOT exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></strong> - For more granular POM validation using raw XPath.</li>
<li><strong><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED')">JSON_VALIDATION_REQUIRED</a></strong> - Similar validation for JSON-based projects (Node.js, Mule artifacts).</li>
<hr>
<br>
<br>
</div><div id="XML_ATTRIBUTE_EXISTS" class="rule-content" style="display: none;"><h1>XML_ATTRIBUTE_EXISTS</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> XML configuration files
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_Overview">Overview</h2>
<br>
Validates that <strong>required XML attributes exist</strong> on specified elements, optionally checking for specific values. This is a highly flexible rule supporting simple existence checks, specific value matching, and multi-attribute set validation.
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_UseCases">Use Cases</h2>
<li>Ensure configuration elements have required identifiers (name, ID).</li>
<li>Validate security settings (cipher suites, protocols, encrypted="true").</li>
<li>Enforce naming conventions for specific components.</li>
<li>Validate infrastructure settings (hosts, ports, timeouts).</li>
<li>Ensure required metadata or schema references are present.</li>
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_ValidationModes">Validation Modes</h2>
<br>
This rule supports <strong>three distinct modes</strong>:
<br>
1. <strong>Simple Attribute Existence</strong>: Check if attributes exist (any value).
2. <strong>Attribute Value Pairs</strong>: Validate specific attribute values on elements.
3. <strong>Element Attribute Sets</strong>: Validate multiple attributes on the same element instance.
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List<String> </td><td> Glob patterns to match XML files (e.g., <code class='inline-token'>src/**/*.xml</code>) </td></tr></table>
<h3>Mode-Specific Parameters</h3>
<br>
You must configure <strong>at least one</strong> of these modes:
<h4>Mode 1: Simple Attribute Existence</h4>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>elements</code> </td><td> List<String> </td><td> XML element names to check </td></tr><tr><td> <code class='inline-token'>attributes</code> </td><td> List<String> </td><td> Attributes that MUST exist on those elements </td></tr></table>
<h4>Mode 2: Attribute Value Pairs</h4>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>attributeValuePairs</code> </td><td> List<Map> </td><td> List of element-attribute-value triplets </td></tr></table>
<h4>Mode 3: Element Attribute Sets</h4>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>elementAttributeSets</code> </td><td> List<Map> </td><td> List of element configurations with multiple required attributes </td></tr></table>
<h3>Optional Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Case sensitivity for value matching </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Simple Existence</h3>
Check that a "connector" element has both a <code class='inline-token'>name</code> and a <code class='inline-token'>type</code> attribute (any values).
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-ATTR-01"
  name: "Connector Metadata Required"
  checks:
    - type: XML_ATTRIBUTE_EXISTS
      params:
        filePatterns: ["**/config/*.xml"]
        elements: ["connector"]
        attributes: ["name", "type"]
</code></pre>
<h3>Example 2: Attribute Value Validation</h3>
Ensure that any <code class='inline-token'>security-manager</code> element has the <code class='inline-token'>enabled</code> attribute set to <code class='inline-token'>true</code>.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-ATTR-VAL-01"
  name: "Security Manager Integration"
  checks:
    - type: XML_ATTRIBUTE_EXISTS
      params:
        filePatterns: ["src/main/resources/*.xml"]
        attributeValuePairs:
          - element: "security-manager"
            attribute: "enabled"
            expectedValue: "true"
</code></pre>
<h3>Example 3: Multi-Attribute Set (Security)</h3>
Validate that a <code class='inline-token'>connection</code> element uses the correct port AND protocol.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-ATTR-SET-SEC"
  name: "Secure Connection Standard"
  errorMessage: "Insecure connection access point found.\n{DEFAULT_MESSAGE}"
  checks:
    - type: XML_ATTRIBUTE_EXISTS
      params:
        filePatterns: ["**/*.xml"]
        elementAttributeSets:
          - element: "connection"
            attributes:
              protocol: "HTTPS"
              port: "443"
              secure: "true"
</code></pre>
<h3>Example 4: Property Resolution Support</h3>
Allow property placeholders (e.g., <code class='inline-token'>${env.port}</code>) to count as a valid match for a required port.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-ATTR-PROP"
  name: "Resolved Port Configuration"
  checks:
    - type: XML_ATTRIBUTE_EXISTS
      params:
        filePatterns: ["**/*.xml"]
        propertyResolution: true
        attributeValuePairs:
          - element: "server-config"
            attribute: "port"
            expectedValue: "8080"
</code></pre>
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>Element 'connector' missing attribute 'type' in file: config/main.xml
Element 'security-manager' with attribute 'enabled'='true' not found in file: auth.xml
</code></pre>
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_BestPractices">Best Practices</h2>
<li><strong>Use Mode 3 for Dependencies</strong>: If an element's validity depends on multiple attributes (e.g., host + port), use <code class='inline-token'>elementAttributeSets</code> to ensure both are correct on the *same* element instance.</li>
<li><strong>Enable propertyResolution for Environments</strong>: Most enterprise projects use property placeholders; enabling this prevents false negatives for required values.</li>
<li><strong>Path Specificity</strong>: Use <code class='inline-token'>filePatterns</code> to target only the relevant configuration files to improve performance and reduce noise.</li>
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_SolutionPatternsandTechnologyReferences">Solution Patterns and Technology References</h2>
<table><tr><td> Technology </td><td> Best Practice Goal </td><td> Key Elements </td><td> Attributes Checked </td></tr><tr><td> <strong>üêé MuleSoft 4.X</strong> </td><td> Flow Identification </td><td> <code class='inline-token'>flow</code>, <code class='inline-token'>sub-flow</code> </td><td> <code class='inline-token'>name</code>, <code class='inline-token'>doc:id</code> </td></tr><tr><td> <strong>‚ö° TIBCO BW 6.X</strong> </td><td> Process Configuration </td><td> <code class='inline-token'>bpws:process</code> </td><td> <code class='inline-token'>name</code>, <code class='inline-token'>targetNamespace</code> </td></tr><tr><td> <strong>‚ö° TIBCO BW 5.X</strong> </td><td> Activity Naming </td><td> <code class='inline-token'>pd:startType</code> </td><td> <code class='inline-token'>name</code> </td></tr><tr><td> <strong>‚òï Java/Maven</strong> </td><td> Dependency Locking </td><td> <code class='inline-token'>dependency</code> </td><td> <code class='inline-token'>version</code> </td></tr></table>
<h3>üêé MuleSoft 4.X Patterns</h3>
<br>
<pre><code class='language-yaml'>id: "MULE-FLOW-ATTRS"
name: "Mule Flow Identification"
description: "Flows must have name and doc:id attributes"
checks:
  - type: XML_ATTRIBUTE_EXISTS
    params:
      filePatterns: ["src/main/mule/**/*.xml"]
      elements: ["flow", "sub-flow", "error-handler"]
      attributes: ["name", "doc:id"]
</code></pre>
<h3>‚òï Java / Maven Patterns</h3>
<br>
<pre><code class='language-yaml'>id: "JAVA-MAVEN-DEP-VERSION"
name: "Maven Dependency Version Enforced"
description: "Dependencies in this project must explicitly state versions"
checks:
  - type: XML_ATTRIBUTE_EXISTS
    params:
      filePatterns: ["pom.xml"]
      elements: ["dependency"]
      attributes: ["version"]
</code></pre>
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS')">XML_ATTRIBUTE_NOT_EXISTS</a></strong> - Opposite: ensures attributes do NOT exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></strong> - For advanced structure or nested path validation.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED')">XML_ELEMENT_CONTENT_REQUIRED</a></strong> - Validates tag body text instead of attributes.</li>
</div><div id="XML_ATTRIBUTE_NOT_EXISTS" class="rule-content" style="display: none;"><h1>XML_ATTRIBUTE_NOT_EXISTS</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> XML configuration files
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_Overview">Overview</h2>
<br>
Validates that <strong>forbidden XML attributes do NOT exist</strong> on specified elements. This rule <strong>fails</strong> if any of the specified forbidden attributes are found on the target elements. It is commonly used for deprecation cleanup and blocking unsafe configuration flags.
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_UseCases">Use Cases</h2>
<li>Detect and remove deprecated attributes (e.g., legacy tracking flags).</li>
<li>Enforce cleanup of temporary or debug configurations (e.g., <code class='inline-token'>debug="true"</code>).</li>
<li>Prevent usage of insecure or prohibited attribute settings.</li>
<li>Standardize components by blocking non-standard configuration keys.</li>
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List<String> </td><td> Glob patterns to match XML files </td></tr><tr><td> <code class='inline-token'>elements</code> </td><td> List<String> </td><td> List of XML element names to scan </td></tr><tr><td> <code class='inline-token'>forbiddenAttributes</code> </td><td> List<String> </td><td> List of attributes that must NOT be present </td></tr></table>
<h3>Optional Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>matchMode</code> </td><td> String </td><td> <code class='inline-token'>SUBSTRING</code> </td><td> Choose <code class='inline-token'>SUBSTRING</code> or <code class='inline-token'>REGEX</code> </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Case sensitivity for content matching </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Remove Legacy Tracking</h3>
Ensure that no message processing elements contain legacy application tracking attributes.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-ATTR-FORBIDDEN-LEGACY"
  name: "Remove Forbidden Legacy Attributes"
  checks:
    - type: XML_ATTRIBUTE_NOT_EXISTS
      params:
        filePatterns: ["src/**/*.xml"]
        elements:
          - "request-handler"
          - "transform-component"
        forbiddenAttributes:
          - "fromApplicationCode"
          - "toApplicationCode"
          - "legacyFlag"
</code></pre>
<h3>Example 2: Block Debug/Test Modes</h3>
Ensure that configuration elements do not have debug mode enabled in the committed code.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-ATTR-FORBIDDEN-DEBUG"
  name: "No Debug Mode in XML"
  severity: HIGH
  checks:
    - type: XML_ATTRIBUTE_NOT_EXISTS
      params:
        filePatterns: ["src/main/resources/*.xml"]
        elements: ["app-config", "connector-config"]
        forbiddenAttributes: ["debug", "test-mode", "verbose-logging"]
</code></pre>
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>Forbidden attribute 'fromApplicationCode' found on element 'request-handler' in file: src/main/resources/config.xml
Forbidden attribute 'debug' found on element 'connector-config' in file: src/main/resources/connectors.xml
</code></pre>
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_BestPractices">Best Practices</h2>
<li><strong>Layered Cleanup</strong>: Use this rule during platform migrations to systematically identify and remove old configuration keys that are no longer referenced.</li>
<li><strong>Fail on Side-Loads</strong>: Block attributes that might bypass standard security controls (e.g., <code class='inline-token'>bypass-auth</code>, <code class='inline-token'>ignore-ssl</code>).</li>
<li><strong>Combine with XPATH</strong>: For more complex conditions (e.g., "block attribute X only if element has parent Y"), use <strong><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')">XML_XPATH_NOT_EXISTS</a></strong> instead.</li>
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS')">XML_ATTRIBUTE_EXISTS</a></strong> - Opposite: ensures attributes DO exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')">XML_XPATH_NOT_EXISTS</a></strong> - Block complex structures using XPath.</li>
</div><div id="XML_ELEMENT_CONTENT_FORBIDDEN" class="rule-content" style="display: none;"><h1>XML_ELEMENT_CONTENT_FORBIDDEN</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> XML configuration files
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_Overview">Overview</h2>
<br>
Validates that XML elements do <strong>NOT contain forbidden content or tokens</strong>. This rule <strong>fails</strong> if any of the specified forbidden tokens are <strong>found</strong> within the element's text content. It is primarily used to block hardcoded credentials, deprecated values, or insecure configurations.
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_UseCases">Use Cases</h2>
<li>Prevent usage of deprecated values or legacy patterns.</li>
<li>Block hardcoded credentials (passwords, secrets) in element bodies.</li>
<li>Disallow specific configuration values (e.g., insecure protocols, debug levels).</li>
<li>Enforce content restrictions for production-ready code.</li>
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List<String> </td><td> Glob patterns to match XML files </td></tr><tr><td> <code class='inline-token'>elementContentPairs</code> </td><td> List<Map> </td><td> Element names paired with their forbidden content tokens </td></tr></table>
<h4>Element Content Pair Map Structure</h4>
<table><tr><td> Field </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>element</code> </td><td> String </td><td> Yes </td><td> XML element name </td></tr><tr><td> <code class='inline-token'>forbiddenTokens</code> </td><td> List<String> </td><td> Yes </td><td> Tokens that must NOT be present in the element's body </td></tr></table>
<h3>Optional Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>matchMode</code> </td><td> String </td><td> <code class='inline-token'>SUBSTRING</code> </td><td> Choose <code class='inline-token'>SUBSTRING</code> or <code class='inline-token'>REGEX</code> </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Case sensitivity for content matching </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Block Hardcoded Secrets</h3>
Ensure that password or secret-related elements do not contain common default or hardcoded values.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-FORBIDDEN-CREDS"
  name: "No Hardcoded Credentials"
  severity: CRITICAL
  checks:
    - type: XML_ELEMENT_CONTENT_FORBIDDEN
      params:
        filePatterns: ["**/*.xml"]
        elementContentPairs:
          - element: "password"
            forbiddenTokens: ["admin", "password123", "default"]
          - element: "secret-key"
            forbiddenTokens: ["hardcoded", "placeholder"]
</code></pre>
<h3>Example 2: Block Deprecated Log Levels</h3>
Prevent usage of overly verbose or deprecated logging levels in production-bound configurations.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-LOG-POLICY"
  name: "Forbidden Log Levels"
  severity: MEDIUM
  checks:
    - type: XML_ELEMENT_CONTENT_FORBIDDEN
      params:
        filePatterns: ["src/main/resources/**/*.xml"]
        elementContentPairs:
          - element: "logger"
            forbiddenTokens: ["TRACE", "ALL", "DEBUG"]
</code></pre>
<h3>Example 3: Block IP Addresses (Regex)</h3>
Ensure that host configurations use domain names instead of hardcoded IP addresses.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-NO-IP-HOSTS"
  name: "No Hardcoded IPs in Hosts"
  severity: HIGH
  checks:
    - type: XML_ELEMENT_CONTENT_FORBIDDEN
      params:
        filePatterns: ["**/*.xml"]
        matchMode: REGEX
        elementContentPairs:
          - element: "host-config"
            forbiddenTokens: ["\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b"]
</code></pre>
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>config.xml: Element 'password' contains forbidden token: admin
main-flow.xml: Element 'logger' contains forbidden token: TRACE
host-config.xml: Element 'host-config' contains forbidden IP pattern
</code></pre>
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_BestPractices">Best Practices</h2>
<li><strong>Strict Mode for Credentials</strong>: Use <code class='inline-token'>caseSensitive: true</code> (default) when blocking passwords to avoid false positives on legitimate similar strings, but consider <code class='inline-token'>false</code> for logging levels.</li>
<li><strong>REGEX for Complexity</strong>: Use REGEX mode to block entire classes of strings, such as IP addresses or specific ID formats.</li>
<li><strong>Fail Early</strong>: Apply this rule to core configuration files to catch architectural violations before they reach higher environments.</li>
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED')">XML_ELEMENT_CONTENT_REQUIRED</a></strong> - Opposite: ensures tokens ARE present in the content.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')">XML_XPATH_NOT_EXISTS</a></strong> - Block complex structures using XPath.</li>
</div><div id="XML_ELEMENT_CONTENT_REQUIRED" class="rule-content" style="display: none;"><h1>XML_ELEMENT_CONTENT_REQUIRED</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> XML configuration files
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_Overview">Overview</h2>
<br>
Validates that XML elements contain <strong>required content strings or tokens</strong>. This rule <strong>fails</strong> if the required tokens are <strong>NOT found</strong> within the element's text content. It is ideal for enforcing descriptive messages, documentation standards, or specific data formats inside XML tags.
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_UseCases">Use Cases</h2>
<li>Ensure log messages or display names contain descriptive keywords.</li>
<li>Validate documentation or comment tags for specific sections (e.g., "Author", "Version").</li>
<li>Check that configuration values follow a specific format (e.g., semantic versioning).</li>
<li>Enforce organizational content standards in shared XML descriptors.</li>
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List<String> </td><td> Glob patterns to match XML files </td></tr><tr><td> <code class='inline-token'>elementContentPairs</code> </td><td> List<Map> </td><td> Element names paired with their required content tokens </td></tr></table>
<h4>Element Content Pair Map Structure</h4>
<table><tr><td> Field </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>element</code> </td><td> String </td><td> Yes </td><td> XML element name (can be local-name or prefixed) </td></tr><tr><td> <code class='inline-token'>requiredTokens</code> </td><td> List<String> </td><td> Yes </td><td> Tokens that must be present in the element's body </td></tr></table>
<h3>Optional Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Case sensitivity for content matching </td></tr><tr><td> <code class='inline-token'>requireAll</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> If <code class='inline-token'>true</code>, ALL tokens must be found. If <code class='inline-token'>false</code>, at least ONE </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Validate Message Quality</h3>
Ensure that elements used for logging or reporting are descriptive enough.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-CONTENT-REQ-01"
  name: "Descriptive Logger Messages"
  checks:
    - type: XML_ELEMENT_CONTENT_REQUIRED
      params:
        filePatterns: ["**/*.xml"]
        elementContentPairs:
          - element: "logger"
            requiredTokens: ["Flow", "Request", "Response", "Status"]
        requireAll: false  # Pass if at least one of these is mentioned
</code></pre>
<h3>Example 2: Enforce Documentation Standards</h3>
Check that a "description" or "note" tag contains required metadata headers.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-DOC-POLICY"
  name: "Documentation Header Policy"
  checks:
    - type: XML_ELEMENT_CONTENT_REQUIRED
      params:
        filePatterns: ["src/main/resources/*.xml"]
        elementContentPairs:
          - element: "note"
            requiredTokens: ["Author:", "Last-Updated:", "Business-Unit:"]
        requireAll: true  # All headers must be present
</code></pre>
<h3>Example 3: Regex Format Validation</h3>
Verify that a version tag follows a specific semantic versioning pattern.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-VERSION-FORMAT"
  name: "Version Pattern Validation"
  checks:
    - type: XML_ELEMENT_CONTENT_REQUIRED
      params:
        filePatterns: ["pom.xml", "manifest.xml"]
        matchMode: REGEX
        elementContentPairs:
          - element: "version"
            requiredTokens: ["^\\d+\\.\\d+\\.\\d+(-SNAPSHOT)?$"]
</code></pre>
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>config.xml: Element 'logger' is missing required tokens: Flow, Request, Response
manifest.xml: Element 'version' content does not match pattern: ^\d+\.\d+\.\d+(-SNAPSHOT)?$
</code></pre>
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_BestPractices">Best Practices</h2>
<li><strong>Use caseSensitive: false for flexibility</strong>: For documentation or log messages, case sensitivity often leads to false negatives.</li>
<li><strong>REGEX for Strict Formats</strong>: Use REGEX mode when the *order* or *format* matters (e.g., dates, versions, IDs).</li>
<li><strong>Combine with existence</strong>: This rule only checks content *on elements it finds*. If the element is missing entirely, this rule won't trigger. Combine with <strong><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></strong> to ensure the element exists first if needed.</li>
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN')">XML_ELEMENT_CONTENT_FORBIDDEN</a></strong> - Opposite: ensures tokens do NOT exist in the content.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></strong> - Check for existence and hierarchy using XPath.</li>
</div><div id="XML_XPATH_EXISTS" class="rule-content" style="display: none;"><h1>XML_XPATH_EXISTS</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> XML configuration files
<br>
<h2 id="XML_XPATH_EXISTS_Overview">Overview</h2>
<br>
Validates that <strong>required XPath expressions match</strong> in XML files. This rule <strong>fails</strong> if any required XPath expression does <strong>NOT</strong> find matching nodes. It is the core tool for complex XML structure validation.
<br>
<h2 id="XML_XPATH_EXISTS_UseCases">Use Cases</h2>
<li>Verify specific XML elements or attributes exist within a hierarchy.</li>
<li>Ensure required configuration is present in integration flows (MSoft, TIBCO, etc.).</li>
<li>Validate XML structure beyond simple existence (e.g., "Parent must have Child").</li>
<li>Check for mandatory namespaces, schemas, or specific attribute values.</li>
<br>
<h2 id="XML_XPATH_EXISTS_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List<String> </td><td> Glob patterns to match XML files </td></tr><tr><td> <code class='inline-token'>xpathExpressions</code> </td><td> List<Map> </td><td> List of XPath expressions with optional custom failure messages </td></tr><tr><td> <code class='inline-token'>requiredFields</code> </td><td> Map<String, String> </td><td> XPath-Value pairs for exact matching (Optional) </td></tr><tr><td> <code class='inline-token'>minVersions</code> </td><td> Map<String, String> </td><td> XPath-MinVersion pairs for SemVer check (Optional) </td></tr><tr><td> <code class='inline-token'>exactVersions</code> </td><td> Map<String, String> </td><td> XPath-Version pairs for Exact SemVer check (Optional) </td></tr></table>
<h4>XPath Expression Map Structure</h4>
<br>
Each item in <code class='inline-token'>xpathExpressions</code> can have:
<table><tr><td> Field </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>xpath</code> </td><td> String </td><td> Yes </td><td> The XPath expression to evaluate </td></tr><tr><td> <code class='inline-token'>failureMessage</code> </td><td> String </td><td> No </td><td> Custom message if XPath doesn't match </td></tr></table>
<h3>Optional Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${property}</code> placeholder resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="XML_XPATH_EXISTS_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Basic component existence</h3>
Ensure that a specific component (e.g., a "logger" or custom plugin) is used in the configuration.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-XPATH-01"
  name: "Logger Component Required"
  description: "Ensure all flows have at least one logger"
  enabled: true
  severity: MEDIUM
  checks:
    - type: XML_XPATH_EXISTS
      params:
        filePatterns:
          - "**/*.xml"
        xpathExpressions:
          - xpath: "//logger"
            failureMessage: "Configuration must contain at least one logger"
</code></pre>
<h3>Example 2: Check for specific nested configuration</h3>
Validates that a <code class='inline-token'>service</code> element has a defined <code class='inline-token'>endpoint</code> attribute.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-XPATH-02"
  name: "Endpoint Config Required"
  description: "All services must have a defined endpoint"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_EXISTS
      params:
        filePatterns:
          - "**/*-config.xml"
        xpathExpressions:
          - xpath: "//service[@endpoint]"
            failureMessage: "Service element missing required 'endpoint' attribute"
</code></pre>
<h3>Example 3: Namespace-Aware local-name validation</h3>
Safely validate elements regardless of their specific prefix by using <code class='inline-token'>local-name()</code>.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-XPATH-NAMESPACE"
  name: "Listener Configuration Check"
  description: "Ensure specific listener configuration exists"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_EXISTS
      params:
        filePatterns:
          - "**/global-*.xml"
        xpathExpressions:
          - xpath: "//*[local-name()='listener-config']"
            failureMessage: "Missing required listener configuration"
</code></pre>
<br>
<h2 id="XML_XPATH_EXISTS_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>config.xml: Configuration must contain at least one logger (found 0 occurrence(s))
main-flow.xml: Service element missing required 'endpoint' attribute (found 0 occurrence(s))
</code></pre>
<br>
<h2 id="XML_XPATH_EXISTS_BestPractices">Best Practices</h2>
<li><strong>Use local-name() for portability</strong>: When XML files use multiple namespaces/prefixes, <code class='inline-token'>//*[local-name()='elementName']</code> is often more robust than prefix-dependent paths.</li>
<li><strong>Fail Early</strong>: Combine with <code class='inline-token'>FILE_EXISTS</code> or <code class='inline-token'>FILE_PATTERN</code> to ensure you are scanning the correct files.</li>
<li><strong>Granular Paths</strong>: Avoid too many <code class='inline-token'>//</code> (deep descendants) if performance is a concern on massive XML files; use specific paths like <code class='inline-token'>/root/parent/child</code> when possible.</li>
<br>
<h2 id="XML_XPATH_EXISTS_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')">XML_XPATH_NOT_EXISTS</a></strong> - Opposite: ensures nodes do NOT exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS')">XML_ATTRIBUTE_EXISTS</a></strong> - Simpler check for high-level attributes.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED')">XML_ELEMENT_CONTENT_REQUIRED</a></strong> - Validate the text content inside an element.</li>
<br>
<h2 id="XML_XPATH_EXISTS_SolutionPatternsandTechnologyReferences">Solution Patterns and Technology References</h2>
<table><tr><td> Technology </td><td> Best Practice Goal </td><td> Key Elements </td><td> XPath Logic </td></tr><tr><td> <strong>‚ö° TIBCO BW 5</strong> </td><td> Process Validity </td><td> <code class='inline-token'>ProcessDefinition</code> </td><td> Check for start/end activities </td></tr><tr><td> <strong>‚ö° TIBCO BW 6</strong> </td><td> Namespace Binding </td><td> <code class='inline-token'>service</code> </td><td> Namespace-aware paths </td></tr><tr><td> <strong>üêé MuleSoft</strong> </td><td> Build Configuration </td><td> <code class='inline-token'>mule-maven-plugin</code> </td><td> Value-based predicate check </td></tr><tr><td> <strong>üåê Web Svcs</strong> </td><td> WSDL Compliance </td><td> <code class='inline-token'>definitions</code> </td><td> Structure validation </td></tr></table>
<h3>‚ö° TIBCO BW 5.x Patterns</h3>
<br>
<pre><code class='language-yaml'>id: "TIBCO-XPATH-PD"
name: "Valid Process Definition"
description: "Ensure pd:ProcessDefinition has start and end activities"
checks:
  - type: XML_XPATH_EXISTS
    params:
      filePatterns: ["*.process"]
      xpathExpressions:
        - xpath: "//*[local-name()='ProcessDefinition']/*[local-name()='startType']"
        - xpath: "//*[local-name()='ProcessDefinition']/*[local-name()='endType']"
</code></pre>
<h3>üêé MuleSoft / Java Patterns</h3>
<br>
<pre><code class='language-yaml'>id: "MAVEN-MULE-PLUGIN"
name: "Mule Maven Plugin Required"
description: "Ensure correct plugin is present in pom.xml build section"
checks:
  - type: XML_XPATH_EXISTS
    params:
      filePatterns: ["pom.xml"]
      xpathExpressions:
        - xpath: "//*[local-name()='plugin']/*[local-name()='artifactId' and text()='mule-maven-plugin']"
</code></pre>
</div><div id="XML_XPATH_NOT_EXISTS" class="rule-content" style="display: none;"><h1>XML_XPATH_NOT_EXISTS</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> XML configuration files
<br>
<h2 id="XML_XPATH_NOT_EXISTS_Overview">Overview</h2>
<br>
Validates that <strong>forbidden XPath expressions do NOT match</strong> in XML files. This rule <strong>fails</strong> if any forbidden XPath expression <strong>DOES</strong> find matching nodes. It is used to block deprecated components, anti-patterns, or insecure configurations.
<br>
<h2 id="XML_XPATH_NOT_EXISTS_UseCases">Use Cases</h2>
<li>Prevent usage of deprecated XML elements or custom tags.</li>
<li>Block specific insecure configurations (e.g., protocol="HTTP" instead of "HTTPS").</li>
<li>Enforce architectural constraints (e.g., "No direct database calls from the presentation layer").</li>
<li>Disallow anti-patterns or redundant configurations.</li>
<br>
<h2 id="XML_XPATH_NOT_EXISTS_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List<String> </td><td> Glob patterns to match XML files </td></tr><tr><td> <code class='inline-token'>xpathExpressions</code> </td><td> List<Map> </td><td> List of XPath expressions that should NOT match </td></tr></table>
<h4>XPath Expression Map Structure</h4>
<table><tr><td> Field </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>xpath</code> </td><td> String </td><td> Yes </td><td> The XPath expression to evaluate </td></tr><tr><td> <code class='inline-token'>failureMessage</code> </td><td> String </td><td> No </td><td> Custom message if XPath matches (forbidden) </td></tr></table>
<h3>Optional Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${property}</code> placeholder resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="XML_XPATH_NOT_EXISTS_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Block Deprecated Components</h3>
Prevents usage of legacy connectors or custom XML tags that are no longer supported.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-XPATH-FORBIDDEN-01"
  name: "No Legacy Transports"
  description: "Prevent usage of deprecated transport elements"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_NOT_EXISTS
      params:
        filePatterns:
          - "**/*.xml"
        xpathExpressions:
          - xpath: "//*[local-name()='legacy-transport']"
            failureMessage: "Deprecated 'legacy-transport' found - please migrate to the new standard"
</code></pre>
<h3>Example 2: Prevent Hardcoded Environment Values</h3>
Ensures that environment-specific settings (like hostnames) are property-driven and not hardcoded to <code class='inline-token'>localhost</code>.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-XPATH-FORBIDDEN-02"
  name: "No Hardcoded Localhost"
  description: "Prevent hardcoded localhost in service configurations"
  enabled: true
  severity: MEDIUM
  checks:
    - type: XML_XPATH_NOT_EXISTS
      params:
        filePatterns:
          - "src/main/resources/**/*.xml"
        xpathExpressions:
          - xpath: "//service[@host='localhost']"
            failureMessage: "Hardcoded 'localhost' found - use property placeholders"
</code></pre>
<h3>Example 3: Enforce Layered Architecture</h3>
Prevents direct database access from high-level API or presentation layer configurations.
<br>
<pre><code class='language-yaml'>- id: "RULE-XML-XPATH-FORBIDDEN-ARCH"
  name: "Layered Architecture Compliance"
  description: "API layers cannot contain direct database listeners or operations"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_NOT_EXISTS
      params:
        filePatterns:
          - "**/api-*.xml"
        xpathExpressions:
          - xpath: "//db:select | //db:insert | //db:update | //db:delete"
            failureMessage: "Direct database operations forbidden in API layer - use the persistence layer"
</code></pre>
<br>
<h2 id="XML_XPATH_NOT_EXISTS_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>config.xml: Deprecated 'legacy-transport' found - please migrate to the new standard (found 2 occurrence(s))
api-main.xml: Direct database operations forbidden in API layer - use the persistence layer (found 1 occurrence(s))
</code></pre>
<br>
<h2 id="XML_XPATH_NOT_EXISTS_BestPractices">Best Practices</h2>
<li><strong>Use predicates for precise blocking</strong>: Instead of blocking an entire element, use predicates like <code class='inline-token'>//config[@secure='false']</code> to block only the insecure variants.</li>
<li><strong>Fail with clear instructions</strong>: Always provide a <code class='inline-token'>failureMessage</code> that explains the preferred alternative.</li>
<li><strong>Architecture over Code</strong>: Use path-based <code class='inline-token'>filePatterns</code> to enforce different restrictions on different project layers (e.g., <code class='inline-token'>src/web/*.xml</code> vs <code class='inline-token'>src/service/*.xml</code>).</li>
<br>
<h2 id="XML_XPATH_NOT_EXISTS_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></strong> - Opposite: ensures XPath DOES match.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS')">XML_ATTRIBUTE_NOT_EXISTS</a></strong> - Simpler attribute validation.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN')">XML_ELEMENT_CONTENT_FORBIDDEN</a></strong> - Validate forbidden text content inside an element.</li>
</div><div id="CONDITIONAL_CHECK" class="rule-content" style="display: none;"><h1>CONDITIONAL_CHECK</h1>
<br>
<h2 id="CONDITIONAL_CHECK_Overview">Overview</h2>
<br>
The <strong>Universal "If-Then" Engine</strong>. This is the most powerful check type in Aegis. It allows you to create complex, multi-step validation logic by combining any other check type as a trigger (<code class='inline-token'>preconditions</code>) and an action (<code class='inline-token'>onSuccess</code>).
<br>
It is not limited to code analysis! You can combine configuration checks, XML/JSON checks, file existence checks, and project metadata checks in any combination.
<br>
<h2 id="CONDITIONAL_CHECK_UseCases">Use Cases</h2>
<br>
*   <strong>Context-Specific Rules</strong>: "If this is a frontend project (<code class='inline-token'>-ui-</code>), THEN it must have a <code class='inline-token'>LICENSE</code> file."
*   <strong>Cross-File Dependencies</strong>: "If <code class='inline-token'>package.json</code> contains <code class='inline-token'>react</code>, THEN <code class='inline-token'>src/App.tsx</code> must exist."
*   <strong>Technology Standards</strong>: "If an <code class='inline-token'>IBM MQ</code> connector is found (XML), THEN the project must have the corresponding client library dependency (POM)."
*   <strong>Environment Validation</strong>: "If the <code class='inline-token'>env</code> property is set to <code class='inline-token'>PROD</code> (Config), THEN debug logging must be disabled (Log configuration)."
<br>
<h2 id="CONDITIONAL_CHECK_HowItWorks">How It Works</h2>
<br>
This check executes in two phases:
1.  <strong>Preconditions (IF)</strong>: The engine runs these checks first.
    *   If ALL preconditions match (pass), the engine proceeds to step 2.
    *   If ANY precondition fails (doesn't match), the rule is <strong>SKIPPED</strong> (it does not fail, it just implies this rule doesn't apply to this project).
2.  <strong>OnSuccess (THEN)</strong>: The engine runs these checks ONLY if preconditions were met.
    *   If these checks pass, the Rule PASSES.
    *   If any of these checks fail, the Rule FAILS.
<h3>Supported Triggers & Actions</h3>
<strong>ANY</strong> check type can be used in either <code class='inline-token'>preconditions</code> or <code class='inline-token'>onSuccess</code>. Common triggers include:
<br>
*   <strong>Project Identity</strong>: <code class='inline-token'>PROJECT_CONTEXT</code> (Name matching)
*   <strong>File Presence</strong>: <code class='inline-token'>FILE_EXISTS</code> (e.g., specific config files)
*   <strong>XML/JSON Content</strong>: <code class='inline-token'>XML_XPATH_EXISTS</code> or <code class='inline-token'>JSON_VALIDATION_REQUIRED</code>
*   <strong>Properties</strong>: <code class='inline-token'>MANDATORY_PROPERTY_VALUE_CHECK</code> (e.g., environment checks)
*   <strong>Dependencies</strong>: <code class='inline-token'>POM_VALIDATION_REQUIRED</code> (Check for Maven libraries)
<br>
<h2 id="CONDITIONAL_CHECK_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>preconditions</code> </td><td> List<Map> </td><td> A list of standard check definitions that define <strong>WHEN</strong> this rule applies. </td></tr><tr><td> <code class='inline-token'>onSuccess</code> </td><td> List<Map> </td><td> A list of standard check definitions that define <strong>WHAT</strong> must be validated if the preconditions are met. </td></tr></table>
<br>
<h2 id="CONDITIONAL_CHECK_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Frontend Resource Security</h3>
<strong>Scenario</strong>: "If this is a Web UI project (Name) AND it uses a private repository (JSON), THEN it must have a security policy file."
<br>
<pre><code class='language-yaml'>- id: "RULE-COND-FE-01"
  name: "Web UI Security Policy"
  checks:
    - type: CONDITIONAL_CHECK
      params:
        preconditions:
          - type: PROJECT_CONTEXT
            params:
              nameContains: "-ui-"
          - type: JSON_VALIDATION_REQUIRED
            params:
              filePattern: "package.json"
              requiredElements:
                - "publishConfig.registry"
        onSuccess:
          - type: FILE_EXISTS
            params:
              filePatterns: ["SECURITY.md"]
</code></pre>
<h3>Example 2: Unused Dependency Check (POM + XML)</h3>
<strong>Scenario</strong>: "If the Messaging library is in the POM, you MUST actually use it in the XML (prevent bloat)."
<br>
<pre><code class='language-yaml'>- id: "RULE-UNUSED-DEP"
  name: "Messaging Library Usage"
  checks:
    - type: CONDITIONAL_CHECK
      params:
        preconditions:
          - type: POM_VALIDATION_REQUIRED
            params:
              validationType: DEPENDENCIES
              dependencies:
                - artifactId: messaging-client
        onSuccess:
          - type: XML_XPATH_EXISTS
            params:
              filePatterns: ["src/main/resources/*.xml"]
              xpathExpressions:
                - xpath: "//*[local-name()='messaging-config']"
              failureMessage: "Messaging dependency found in POM but no usage found in XML."
</code></pre>
<h3>Example 3: Environment-Specific Enforcement</h3>
Only require production metadata if the <code class='inline-token'>PROD</code> environment is active in the configuration.
<br>
<pre><code class='language-yaml'>- id: "RULE-ENV-PROD"
  name: "Production Metadata Check"
  checks:
    - type: CONDITIONAL_CHECK
      params:
        preconditions:
          - type: MANDATORY_PROPERTY_VALUE_CHECK
            params: { properties: [{ name: "env", values: ["PROD"] }] }
        onSuccess:
          - type: JSON_VALIDATION_REQUIRED
            params:
              filePattern: "metadata.json"
              requiredElements: ["ops_contact", "sla_tier"]
</code></pre>
<br>
<h2 id="CONDITIONAL_CHECK_RelatedCheckTypes">Related Check Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'PROJECT_CONTEXT')">PROJECT_CONTEXT</a></strong>: Trigger based on project metadata.</li>
<li><strong><a href="#" onclick="showRule(event, 'FILE_EXISTS')">FILE_EXISTS</a></strong>: Trigger based on file presence.</li>
<li>Any standard XML, POM, JSON, or Property check.</li>
</div><div id="GENERIC_PROPERTY_FILE_CHECK" class="rule-content" style="display: none;"><h1>GENERIC_PROPERTY_FILE_CHECK</h1>
<br>
<strong>Primary Capacity:</strong> Structural XML Analysis </td><td> <strong>Validation Target:</strong> XML, POM, Config Archive
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_Overview">Overview</h2>
<br>
A versatile engine for validating property-based configuration files across different environments. It allows for complex validation logic including mandatory keys, forbidden values, and pattern-based format enforcement.
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_UseCases">Use Cases</h2>
<li>Enforce standard property naming across microservices.</li>
<li>Ensure all environments have matching configuration keys (prevent "forgot to update PROD").</li>
<li>Block hardcoded secrets or environment-specific triggers in production.</li>
<li>Validate the format of critical configuration values (e.g., ports, timeouts, URLs).</li>
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>fileExtensions</code> </td><td> List </td><td> File extensions to scan (e.g., <code class='inline-token'>.properties</code>, <code class='inline-token'>.yaml</code>) </td></tr><tr><td> <code class='inline-token'>environments</code> </td><td> List </td><td> Environment keys to target (e.g., <code class='inline-token'>DEV</code>, <code class='inline-token'>QA</code>, <code class='inline-token'>PROD</code> or <code class='inline-token'>ALL</code>) </td></tr><tr><td> <code class='inline-token'>validationRules</code> </td><td> List<Map> </td><td> A collection of validation logic blocks </td></tr><tr><td> <code class='inline-token'>requiredFields</code> </td><td> Map<String, String> </td><td> Key-value pairs for exact matching (Optional) </td></tr><tr><td> <code class='inline-token'>minVersions</code> </td><td> Map<String, String> </td><td> Key-MinVersion pairs for SemVer check (Optional) </td></tr><tr><td> <code class='inline-token'>exactVersions</code> </td><td> Map<String, String> </td><td> Key-Version pairs for Exact SemVer check (Optional) </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> Scan files in linked CONFIG project </td></tr></table>
<h3>Validation Rule Map</h3>
<table><tr><td> Field </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>type</code> </td><td> String </td><td> <code class='inline-token'>REQUIRED</code>, <code class='inline-token'>FORBIDDEN</code>, or <code class='inline-token'>FORMAT</code> </td></tr><tr><td> <code class='inline-token'>pattern</code> </td><td> String </td><td> The key or regex pattern to evaluate </td></tr><tr><td> <code class='inline-token'>message</code> </td><td> String </td><td> Custom message to display on failure </td></tr></table>
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Mandatory Boilerplate Properties</h3>
<br>
Ensure that every property file contains the core application identification keys.
<br>
<pre><code class='language-yaml'>- id: "RULE-CONFIG-BOILERPLATE"
  name: "Require App Metadata"
  severity: MEDIUM
  checks:
    - type: GENERIC_PROPERTY_FILE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["ALL"]
        validationRules:
          - type: "REQUIRED"
            pattern: "app.id"
          - type: "REQUIRED"
            pattern: "app.version"
</code></pre>
<h3>Example 2: Type and Format Enforcement</h3>
<br>
Validate that technical configurations like ports and timeouts follow specific numeric or unit-based formats.
<br>
<pre><code class='language-yaml'>- id: "RULE-CONFIG-TECHNICAL"
  name: "Technical Format Validation"
  severity: HIGH
  checks:
    - type: GENERIC_PROPERTY_FILE_CHECK
      params:
        fileExtensions: [".properties", ".yaml"]
        environments: ["DEV", "QA", "PROD"]
        validationRules:
          - type: "FORMAT"
            pattern: "http.port=\\d+"
            message: "Http port must be a numeric integer.\n{DEFAULT_MESSAGE}"
          - type: "FORMAT"
            pattern: "db.timeout=\\d+[ms]"
            message: "Database timeout must include 'ms' unit.\n{DEFAULT_MESSAGE}"
</code></pre>
<h3>Example 3: Version and Field Validation</h3>
Enforce specific versions and exact field values using standard parameters.
<br>
<pre><code class='language-yaml'>- id: "RULE-PROP-STANDARDS"
  name: "Standard Property Validation"
  severity: HIGH
  checks:
    - type: GENERIC_PROPERTY_FILE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["ALL"]
        requiredFields:
          "app.type": "microservice"
          "deploy.mode": "blue-green"
        minVersions:
          "lib.version": "1.2.0"
        exactVersions:
          "fixed.dep": "3.0.1"
</code></pre>
<h3>Example 4: Production Security Guardrails</h3>
Block the usage of insecure protocols or hardcoded local development strings in production.
<br>
<pre><code class='language-yaml'>- id: "RULE-PROD-SECURITY-KEYS"
  name: "Production Access Guard"
  severity: CRITICAL
  errorMessage: "Production security violation found.\n{DEFAULT_MESSAGE}"
  checks:
    - type: GENERIC_PROPERTY_FILE_CHECK
      params:
        fileExtensions: [".properties", ".yaml"]
        environments: ["PROD"]
        validationRules:
          - type: "FORBIDDEN"
            pattern: "auth.mode=local"
            # Overrides the generic error message
            message: "Production must use SSO or external auth.\n{DEFAULT_MESSAGE}"
          - type: "FORBIDDEN"
            pattern: "debug.enabled=true"
</code></pre>
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_ErrorConfigurationCustomization">Error Configuration & Customization</h2>
<br>
You can customize error messages at two levels:
<br>
1.  <strong>Rule Level (Recommended)</strong>: Use <code class='inline-token'>errorMessage</code> at the top level for a consistent message across all failures.
2.  <strong>Check/Rule Level</strong>: Use <code class='inline-token'>message</code> inside <code class='inline-token'>validationRules</code> to provide specific instructions for a single failure type.
<br>
<strong>Both support tokens:</strong>
<li><code class='inline-token'>{DEFAULT_MESSAGE}</code>: Detailed technical reason for the failure.</li>
<li><code class='inline-token'>{CORE_DETAILS}</code>: Alias for default message.</li>
<br>
<pre><code class='language-yaml'>      params:
        property: "api.key"
        mode: EXISTS
        message: "Security violation: Missing mandatory API Key!\n{DEFAULT_MESSAGE}"
</code></pre>
<br>
qa-env.properties: Production must use SSO (found 'auth.mode=local').
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_BestPractices">Best Practices</h2>
<li><strong>Atomic Rules</strong>: Keep <code class='inline-token'>validationRules</code> focused on specific areas (e.g., separate security rules from formatting rules) for cleaner error reporting.</li>
<li><strong>Cross-Environment Consistency</strong>: Use <code class='inline-token'>environments: ["ALL"]</code> to ensure that if a property is added to <code class='inline-token'>DEV</code>, it is also present (even if empty/placeholder) in <code class='inline-token'>PROD</code>.</li>
<li><strong>Regex Boundaries</strong>: Use anchors (<code class='inline-token'>^</code>, <code class='inline-token'>$</code>) in your patterns if you want to match the whole key or value exactly.</li>
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">MANDATORY_PROPERTY_VALUE_CHECK</a></strong> - Deep validation of property values.</li>
<li><strong><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK')">MANDATORY_SUBSTRING_CHECK</a></strong> - Simpler substring checks for config files.</li>
<li><strong><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH')">GENERIC_TOKEN_SEARCH</a></strong> - Advanced text-based search.</li>
</div><div id="MANDATORY_PROPERTY_VALUE_CHECK" class="rule-content" style="display: none;"><h1>MANDATORY_PROPERTY_VALUE_CHECK</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CONFIG</code> </td><td> <strong>Config Engine</strong> </td><td> <code class='inline-token'>.properties</code>
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_Overview">Overview</h2>
<br>
Validates that <strong>required property name-value pairs exist</strong> in environment-specific configuration files. This rule ensures that critical configuration keys are not only present but also set to one of the approved values.
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_UseCases">Use Cases</h2>
<li>Enforce production-grade log levels (e.g., block <code class='inline-token'>DEBUG</code> in <code class='inline-token'>PROD</code>).</li>
<li>Ensure security features like SSL or authentication are explicitly enabled.</li>
<li>Validate environment-specific type tags (e.g., <code class='inline-token'>environment.type=PROD</code>).</li>
<li>Standardize timeout values or retry counts across different services.</li>
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>fileExtensions</code> </td><td> List </td><td> File extensions to check (e.g., <code class='inline-token'>.properties</code>) </td></tr><tr><td> <code class='inline-token'>environments</code> </td><td> List </td><td> Environment names to check (e.g., <code class='inline-token'>PROD</code>, <code class='inline-token'>ALL</code>) </td></tr><tr><td> <code class='inline-token'>properties</code> </td><td> List<Map> </td><td> List of property configurations </td></tr></table>
<h3>Property Configuration Map</h3>
<table><tr><td> Field </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>name</code> </td><td> String </td><td> Exactly matching property key name </td></tr><tr><td> <code class='inline-token'>values</code> </td><td> List </td><td> List of allowed values (OR logic) </td></tr><tr><td> <code class='inline-token'>caseSensitiveName</code> </td><td> Boolean </td><td> Override global name case sensitivity </td></tr><tr><td> <code class='inline-token'>caseSensitiveValue</code> </td><td> Boolean </td><td> Override global value case sensitivity </td></tr></table>
<h3>Optional Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>delimiter</code> </td><td> String </td><td> <code class='inline-token'>=</code> </td><td> The character separating key and value </td></tr><tr><td> <code class='inline-token'>caseSensitiveNames</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Global case sensitivity for property names </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Whether value comparison is case-sensitive </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution before validation </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve values from the linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in the linked CONFIG project </td></tr></table>
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Enforce Production Log Level</h3>
Ensure that logging is set to a sustainable level for production environments.
<br>
<pre><code class='language-yaml'>- id: "RULE-PROD-LOG-LOCK"
  name: "Production Log Level"
  severity: HIGH
  errorMessage: "Production Log Level violation.\n{DEFAULT_MESSAGE}"
  checks:
    - type: MANDATORY_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["PROD"]
        properties:
          - name: "log.level"
            values: ["INFO", "WARN", "ERROR"]
</code></pre>
<h3>Example 2: Infrastructure Compliance</h3>
Verify that SSL is enabled and timeout values are within organizational limits.
<br>
<pre><code class='language-yaml'>- id: "RULE-INFRA-STANDARDS"
  name: "Required Infrastructure Settings"
  severity: HIGH
  checks:
    - type: MANDATORY_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["DEV", "QA", "PROD"]
        properties:
          - name: "ssl.enabled"
            values: ["true"]
          - name: "connect.timeout"
            values: ["30", "60", "120"]
</code></pre>
<h3>Example 3: Flexible Boolean Validation</h3>
Allow various string representations of "true" or "false" in a case-insensitive manner.
<br>
<pre><code class='language-yaml'>- id: "RULE-FLEX-BOOLEAN"
  name: "Boolean Property Validation"
  severity: MEDIUM
  checks:
    - type: MANDATORY_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["ALL"]
        caseSensitiveValues: false
        properties:
          - name: "debug.mode"
            values: ["true", "false", "on", "off", "yes", "no"]
</code></pre>
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>PROD.properties: Property 'log.level' not found in file.
QA.properties: Property 'ssl.enabled' found but value 'false' does not match allowed values [true].
</code></pre>
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_BestPractices">Best Practices</h2>
<li><strong>Explicit Failures</strong>: This rule fails if the property is missing OR if the value is incorrect. Use it when a configuration must be present and correctly set.</li>
<li><strong>Service-Level Consistency</strong>: Apply these rules to ensure all components in a multi-service architecture use consistent timeout or retry logic.</li>
<li><strong>Environment Targeting</strong>: Heavily use the <code class='inline-token'>environments</code> parameter to apply stricter value requirements to <code class='inline-token'>PROD</code> than to <code class='inline-token'>DEV</code>.</li>
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK')">OPTIONAL_PROPERTY_VALUE_CHECK</a></strong> - Logic for properties that might not exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK')">MANDATORY_SUBSTRING_CHECK</a></strong> - Validates substrings within property values.</li>
</div><div id="MANDATORY_SUBSTRING_CHECK" class="rule-content" style="display: none;"><h1>MANDATORY_SUBSTRING_CHECK</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CONFIG</code> </td><td> <strong>Config Engine</strong> </td><td> <code class='inline-token'>.properties</code>, <code class='inline-token'>.yaml</code>
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_Overview">Overview</h2>
<br>
Validates that <strong>required or forbidden substrings exist</strong> in environment-specific configuration files. This rule is optimized for filtering configuration files by their environment name (e.g., <code class='inline-token'>DEV.properties</code>, <code class='inline-token'>PROD.yaml</code>), making it an essential tool for cross-environment compliance.
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_UseCases">Use Cases</h2>
<li>Ensure critical configuration keys (like <code class='inline-token'>api.key</code>) exist in all environment descriptors.</li>
<li>Prevent unsafe settings (e.g., <code class='inline-token'>debug=true</code>) from reaching production configurations.</li>
<li>Enforce mandatory protocol usage (e.g., <code class='inline-token'>https://</code> in callback URLs).</li>
<li>Validate naming conventions or standard placeholders across different build stages.</li>
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_Parameters">Parameters</h2>
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>fileExtensions</code> </td><td> List </td><td> File extensions to scan (e.g., <code class='inline-token'>.properties</code>, <code class='inline-token'>.yaml</code>) </td></tr><tr><td> <code class='inline-token'>tokens</code> </td><td> List </td><td> List of substrings to search for </td></tr><tr><td> <code class='inline-token'>environments</code> </td><td> List </td><td> Environment keys (file basenames) to validate (e.g., <code class='inline-token'>PROD</code>, <code class='inline-token'>ALL</code>) </td></tr></table>
<h3>Optional Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>searchMode</code> </td><td> String </td><td> <code class='inline-token'>REQUIRED</code> </td><td> Choose <code class='inline-token'>REQUIRED</code> or <code class='inline-token'>FORBIDDEN</code> </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Whether substring matching is case-sensitive </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr><tr><td> <code class='inline-token'>message</code> </td><td> String </td><td> (Default) </td><td> Custom message to display on failure </td></tr><tr><td> <code class='inline-token'>message</code> </td><td> String </td><td> (Default) </td><td> Custom message to display on failure </td></tr></table>
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Required Service Discovery Configuration</h3>
Ensure that all environment property files contain the mandatory service ID and client identification.
<br>
<pre><code class='language-yaml'>- id: "RULE-CONFIG-DISCOVERY"
  name: "Required Service Identifiers"
  severity: HIGH
  checks:
    - type: MANDATORY_SUBSTRING_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["DEV", "QA", "PROD"]
        tokens: ["service.id", "service.owner"]
        searchMode: REQUIRED
</code></pre>
<h3>Example 2: Block Insecure Production Flags</h3>
Prevent "debug" or "verbose" flags from being enabled in production configuration files.
<br>
<pre><code class='language-yaml'>- id: "RULE-PROD-NO-DEBUG"
  name: "Disable Debug in Production"
  severity: CRITICAL
  checks:
    - type: MANDATORY_SUBSTRING_CHECK
      params:
        fileExtensions: [".properties", ".yaml"]
        environments: ["PROD"]
        tokens: ["debug=true", "verbose.logging=on"]
        searchMode: FORBIDDEN
</code></pre>
<h3>Example 3: Mandatory Protocol Enforcement</h3>
Ensure that all environments reference security components using standard case-insensitive keywords.
<br>
<pre><code class='language-yaml'>- id: "RULE-SECURE-KEYWORDS"
  name: "Mandatory Security Keywords"
  severity: HIGH
  checks:
    - type: MANDATORY_SUBSTRING_CHECK
      params:
        fileExtensions: [".properties", ".yaml"]
        environments: ["ALL"]
        tokens: ["ssl", "tls", "https"]
        searchMode: REQUIRED
        caseSensitive: false
</code></pre>
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_ErrorConfigurationCustomization">Error Configuration & Customization</h2>
<br>
By default, Aegis generates a technical description of the failure. You can override this by providing a custom <code class='inline-token'>message</code> parameter in your rule configuration.
<br>
<pre><code class='language-yaml'>      params:
        tokens: ["debug=true"]
        searchMode: FORBIDDEN
        message: "Insecure debug flag found! Please disable for production."
</code></pre>
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_BestPractices">Best Practices</h2>
<li><strong>Environment Mapping</strong>: This rule relies on matching the <code class='inline-token'>environments</code> list against the filenames. Ensure your configuration files follow a consistent naming pattern (e.g., <code class='inline-token'>ENV_NAME.properties</code>).</li>
<li><strong>Global Enforcement</strong>: Use <code class='inline-token'>environments: ["ALL"]</code> to apply a rule across every discovered environment file automatically.</li>
<li><strong>Substrings vs. Full Values</strong>: Remember that this rule checks for *substrings*. If you need to validate that a property precisely equals a value, use <strong><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">MANDATORY_PROPERTY_VALUE_CHECK</a></strong>.</li>
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH')">GENERIC_TOKEN_SEARCH</a></strong> - Similar logic but without environment-specific file filtering.</li>
<li><strong><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">MANDATORY_PROPERTY_VALUE_CHECK</a></strong> - Validates exact key-value pairs.</li>
</div><div id="OPTIONAL_PROPERTY_VALUE_CHECK" class="rule-content" style="display: none;"><h1>OPTIONAL_PROPERTY_VALUE_CHECK</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CONFIG</code> </td><td> <strong>Config Engine</strong> </td><td> <code class='inline-token'>.properties</code>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_Overview">Overview</h2>
<br>
Validates <strong>optional property values</strong> in configuration files. This rule is designed for settings that are not required for the application to run, but if they are present, they must adhere to specific value constraints.
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_UseCases">Use Cases</h2>
<li>Validate experimental or feature flags when enabled (e.g., <code class='inline-token'>feature.x=true/false</code>).</li>
<li>Restrict cache provider types if the user chooses to configure caching.</li>
<li>Enforce allowed TTL (Time-To-Live) values for non-mandatory session management.</li>
<li>Validate optional monitoring levels or diagnostic flags.</li>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_Parameters">Parameters</h2>
<br>
Same as <strong><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">MANDATORY_PROPERTY_VALUE_CHECK</a></strong>, but with different validation logic.
<h3>Required Parameters</h3>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>fileExtensions</code> </td><td> List </td><td> File extensions to check (e.g., <code class='inline-token'>.properties</code>) </td></tr><tr><td> <code class='inline-token'>environments</code> </td><td> List </td><td> Environment names to check (e.g., <code class='inline-token'>ALL</code>, <code class='inline-token'>PROD</code>) </td></tr><tr><td> <code class='inline-token'>properties</code> </td><td> List </td><td> List of optional property configurations </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_ConfigurationExamples">Configuration Examples</h2>
<h3>Example 1: Optional Feature Flags</h3>
<br>
Ensure that if a feature toggle is present, it uses valid boolean string values.
<br>
<pre><code class='language-yaml'>- id: "RULE-OPTIONAL-TOGGLE"
  name: "Validate Optional Toggles"
  severity: MEDIUM
  errorMessage: "Optional toggle validation failed.\n{DEFAULT_MESSAGE}"
  checks:
    - type: OPTIONAL_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["ALL"]
        properties:
          - name: "feature.beta.enabled"
            values: ["true", "false"]
</code></pre>
<h3>Example 2: Optional Cache Tuning</h3>
<br>
Restrict choices for cache providers and durations when developers choose to override defaults.
<br>
<pre><code class='language-yaml'>- id: "RULE-OPTIONAL-CACHE"
  name: "Optional Cache Settings"
  severity: LOW
  checks:
    - type: OPTIONAL_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["DEV", "QA", "PROD"]
        properties:
          - name: "cache.provider"
            values: ["memory", "redis", "in-memory"]
          - name: "cache.timeout"
            values: ["300", "600", "3600"]
</code></pre>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_ValidationLogic">Validation Logic</h2>
<li><strong>‚úÖ PASS</strong>: Property is NOT found in the configuration file (since it is optional).</li>
<li><strong>‚úÖ PASS</strong>: Property is found and its value matches one of the allowed <code class='inline-token'>values</code>.</li>
<li><strong>‚ùå FAIL</strong>: Property is found but its value is NOT in the allowed list.</li>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>dev.properties: Optional property 'cache.provider' found but value 'custom-val' does not match allowed choices [memory, redis, in-memory].
</code></pre>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_BestPractices">Best Practices</h2>
<li><strong>Use for "Nice to Have" Rules</strong>: This is ideal for validating developer-facing flags or performance tuning parameters where a default exists in code if the property is missing.</li>
<li><strong>Environment Variance</strong>: Even for optional properties, you can restrict <code class='inline-token'>PROD</code> to a subset of <code class='inline-token'>DEV</code> values (e.g., only allowing certain cache providers in a production cloud environment).</li>
<li><strong>Documentation</strong>: Use the <code class='inline-token'>values</code> list to document allowed types for other team members.</li>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_RelatedRuleTypes">Related Rule Types</h2>
<li><strong><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">MANDATORY_PROPERTY_VALUE_CHECK</a></strong> - For properties that MUST be present.</li>
<li><strong><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK')">MANDATORY_SUBSTRING_CHECK</a></strong> - For validating parts of property values.</li>
</div>
        </div>
    </div>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                var path = window.location.pathname;
                var isReport = path.includes('/reports/');
                var isStandalone = path.endsWith('/rule_guide.html');
                var dashboardBtn = document.getElementById('dashboardBtn');
                var mainPageBtn = document.getElementById('mainPageBtn');

                var isInMuleWrapper = path.includes('/apiguard/');
                var basePath = isInMuleWrapper ? '/apiguard/aegis' : '';

                var sessionId = new URLSearchParams(window.location.search).get('session');
                if (!sessionId && isReport) {
                    var parts = path.split('/reports/');
                    if (parts.length > 1) {
                        var subparts = parts[1].split('/');
                        if (subparts.length > 0) sessionId = subparts[0];
                    }
                }

                if (dashboardBtn) {
                    if (isStandalone) {
                        dashboardBtn.innerText = "Home";
                        dashboardBtn.href = basePath + "/";
                        dashboardBtn.title = "Go to Main Page";
                        dashboardBtn.style.display = 'inline-block';
                        if (mainPageBtn) mainPageBtn.style.display = 'none';
                    } else {
                        dashboardBtn.style.display = 'inline-block';
                    }
                }

                if (isReport && mainPageBtn) {
                    mainPageBtn.style.display = 'inline-block';
                    var mainPageUrl = basePath + '/';
                    if (!isInMuleWrapper) mainPageUrl = '/';
                    if (sessionId) mainPageUrl += '?session=' + sessionId;
                    mainPageBtn.href = mainPageUrl;
                }
            });
        </script>
</body>
</html>
