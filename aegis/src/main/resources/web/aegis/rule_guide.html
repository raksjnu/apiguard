<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Aegis - Standard Rule Guide</title>
    <style>
        :root {
            --raks-purple: #663399;
            --raks-purple-light: #7d4fb2;
            --text-white: #FFFFFF;
            --sidebar-width: 300px;
        }
        html { height: 100%; margin: 0; padding: 0; }
        body { font-family: Arial, sans-serif; margin: 0; background-color: #f0f0f0; display: flex; height: 100%; overflow: hidden; width: 100%; }
        .sidebar {
            width: var(--sidebar-width);
            background: white;
            border-right: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
            min-width: 200px;
            max-width: 600px;
            flex-shrink: 0;
        }
        .sidebar-header {
            padding: 20px;
            background: var(--raks-purple);
            color: white;
        }
        .sidebar-header h2 { margin: 0; font-size: 1.2rem; color: white; }
        .sidebar-nav { list-style-type: none; padding: 0; overflow-y: auto; flex-grow: 1; }
        .sidebar-nav li { border-bottom: 1px solid #eee; }
        .sidebar-nav a { display: block; color: #333; padding: 15px 20px; text-decoration: none; font-size: 14px; display: flex; justify-content: space-between; align-items: center; }
        .sidebar-nav a:hover { background-color: #f5f5f5; color: #000; }
        .sidebar-nav a.active { background-color: var(--raks-purple); color: white; border-left: 4px solid #7d4fb2; }

        .rule-header { display: flex; align-items: center; width: 100%; cursor: pointer; }
        .rule-header:hover { background-color: #f5f5f5; }
        .rule-header a { flex-grow: 1; padding: 15px 10px; border: none; }
        .toggle-icon { padding: 15px 10px; color: #666; cursor: pointer; font-size: 10px; width: 20px; text-align: center; }
        .toggle-icon:hover { color: #000; }
        .sub-nav { list-style-type: none; padding: 0; display: none; background-color: #f9f9f9; border-top: 1px solid #eee; }
        .sub-nav.expanded { display: block; }
        .sub-nav li { border-bottom: 1px solid #eee; }
        .sub-nav a { padding: 8px 10px 8px 45px; font-size: 13px; color: #555; }
        .sub-nav a:hover { color: #000; background-color: #eee; }
        .sub-nav a.active { background-color: var(--raks-purple); color: white; font-weight: bold; }

        .main-content { flex: 1; padding: 40px; overflow-y: auto; background-color: white; position: relative; }
        .report-container {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 1400px;
            margin: 0 auto;
            border: 5px solid var(--raks-purple);
            position: relative;
        }
        .top-nav-container {
            position: absolute;
            top: 20px;
            right: 40px;
            display: flex;
            gap: 10px;
            z-index: 100;
        }
        .top-nav-button {
            background-color: var(--raks-purple);
            color: var(--text-white);
            border: none;
            padding: 8px 16px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .top-nav-button:hover { background-color: var(--raks-purple-light); }
        h1 { color: var(--raks-purple) !important; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 0; }
        h2 { color: var(--raks-purple) !important; margin-top: 30px; }
        h3 { color: var(--raks-purple-light) !important; }
        h4 { color: var(--raks-purple-light) !important; font-size: 1.1em; margin-top: 20px; }
        .rule-content { color: #333 !important; line-height: 1.6; }
        pre { background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto; border: 1px solid #ddd; }
        code { font-family: Consolas, monospace; color: #0078d4 !important; }
        code.inline-token { color: #0078d4 !important; font-weight: bold; }
        pre code { color: #333 !important; } /* Code blocks should be black text */
        table { border-collapse: collapse; width: 100%; margin: 20px 0; color: #333 !important; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: #f1f1f1; color: #333 !important; }
        blockquote { border-left: 4px solid var(--raks-purple); margin: 0; padding-left: 20px; color: #555; }
        .search-highlight { background-color: #ffeb3b; color: black; font-weight: bold; border-radius: 2px; }
        ::highlight(search-results) { background-color: #ffeb3b; color: black; }
        .match-count { background: #663399; color: white; border-radius: 10px; padding: 2px 8px; font-size: 0.8em; margin-left: 10px; font-weight: bold; white-space: nowrap; }
        .resizer {
            width: 5px;
            background-color: #ddd;
            cursor: col-resize;
            transition: background-color 0.2s;
            z-index: 10;
        }
        .resizer:hover, .resizer.resizing {
            background-color: var(--raks-purple);
        }
    </style>
    <script>
        var currentFilter = "";
        var searchTimeout = null;
        var searchIndex = []; // { id: ruleId, content: upperCaseText }

        function buildIndex() {
            var rules = document.querySelectorAll('.rule-content');
            rules.forEach(function(el) {
                var id = el.id;
                var text = (el.textContent || el.innerText).toUpperCase();

                searchIndex.push({ id: id, content: text });
            });
            console.log("Search index built: " + searchIndex.length + " items.");
        }

        function showRule(event, ruleId, sectionId) {
            if (event) event.preventDefault();
            document.querySelectorAll('.rule-content').forEach(el => el.style.display = 'none');
            var contentDiv = document.getElementById(ruleId);
            if (contentDiv) {
                contentDiv.style.display = 'block';

                expandRuleTree(ruleId);

                if (sectionId) {
                    var section = document.getElementById(sectionId);
                    if (section) section.scrollIntoView({block: 'start'});
                } else {

                    document.querySelector('.main-content').scrollTop = 0;
                }

                setTimeout(function(){
                    applyHighlight(contentDiv, currentFilter, false);
                }, 0);
            }

            document.querySelectorAll('.sidebar-nav a').forEach(el => {
                el.classList.remove('active');
                var onclick = el.getAttribute('onclick');

                if (onclick && onclick.includes("'" + ruleId + "'")) {

                    if (!sectionId || (sectionId && onclick.includes("'" + sectionId + "'"))) {
                         el.classList.add('active');
                    }
                }
            });
        }

        function toggleSubNav(event, ruleId) {
            if(event) event.stopPropagation();
            var subNav = document.getElementById('sub-' + ruleId);
            var icon = event.target;
            if (subNav) {
                if (subNav.classList.contains('expanded')) {
                    subNav.classList.remove('expanded');
                    icon.innerHTML = '&#9654;'; // Right Arrow
                } else {
                    subNav.classList.add('expanded');
                    icon.innerHTML = '&#9660;'; // Down Arrow
                }
            }
        }

        function expandRuleTree(ruleId) {
            var subNav = document.getElementById('sub-' + ruleId);
            if (subNav && !subNav.classList.contains('expanded')) {
                subNav.classList.add('expanded');

                var header = subNav.previousElementSibling;
                if (header) {
                    var icon = header.querySelector('.toggle-icon');
                    if (icon) icon.innerHTML = '&#9660;';
                }
            }
        }

        function escapeRegExp(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        function applyHighlight(container, term, shouldScroll) {
            if (!container) return;

            if (window.CSS && CSS.highlights) {
                CSS.highlights.clear();
            }

            if (!term || term.length < 2) return;

            var ranges = [];
            var termUpper = term.toUpperCase();
            var walker = document.createTreeWalker(container, NodeFilter.SHOW_TEXT, null, false);
            var node;
            var matchCount = 0;
            var maxMatches = 100;

            while (node = walker.nextNode()) {
                if (matchCount >= maxMatches) break;
                var text = node.nodeValue;
                var valUpper = text.toUpperCase();
                var idx = valUpper.indexOf(termUpper);

                while (idx >= 0 && matchCount < maxMatches) {
                    var range = new Range();
                    range.setStart(node, idx);
                    range.setEnd(node, idx + term.length);
                    ranges.push(range);
                    matchCount++;
                    idx = valUpper.indexOf(termUpper, idx + term.length);
                }
            }

            if (window.CSS && CSS.highlights) {
                var highlight = new Highlight(...ranges);
                CSS.highlights.set("search-results", highlight);
            }

            if (shouldScroll && ranges.length > 0) {
                var firstRange = ranges[0];
                if (firstRange) {
                    var startNode = firstRange.startContainer;
                    var element = startNode.nodeType === 3 ? startNode.parentElement : startNode;
                    if (element) {
                        element.scrollIntoView({block: "center"});
                    }
                }
            }
        }

        function onSearchInput() {
            if (searchTimeout) clearTimeout(searchTimeout);

            searchTimeout = setTimeout(filterSidebar, 300);
        }

        function filterSidebar() {
            var input = document.getElementById("filterInput");
            currentFilter = input.value.trim().toUpperCase();

            var matchedIds = new Set();
            var matchesMap = {}; // id -> count

            if (currentFilter.length < 2) {

                var lis = document.getElementById("sidebarNav").getElementsByTagName("li");
                for (var i = 0; i < lis.length; i++) {
                    lis[i].style.display = "";
                    var a = lis[i].getElementsByTagName("a")[0];
                    var oldBadge = a.querySelector('.match-count');
                    if (oldBadge) oldBadge.remove();
                }
                return;
            }

            for (var i = 0; i < searchIndex.length; i++) {
                var item = searchIndex[i];
                var count = 0;

                if (item.id.toUpperCase().indexOf(currentFilter) > -1) {
                    count++;
                }

                var pos = item.content.indexOf(currentFilter);
                while (pos !== -1 && count < 101) {
                    count++;
                    pos = item.content.indexOf(currentFilter, pos + currentFilter.length);
                }

                if (count > 0) {
                    matchedIds.add(item.id);
                    matchesMap[item.id] = count;
                }
            }

            var ul = document.getElementById("sidebarNav");
            var lis = ul.getElementsByTagName("li");

            requestAnimationFrame(() => {
                for (var i = 0; i < lis.length; i++) {
                    var a = lis[i].getElementsByTagName("a")[0];

                    // Use data-rule-id for robustness
                    var ruleId = a.getAttribute("data-rule-id");
                    if (!ruleId) continue;

                    var oldBadge = a.querySelector('.match-count');
                    if (oldBadge) oldBadge.remove();

                    if (matchedIds.has(ruleId) || currentFilter === "") {
                        lis[i].style.display = "";
                        var count = matchesMap[ruleId] || 0;
                        if (count > 0) {
                            var badge = document.createElement("span");
                            badge.className = "match-count";
                            badge.innerText = count > 100 ? "100+" : count;
                            a.appendChild(badge);
                        }
                    } else {
                        lis[i].style.display = "none";
                    }
                }

                var visible = document.querySelector('.rule-content[style*="block"]');
                if (visible) {
                    applyHighlight(visible, currentFilter, false);
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function() {

            setTimeout(buildIndex, 100);

            var hash = window.location.hash;
            if (hash && hash.length > 1) {
                var ruleId = hash.substring(1); // Remove #

                if (document.getElementById(ruleId)) {
                    showRule(null, ruleId);
                }
            }

            const sidebar = document.getElementById('sidebar');
            const resizer = document.getElementById('resizer');
            if (!sidebar || !resizer) return;
            let isResizing = false;

            resizer.addEventListener('mousedown', function(e) {
                e.preventDefault(); // Critical: Prevents text selection during drag
                isResizing = true;
                resizer.classList.add('resizing');
                document.body.style.cursor = 'col-resize';
            });

            document.addEventListener('mousemove', function(e) {
                if (!isResizing) return;
                const newWidth = e.clientX;
                if (newWidth > 200 && newWidth < 800) {
                    sidebar.style.width = newWidth + 'px';
                }
            });

            document.addEventListener('mouseup', function(e) {
                if (isResizing) {
                    isResizing = false;
                    resizer.classList.remove('resizing');
                    document.body.style.cursor = '';
                }
            });
        });
    </script>
</head>
<body>
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                <div style="background: white; padding: 10px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <img src="logo.svg" alt="Aegis" style="height: 35px; display: block;">
                </div>
                <h1 style="margin: 0; font-size: 2rem; color: white !important; font-weight: bold; letter-spacing: 2px; border-bottom: none !important; padding-bottom: 0 !important;">AEGIS</h1>
            </div>
            <h2>Aegis Rules</h2>
            <input type="text" id="filterInput" onkeyup="onSearchInput()" placeholder="Search rules..."
                   style="width: 100%; padding: 8px; margin-top: 10px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px;">
        </div>
        <ul class="sidebar-nav" id="sidebarNav">
            <li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'QUICK_REFERENCE')">&#9654;</span><a href="#" onclick="showRule(event, 'QUICK_REFERENCE')" data-rule-id="QUICK_REFERENCE">QUICK_REFERENCE</a></div><ul class="sub-nav" id="sub-QUICK_REFERENCE"><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_1GlobalParameters')">1. Global Parameters</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_2ProjectTypeFiltering')">2. Project Type Filtering</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_3LogicPatternsPositivevsNegative')">3. Logic Patterns (Positive vs. Negative)</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_2MessageTokens')">2. Message Tokens</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_LogicalOperatorslogic')">Logical Operators (`logic`)</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_2RuleSpecificParameters')">2. Rule-Specific Parameters</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_ValidationOperatorsComparisonMatrix')">Validation Operators & Comparison Matrix</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_PropertyResolutionGuideFlagshipFeature')">Property Resolution Guide (Flagship Feature)</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_TechnologySpecificGuides')">Technology-Specific Guides</a></li><li><a href="#" onclick="showRule(event, 'QUICK_REFERENCE', 'QUICK_REFERENCE_Troubleshooting')">Troubleshooting</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'GLOBAL_CONFIGURATION')">&#9654;</span><a href="#" onclick="showRule(event, 'GLOBAL_CONFIGURATION')" data-rule-id="GLOBAL_CONFIGURATION">GLOBAL_CONFIGURATION</a></div><ul class="sub-nav" id="sub-GLOBAL_CONFIGURATION"><li><a href="#" onclick="showRule(event, 'GLOBAL_CONFIGURATION', 'GLOBAL_CONFIGURATION_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'GLOBAL_CONFIGURATION', 'GLOBAL_CONFIGURATION_MatchModes')">Match Modes</a></li><li><a href="#" onclick="showRule(event, 'GLOBAL_CONFIGURATION', 'GLOBAL_CONFIGURATION_LogicOperators')">Logic Operators</a></li><li><a href="#" onclick="showRule(event, 'GLOBAL_CONFIGURATION', 'GLOBAL_CONFIGURATION_ScopeControl')">Scope Control</a></li><li><a href="#" onclick="showRule(event, 'GLOBAL_CONFIGURATION', 'GLOBAL_CONFIGURATION_PropertyResolution')">Property Resolution</a></li><li><a href="#" onclick="showRule(event, 'GLOBAL_CONFIGURATION', 'GLOBAL_CONFIGURATION_2CrossProjectResolutionFlags')">2. Cross-Project Resolution Flags</a></li><li><a href="#" onclick="showRule(event, 'GLOBAL_CONFIGURATION', 'GLOBAL_CONFIGURATION_BestPracticesGuidance')">Best Practices & Guidance</a></li><li><a href="#" onclick="showRule(event, 'GLOBAL_CONFIGURATION', 'GLOBAL_CONFIGURATION_MessageCustomization')">Message Customization</a></li><li><a href="#" onclick="showRule(event, 'GLOBAL_CONFIGURATION', 'GLOBAL_CONFIGURATION_ProjectIdentification')">Project Identification</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'PROJECT_IDENTIFICATION')">&#9654;</span><a href="#" onclick="showRule(event, 'PROJECT_IDENTIFICATION')" data-rule-id="PROJECT_IDENTIFICATION">PROJECT_IDENTIFICATION</a></div><ul class="sub-nav" id="sub-PROJECT_IDENTIFICATION"><li><a href="#" onclick="showRule(event, 'PROJECT_IDENTIFICATION', 'PROJECT_IDENTIFICATION_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'PROJECT_IDENTIFICATION', 'PROJECT_IDENTIFICATION_Configuration')">Configuration</a></li><li><a href="#" onclick="showRule(event, 'PROJECT_IDENTIFICATION', 'PROJECT_IDENTIFICATION_ManagingMultipleTechnologies')">Managing Multiple Technologies</a></li><li><a href="#" onclick="showRule(event, 'PROJECT_IDENTIFICATION', 'PROJECT_IDENTIFICATION_BestPractices')">Best Practices</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'CROSS_PROJECT_RESOLUTION')">&#9654;</span><a href="#" onclick="showRule(event, 'CROSS_PROJECT_RESOLUTION')" data-rule-id="CROSS_PROJECT_RESOLUTION">CROSS_PROJECT_RESOLUTION</a></div><ul class="sub-nav" id="sub-CROSS_PROJECT_RESOLUTION"><li><a href="#" onclick="showRule(event, 'CROSS_PROJECT_RESOLUTION', 'CROSS_PROJECT_RESOLUTION_KeyParameters')">Key Parameters</a></li><li><a href="#" onclick="showRule(event, 'CROSS_PROJECT_RESOLUTION', 'CROSS_PROJECT_RESOLUTION_HowitWorks')">How it Works</a></li><li><a href="#" onclick="showRule(event, 'CROSS_PROJECT_RESOLUTION', 'CROSS_PROJECT_RESOLUTION_Examples')">Examples</a></li><li><a href="#" onclick="showRule(event, 'CROSS_PROJECT_RESOLUTION', 'CROSS_PROJECT_RESOLUTION_ReportVisualization')">Report Visualization</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'FILE_EXISTS')">&#9654;</span><a href="#" onclick="showRule(event, 'FILE_EXISTS')" data-rule-id="FILE_EXISTS">FILE_EXISTS</a></div><ul class="sub-nav" id="sub-FILE_EXISTS"><li><a href="#" onclick="showRule(event, 'FILE_EXISTS', 'FILE_EXISTS_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'FILE_EXISTS', 'FILE_EXISTS_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'FILE_EXISTS', 'FILE_EXISTS_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'FILE_EXISTS', 'FILE_EXISTS_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'FILE_EXISTS', 'FILE_EXISTS_RelatedCheckTypes')">Related Check Types</a></li><li><a href="#" onclick="showRule(event, 'FILE_EXISTS', 'FILE_EXISTS_SolutionPatternsandTechnologyReferences')">Solution Patterns and Technology References</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'GENERIC_TOKEN_SEARCH')">&#9654;</span><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH')" data-rule-id="GENERIC_TOKEN_SEARCH">GENERIC_TOKEN_SEARCH</a></div><ul class="sub-nav" id="sub-GENERIC_TOKEN_SEARCH"><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_ErrorConfigurationCustomization')">Error Configuration & Customization</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_RelatedRuleTypes')">Related Rule Types</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH', 'GENERIC_TOKEN_SEARCH_SolutionPatternsandTechnologyReference')">Solution Patterns and Technology Reference</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN')">&#9654;</span><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN')" data-rule-id="GENERIC_TOKEN_SEARCH_FORBIDDEN">GENERIC_TOKEN_SEARCH_FORBIDDEN</a></div><ul class="sub-nav" id="sub-GENERIC_TOKEN_SEARCH_FORBIDDEN"><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_RelatedRuleTypes')">Related Rule Types</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN', 'GENERIC_TOKEN_SEARCH_FORBIDDEN_SolutionPatternsandTechnologyReference')">Solution Patterns and Technology Reference</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'GENERIC_TOKEN_SEARCH_REQUIRED')">&#9654;</span><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED')" data-rule-id="GENERIC_TOKEN_SEARCH_REQUIRED">GENERIC_TOKEN_SEARCH_REQUIRED</a></div><ul class="sub-nav" id="sub-GENERIC_TOKEN_SEARCH_REQUIRED"><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_RelatedRuleTypes')">Related Rule Types</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED', 'GENERIC_TOKEN_SEARCH_REQUIRED_SolutionPatternsandTechnologyReference')">Solution Patterns and Technology Reference</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'JSON_VALIDATION_FORBIDDEN')">&#9654;</span><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN')" data-rule-id="JSON_VALIDATION_FORBIDDEN">JSON_VALIDATION_FORBIDDEN</a></div><ul class="sub-nav" id="sub-JSON_VALIDATION_FORBIDDEN"><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN', 'JSON_VALIDATION_FORBIDDEN_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN', 'JSON_VALIDATION_FORBIDDEN_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN', 'JSON_VALIDATION_FORBIDDEN_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN', 'JSON_VALIDATION_FORBIDDEN_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN', 'JSON_VALIDATION_FORBIDDEN_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN', 'JSON_VALIDATION_FORBIDDEN_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'JSON_VALIDATION_REQUIRED')">&#9654;</span><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED')" data-rule-id="JSON_VALIDATION_REQUIRED">JSON_VALIDATION_REQUIRED</a></div><ul class="sub-nav" id="sub-JSON_VALIDATION_REQUIRED"><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED', 'JSON_VALIDATION_REQUIRED_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'POM_VALIDATION_FORBIDDEN')">&#9654;</span><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN')" data-rule-id="POM_VALIDATION_FORBIDDEN">POM_VALIDATION_FORBIDDEN</a></div><ul class="sub-nav" id="sub-POM_VALIDATION_FORBIDDEN"><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_SolutionPatternsandTechnologyReferences')">Solution Patterns and Technology References</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN', 'POM_VALIDATION_FORBIDDEN_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'POM_VALIDATION_REQUIRED')">&#9654;</span><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED')" data-rule-id="POM_VALIDATION_REQUIRED">POM_VALIDATION_REQUIRED</a></div><ul class="sub-nav" id="sub-POM_VALIDATION_REQUIRED"><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_EnhancedReportingNEW')">Enhanced Reporting (NEW)</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_VersionComparisonLogicNEW')">Version Comparison Logic (NEW)</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_SolutionPatternsandTechnologyReferences')">Solution Patterns and Technology References</a></li><li><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED', 'POM_VALIDATION_REQUIRED_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'PROJECT_CONTEXT')">&#9654;</span><a href="#" onclick="showRule(event, 'PROJECT_CONTEXT')" data-rule-id="PROJECT_CONTEXT">PROJECT_CONTEXT</a></div><ul class="sub-nav" id="sub-PROJECT_CONTEXT"><li><a href="#" onclick="showRule(event, 'PROJECT_CONTEXT', 'PROJECT_CONTEXT_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'PROJECT_CONTEXT', 'PROJECT_CONTEXT_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'PROJECT_CONTEXT', 'PROJECT_CONTEXT_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'PROJECT_CONTEXT', 'PROJECT_CONTEXT_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'PROJECT_CONTEXT', 'PROJECT_CONTEXT_RelatedCheckTypes')">Related Check Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'XML_ATTRIBUTE_EXISTS')">&#9654;</span><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS')" data-rule-id="XML_ATTRIBUTE_EXISTS">XML_ATTRIBUTE_EXISTS</a></div><ul class="sub-nav" id="sub-XML_ATTRIBUTE_EXISTS"><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_ValidationModes')">Validation Modes</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_SolutionPatternsandTechnologyReferences')">Solution Patterns and Technology References</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS', 'XML_ATTRIBUTE_EXISTS_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'XML_ATTRIBUTE_NOT_EXISTS')">&#9654;</span><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS')" data-rule-id="XML_ATTRIBUTE_NOT_EXISTS">XML_ATTRIBUTE_NOT_EXISTS</a></div><ul class="sub-nav" id="sub-XML_ATTRIBUTE_NOT_EXISTS"><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS', 'XML_ATTRIBUTE_NOT_EXISTS_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'XML_ELEMENT_CONTENT_FORBIDDEN')">&#9654;</span><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN')" data-rule-id="XML_ELEMENT_CONTENT_FORBIDDEN">XML_ELEMENT_CONTENT_FORBIDDEN</a></div><ul class="sub-nav" id="sub-XML_ELEMENT_CONTENT_FORBIDDEN"><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN', 'XML_ELEMENT_CONTENT_FORBIDDEN_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'XML_ELEMENT_CONTENT_REQUIRED')">&#9654;</span><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED')" data-rule-id="XML_ELEMENT_CONTENT_REQUIRED">XML_ELEMENT_CONTENT_REQUIRED</a></div><ul class="sub-nav" id="sub-XML_ELEMENT_CONTENT_REQUIRED"><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED', 'XML_ELEMENT_CONTENT_REQUIRED_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'XML_XPATH_EXISTS')">&#9654;</span><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')" data-rule-id="XML_XPATH_EXISTS">XML_XPATH_EXISTS</a></div><ul class="sub-nav" id="sub-XML_XPATH_EXISTS"><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_RelatedRuleTypes')">Related Rule Types</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS', 'XML_XPATH_EXISTS_SolutionPatternsandTechnologyReferences')">Solution Patterns and Technology References</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'XML_XPATH_NOT_EXISTS')">&#9654;</span><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')" data-rule-id="XML_XPATH_NOT_EXISTS">XML_XPATH_NOT_EXISTS</a></div><ul class="sub-nav" id="sub-XML_XPATH_NOT_EXISTS"><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS', 'XML_XPATH_NOT_EXISTS_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'CONDITIONAL_CHECK')">&#9654;</span><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK')" data-rule-id="CONDITIONAL_CHECK">CONDITIONAL_CHECK</a></div><ul class="sub-nav" id="sub-CONDITIONAL_CHECK"><li><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK', 'CONDITIONAL_CHECK_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK', 'CONDITIONAL_CHECK_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK', 'CONDITIONAL_CHECK_HowItWorks')">How It Works</a></li><li><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK', 'CONDITIONAL_CHECK_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK', 'CONDITIONAL_CHECK_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK', 'CONDITIONAL_CHECK_RelatedCheckTypes')">Related Check Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'GENERIC_PROPERTY_FILE_CHECK')">&#9654;</span><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK')" data-rule-id="GENERIC_PROPERTY_FILE_CHECK">GENERIC_PROPERTY_FILE_CHECK</a></div><ul class="sub-nav" id="sub-GENERIC_PROPERTY_FILE_CHECK"><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_ErrorConfigurationCustomization')">Error Configuration & Customization</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK', 'GENERIC_PROPERTY_FILE_CHECK_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">&#9654;</span><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')" data-rule-id="MANDATORY_PROPERTY_VALUE_CHECK">MANDATORY_PROPERTY_VALUE_CHECK</a></div><ul class="sub-nav" id="sub-MANDATORY_PROPERTY_VALUE_CHECK"><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK', 'MANDATORY_PROPERTY_VALUE_CHECK_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'MANDATORY_SUBSTRING_CHECK')">&#9654;</span><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK')" data-rule-id="MANDATORY_SUBSTRING_CHECK">MANDATORY_SUBSTRING_CHECK</a></div><ul class="sub-nav" id="sub-MANDATORY_SUBSTRING_CHECK"><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_ErrorConfigurationCustomization')">Error Configuration & Customization</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK', 'MANDATORY_SUBSTRING_CHECK_RelatedRuleTypes')">Related Rule Types</a></li></ul></li><li><div class="rule-header"><span class="toggle-icon" onclick="toggleSubNav(event, 'OPTIONAL_PROPERTY_VALUE_CHECK')">&#9654;</span><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK')" data-rule-id="OPTIONAL_PROPERTY_VALUE_CHECK">OPTIONAL_PROPERTY_VALUE_CHECK</a></div><ul class="sub-nav" id="sub-OPTIONAL_PROPERTY_VALUE_CHECK"><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_Overview')">Overview</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_UseCases')">Use Cases</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_Parameters')">Parameters</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_ConfigurationExamples')">Configuration Examples</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_ValidationLogic')">Validation Logic</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_ErrorMessages')">Error Messages</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_BestPractices')">Best Practices</a></li><li><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK', 'OPTIONAL_PROPERTY_VALUE_CHECK_RelatedRuleTypes')">Related Rule Types</a></li></ul></li>
        </ul>
    </div>
    <div class="resizer" id="resizer"></div>
    <div class="main-content">
        <div class="top-nav-container">
            <a href="CONSOLIDATED-REPORT.html" id="dashboardBtn" class="top-nav-button" title="Return to main dashboard">‚Üê Dashboard</a>
            <a href="#" id="mainPageBtn" class="top-nav-button" title="Go to Home" style="display: none; background-color: #0078d4;">üè† Home</a>
        </div>
        <div class="report-container">
            <div id="QUICK_REFERENCE" class="rule-content" style="display: block;"><h1>QUICK REFERENCE</h1>
<br>
<h2 id="QUICK_REFERENCE_1GlobalParameters">1. Global Parameters</h2>
<br>
These apply to almost ALL rule types and control file selection and logic.
<br>
<table><tr><td> Parameter      </td><td> Default      </td><td> Description                                          </td></tr></table>
<br>
      - node_modules
      prefixes:       # Folder names starting with...
      - .
      - temp_
<br>
    # Global File Exclusion
    ignoredFiles:
      exactNames:     # Specific files to ignore
      - log4j2-test.xml
      - .DS_Store
      prefixes:       # Filenames starting with...
      - debug_
<table><tr><td> <code class='inline-token'>filePatterns</code> </td><td> (Required)   </td><td> List of glob patterns for target files (e.g. <code class='inline-token'>[&quot;**/*.xml&quot;]</code>). </td></tr><tr><td> <code class='inline-token'>matchMode</code>    </td><td> <code class='inline-token'>ALL_FILES</code>  </td><td> Controls file-level quantifier (see table below).    </td></tr><tr><td> <code class='inline-token'>logic</code>        </td><td> <code class='inline-token'>AND</code>        </td><td> Combining logic for multiple checks or tokens.      </td></tr><tr><td> <code class='inline-token'>environments</code> </td><td> <code class='inline-token'>[]</code>         </td><td> List of environments where this rule applies.        </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> <code class='inline-token'>false</code>  </td><td> Enable resolution of <code class='inline-token'>${property}</code> placeholders. </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> <code class='inline-token'>false</code> </td><td> Resolve properties from the <strong>linked CONFIG project</strong>. </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> <code class='inline-token'>false</code> </td><td> Scan files in <strong>both</strong> CODE and linked CONFIG projects. </td></tr></table>
<br>
<h4>File Match Quantifiers (<code class='inline-token'>matchMode</code>)</h4>
<br>
<table><tr><td> Value           </td><td> Description                                                        </td></tr><tr><td> <code class='inline-token'>ALL_FILES</code>     </td><td> (Default) Every file must pass for the rule to pass.              </td></tr><tr><td> <code class='inline-token'>ANY_FILE</code>      </td><td> Rule passes if at least one file passes.                          </td></tr><tr><td> <code class='inline-token'>NONE_OF_FILES</code> </td><td> Rule passes only if zero files match/pass (useful for forbidden). </td></tr><tr><td> <code class='inline-token'>AT_LEAST_N</code>    </td><td> Rule passes if N or more files pass.                              </td></tr><tr><td> <code class='inline-token'>AT_LEAST_N</code>    </td><td> Rule passes if N or more files pass.                              </td></tr></table>
<br>
---
<br>
<h2 id="QUICK_REFERENCE_2ProjectTypeFiltering">2. Project Type Filtering</h2>
<br>
<strong>NEW FEATURE</strong>: Eliminate report noise by only running applicable rules on each project type.
<br>
<h3>Overview</h3>
<br>
Instead of running ALL rules on ALL projects, you can:
1. Define project types (CODE, CONFIG, API, etc.) ONCE in the <code class='inline-token'>config</code> section
2. Rules specify which types they apply to using <code class='inline-token'>appliesTo</code>
3. Non-applicable rules are automatically skipped
<br>
<h3>Configuration</h3>
<br>
<h4>Step 1: Define Project Types</h4>
<br>
Add <code class='inline-token'>projectTypes</code> to your <code class='inline-token'>config</code> section:
<br>
<pre><code class='language-yaml'>config:
  environments: [SBX, ITE, PREP, PROD]
  
  projectTypes:
    CODE:
      description: &quot;Mule application projects with source code&quot;
      detectionCriteria:
        markerFiles: [&quot;pom.xml&quot;, &quot;mule-artifact.json&quot;]
        excludePatterns: [&quot;.*_config.*&quot;]
    
    CONFIG:
      description: &quot;Configuration projects with properties and policies&quot;
      detectionCriteria:
        namePattern: &quot;.*_config.*&quot;
    
    API:
      description: &quot;API layer projects&quot;
      detectionCriteria:
        nameContains: &quot;-api-&quot;
        markerFiles: [&quot;pom.xml&quot;]
</code></pre>
<br>
<h4>Step 2: Reference Types in Rules</h4>
<br>
<pre><code class='language-yaml'>rules:
  # CODE-only rule
  - id: &quot;RULE-001&quot;
    name: &quot;Validate Parent POM&quot;
    appliesTo: [&quot;CODE&quot;]  # Only runs on CODE projects
    checks:
      - type: POM_VALIDATION_REQUIRED
        # ...
  
  # CONFIG-only rule
  - id: &quot;RULE-006&quot;
    name: &quot;Header Injection Policy&quot;
    appliesTo: [&quot;CONFIG&quot;]  # Only runs on CONFIG projects
    checks:
      - type: MANDATORY_PROPERTY_VALUE_CHECK
        # ...
  
  # Multi-type rule
  - id: &quot;RULE-040&quot;
    name: &quot;Java 17 Migration&quot;
    appliesTo: [&quot;CODE&quot;, &quot;API&quot;]  # Runs on both CODE and API projects
    checks:
      - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
        # ...
  
  # Universal rule (no appliesTo)
  - id: &quot;RULE-100&quot;
    name: &quot;Mandatory Substring Check&quot;
    # No appliesTo = applies to ALL projects
    checks:
      - type: GENERIC_TOKEN_SEARCH_REQUIRED
        # ...
</code></pre>
<br>
<h3>Detection Criteria Options</h3>
<br>
<table><tr><td> Criterion </td><td> Type </td><td> Description </td><td> Example </td></tr><tr><td> <code class='inline-token'>markerFiles</code> </td><td> List </td><td> Files that must exist (supports glob patterns) </td><td> <code class='inline-token'>[&quot;pom.xml&quot;, &quot;**/*.policy&quot;]</code> </td></tr><tr><td> <code class='inline-token'>namePattern</code> </td><td> String </td><td> Regex pattern for project folder name </td><td> <code class='inline-token'>&quot;.*_config.*&quot;</code> </td></tr><tr><td> <code class='inline-token'>nameContains</code> </td><td> String/List </td><td> Substring(s) the project name must contain </td><td> <code class='inline-token'>&quot;-api-&quot;</code> or <code class='inline-token'>[&quot;-api-&quot;, &quot;-svc-&quot;]</code> </td></tr><tr><td> <code class='inline-token'>excludePatterns</code> </td><td> List </td><td> Regex patterns to exclude projects </td><td> <code class='inline-token'>[&quot;.*_config.*&quot;, &quot;.*-test-.*&quot;]</code> </td></tr><tr><td> <code class='inline-token'>logic</code> </td><td> String </td><td> AND/OR logic for criteria (default: OR) </td><td> <code class='inline-token'>&quot;AND&quot;</code> </td></tr></table>
<br>
<h3>Examples for Different Technologies</h3>
<br>
<strong>Spring Boot Projects:</strong>
<pre><code class='language-yaml'>SPRING_BOOT:
  description: &quot;Spring Boot applications&quot;
  detectionCriteria:
    markerFiles: [&quot;pom.xml&quot;, &quot;src/main/resources/application.properties&quot;]
    logic: AND
</code></pre>
<br>
<strong>TIBCO Projects:</strong>
<pre><code class='language-yaml'>TIBCO:
  description: &quot;TIBCO BusinessWorks projects&quot;
  detectionCriteria:
    markerFiles: [&quot;**/*.bwp&quot;, &quot;**/*.process&quot;]
</code></pre>
<br>
<strong>Python Projects:</strong>
<pre><code class='language-yaml'>PYTHON:
  description: &quot;Python applications&quot;
  detectionCriteria:
    markerFiles: [&quot;requirements.txt&quot;, &quot;setup.py&quot;]
</code></pre>
<br>
<h3>Benefits</h3>
<br>
‚úÖ <strong>Cleaner Reports</strong>: Only show relevant rules for each project
‚úÖ <strong>No False Positives</strong>: CONFIG projects won't fail on CODE-specific rules
‚úÖ <strong>Better Focus</strong>: Teams see only rules that matter to their project type
‚úÖ <strong>Zero Performance Impact</strong>: Classification cached (~1ms per project)
‚úÖ <strong>Backward Compatible</strong>: No <code class='inline-token'>projectTypes</code> = all rules apply to all projects
<br>
<h3>Backward Compatibility</h3>
<br>
<li><strong>No <code class='inline-token'>projectTypes</code> in config</strong>: All rules apply to all projects (current behavior)</li>
<li><strong>No <code class='inline-token'>appliesTo</code> in rule</strong>: Rule applies to all projects</li>
<li><strong>Empty <code class='inline-token'>appliesTo: []</code></strong>: Rule applies to NO projects (effectively disabled)</li>
<br>
---
<br>
<h2 id="QUICK_REFERENCE_3LogicPatternsPositivevsNegative">3. Logic Patterns (Positive vs. Negative)</h2>
<br>
Understanding when to use Positive Logic ("Ensure Good Exists") versus Negative Logic ("Ensure Bad Does Not Exist") is crucial for creating accurate rules.
<br>
<h3>Positive Logic (REQUIRED)</h3>
*   <strong>Concept</strong>: "Does at least ONE valid instance exist?"
*   <strong>Use Case</strong>: Verifying that a mandatory component is present (e.g., "App MUST have a Global Exception Handler").
*   <strong>Behavior</strong>: If the scanner finds <strong>one</strong> compliant item, the file PASSES.
*   <strong>‚ö†Ô∏è Pitfall</strong>: If a file has one "Good" item and ten "Bad" items, it will still PASS.
    *   *Example*: <code class='inline-token'>tokens: [&quot;secure=true&quot;]</code>. File contains <code class='inline-token'>secure=true</code> AND <code class='inline-token'>secure=false</code>. Result: PASS (because valid token was found).
<br>
<h3>Negative Logic (FORBIDDEN)</h3>
*   <strong>Concept</strong>: "Does ANY invalid instance exist?"
*   <strong>Use Case</strong>: Security audit, finding deprecated code, ensuring specific configurations are NOT used.
*   <strong>Behavior</strong>: If the scanner finds <strong>one</strong> non-compliant item, the file FAILS.
*   <strong>‚úÖ Best Practice</strong>: For enforcing strict configurations (like "All connections must be encrypted"), usage of <strong>Negative Logic</strong> is safer.
<br>
<h3>Case Study: Detailed Configuration Checks</h3>
<strong>Goal</strong>: Enforce <code class='inline-token'>ApplicationId</code> in DB2 URLs (<code class='inline-token'>jdbc:db2://...;ApplicationId=MyApp</code>).
<br>
<h4>‚ùå Approach A: Positive Logic (Weak)</h4>
*   <strong>Rule Type</strong>: <code class='inline-token'>GENERIC_TOKEN_SEARCH_REQUIRED</code>
*   <strong>Token</strong>: <code class='inline-token'>jdbc:db2.*ApplicationId=</code>
*   <strong>Scenario</strong>: File contains:
    1.  <code class='inline-token'>db.bad=jdbc:db2://...</code> (Missing ID)
    2.  <code class='inline-token'>db.good=jdbc:db2://...;ApplicationId=MyApp</code> (Matches!)
*   <strong>Result</strong>: <strong>PASS</strong> (False Negative). The rule found the "Good" line and was satisfied, ignoring the "Bad" line.
<br>
<h4>‚úÖ Approach B: Negative Logic + Regex (Strong)</h4>
*   <strong>Rule Type</strong>: <code class='inline-token'>GENERIC_TOKEN_SEARCH_FORBIDDEN</code>
*   <strong>Token</strong>: <code class='inline-token'>jdbc:db2(?!.*ApplicationId=).*</code> (Regex Negative Lookahead)
    *   *Meaning*: "Find any DB2 string that does <strong>NOT</strong> contain ApplicationId".
*   <strong>Scenario</strong>: Same file.
*   <strong>Result</strong>: <strong>FAIL</strong> (Correct). The rule explicitly searches for the broken line. The "Good" line does not match the "Bad" regex, but the "Bad" line does.
<br>
---
<br>
<h2 id="QUICK_REFERENCE_2MessageTokens">2. Message Tokens</h2>
<br>
You can use the following tokens in <code class='inline-token'>successMessage</code> and <code class='inline-token'>errorMessage</code> to provide dynamic feedback in reports:
<br>
<table><tr><td> Token </td><td> Description </td><td> Availability </td><td> Example Output </td></tr><tr><td> <code class='inline-token'>{RULE_ID}</code> </td><td> The ID of the current rule. </td><td> Always </td><td> <code class='inline-token'>BANK-021</code> </td></tr><tr><td> <code class='inline-token'>{DEFAULT_MESSAGE}</code> </td><td> Technical details of the check result (e.g., valid/invalid values). </td><td> Always </td><td> <code class='inline-token'>Validation failed for...</code> </td></tr><tr><td> <code class='inline-token'>{CHECKED_FILES}</code> </td><td> List of files that were actually processed/scanned. </td><td> Always (Defaults to "None") </td><td> <code class='inline-token'>src/main/mule/api.xml</code> </td></tr><tr><td> <code class='inline-token'>{MATCHING_FILES}</code></td><td> List of files that *passed* the check condition. </td><td> Success Messages </td><td> <code class='inline-token'>src/main/mule/valid.xml</code> </td></tr><tr><td> <code class='inline-token'>{FOUND_ITEMS}</code> </td><td> Specific forbidden items found (e.g., tokens, attributes). </td><td> <code class='inline-token'>*_FORBIDDEN</code>, <code class='inline-token'>*_NOT_EXISTS</code> </td><td> <code class='inline-token'>jce-encrypt, toApplicationCode</code> </td></tr><tr><td> <code class='inline-token'>{CORE_DETAILS}</code> </td><td> Core validation failure info (a cleaner subset of Default). </td><td> Always </td><td> <code class='inline-token'>Missing 'encrypt=false'</code> </td></tr><tr><td> <code class='inline-token'>{FAILURES}</code> </td><td> Specific failure reasons if multiple checks failed. </td><td> Compound Checks </td><td> <code class='inline-token'>XPath not found...</code> </td></tr><tr><td> <code class='inline-token'>{PROPERTY_RESOLVED}</code></td><td> Details of any property placeholders resolved. </td><td> Validated Properties </td><td> <code class='inline-token'>Resolved ${port} -&gt; 8081</code> </td></tr></table>
<br>
<strong>Example Usage</strong>:
<pre><code class='language-yaml'>errorMessage: &quot;‚úó Security Violation in {RULE_ID}: Found forbidden tokens {FOUND_ITEMS}. \n Checked: {CHECKED_FILES}&quot;
</code></pre>
<br>
---
<br>
<h2 id="QUICK_REFERENCE_LogicalOperatorslogic">Logical Operators (<code class='inline-token'>logic</code>)</h2>
<br>
The <code class='inline-token'>logic</code> parameter determines how multiple tokens or checks within a single rule are combined. This is critical for rules with multiple search items.
<br>
<h3>logic: OR (Default for Forbidden)</h3>
<li><strong>Concept</strong>: "Fail if ANY of these match."</li>
<li><strong>Behavior</strong>: If you have <code class='inline-token'>tokens: [&quot;A&quot;, &quot;B&quot;]</code>, the rule triggers a failure if <strong>EITHER</strong> <code class='inline-token'>A</code> is found <strong>OR</strong> <code class='inline-token'>B</code> is found.</li>
<li><strong>Hyphen Handling</strong>: Useful for tokens like <code class='inline-token'>RAKS-AAA-SOAP</code>. If you want to detect *any* version of RAKS AAA policies (SOAP or HTTP), <code class='inline-token'>logic: OR</code> ensures that finding just the SOAP one is enough to fail the check.</li>
<br>
<h3>logic: AND (Default for Required)</h3>
<li><strong>Concept</strong>: "Fail ONLY if ALL of these match."</li>
<li><strong>Behavior</strong>: If you have <code class='inline-token'>tokens: [&quot;A&quot;, &quot;B&quot;]</code>, the rule triggers a failure <strong>ONLY IF BOTH</strong> <code class='inline-token'>A</code> and <code class='inline-token'>B</code> are present in the same file.</li>
<li><strong>Example</strong>: If you want to forbid a specific *combination* of security headers, use <code class='inline-token'>AND</code>.</li>
<br>
> [!IMPORTANT]
> <strong>Issue Case (Hyphens)</strong>:
> Earlier, a check used <code class='inline-token'>logic: AND</code>. This caused it to "Pass" (incorrectly) because it was waiting for *all* forbidden tokens to appear in a single file. By switching to <code class='inline-token'>OR</code>, it now correctly flags a file as soon as it sees <code class='inline-token'>RAKS-AAA-SOAP</code>.
<br>
---
<br>
<h2 id="QUICK_REFERENCE_2RuleSpecificParameters">2. Rule-Specific Parameters</h2>
Each rule type has its own required parameters. Using the wrong parameter name will result in the rule being ignored or failing silently.
<br>
<h4><strong>TOKEN_SEARCH</strong> (Global Token Search)</h4>
Used for scanning text files for literal strings or regex patterns. Use <code class='inline-token'>GENERIC_TOKEN_SEARCH_REQUIRED</code> or <code class='inline-token'>GENERIC_TOKEN_SEARCH_FORBIDDEN</code>.
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>tokens</code> </td><td> List </td><td> (Required) </td><td> List of strings or regex patterns to search for. </td></tr><tr><td> <code class='inline-token'>isRegex</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Set to <code class='inline-token'>true</code> if <code class='inline-token'>tokens</code> are regular expressions. </td></tr><tr><td> <code class='inline-token'>caseSensitive</code></td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Enable/disable case sensitivity. </td></tr><tr><td> <code class='inline-token'>wholeWord</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> If <code class='inline-token'>true</code>, ensures exact word matching (wraps tokens in <code class='inline-token'>\b</code>). </td></tr><tr><td> <strong><code class='inline-token'>ignoreComments</code></strong> </td><td> <strong>Boolean</strong> </td><td> <strong><code class='inline-token'>false</code></strong> </td><td> <strong>If <code class='inline-token'>true</code>, removes comments before searching (strict mode). Recommended for FORBIDDEN rules to avoid false positives. Supports XML, Java, Groovy, DataWeave, JSON, Properties, YAML, SQL, and Shell files.</strong> </td></tr><tr><td> <code class='inline-token'>logic</code> </td><td> String </td><td> <code class='inline-token'>AND</code> (Req) / <code class='inline-token'>OR</code> (Forb) </td><td> Use <code class='inline-token'>OR</code> to fail if ANY token is found in FORBIDDEN mode. </td></tr></table>
<br>
> [!TIP]
> <strong>Comment Handling</strong>: Use <code class='inline-token'>ignoreComments: true</code> for FORBIDDEN rules to avoid false positives from commented code.
> Supports both single-line (<code class='inline-token'>//</code>, <code class='inline-token'>#</code>, <code class='inline-token'>--</code>) and multi-line block comments (<code class='inline-token'>/* */</code>, <code class='inline-token'>&lt;!-- --&gt;</code>).
> See <a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN')">CODE_GENERIC_TOKEN_SEARCH_FORBIDDEN.md</a> for detailed examples.
<br>
<br>
> [!IMPORTANT]
> <strong>Token Matching vs. File Matching</strong>:
> For token search, <code class='inline-token'>isRegex</code> controls how tokens are matched. <code class='inline-token'>matchMode</code> controls how MANY files must satisfy the condition.
> <strong>DO NOT</strong> set <code class='inline-token'>matchMode: SUBSTRING</code> - it will fall back to <code class='inline-token'>ALL_FILES</code>.
<br>
<strong>Example (Regex for exact word match)</strong>:
<pre><code class='language-yaml'>- type: GENERIC_TOKEN_SEARCH_FORBIDDEN
  params:
    filePatterns: [&quot;**/*.xml&quot;]
    tokens: [&quot;\\bRAKS-AAA-SOAP\\b&quot;] # \b ensures exact word match
    isRegex: true
</code></pre>
<br>
<h4><strong>XML_ATTRIBUTE_EXISTS</strong> / <strong>NOT_EXISTS</strong></h4>
Used for validating specific element attributes in XML files.
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>elements</code> </td><td> List </td><td> (Required) </td><td> Element names to check. </td></tr><tr><td> <code class='inline-token'>elementAttributeSets</code> </td><td> List<Map></td><td> ‚úÖ (EXISTS) </td><td> Pairs of <code class='inline-token'>{element: &quot;...&quot;, attributes: {key: &quot;val&quot;}}</code>. </td></tr><tr><td> <code class='inline-token'>forbiddenAttributes</code></td><td> List </td><td> ‚úÖ (NOT_EXISTS) </td><td> List of attributes that must not exist on the element. </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> <strong>Property Resolution</strong>: Resolves <code class='inline-token'>${...}</code> before checking. </td></tr></table>
<br>
<h4><strong>XML_ELEMENT_CONTENT_REQUIRED</strong> / <strong>FORBIDDEN</strong></h4>
Used for validating the text content of XML elements.
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>element</code> </td><td> String </td><td> (Required) </td><td> The XML element to check (e.g. <code class='inline-token'>version</code>). </td></tr><tr><td> <code class='inline-token'>expectedValue</code></td><td> String </td><td> ‚úÖ (REQUIRED) </td><td> The text content the element must have. </td></tr><tr><td> <code class='inline-token'>forbiddenValue</code></td><td> String </td><td> ‚úÖ (FORBIDDEN)</td><td> Content that must not exist in any matching element. </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> <strong>Property Resolution</strong>: Resolves placeholders in content. </td></tr></table>
<br>
<h4><strong>JSON_VALIDATION_REQUIRED</strong> / <strong>FORBIDDEN</strong></h4>
Used for validating JSON structure and values.
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePattern</code> </td><td> String </td><td> ‚úÖ </td><td> Single file to validate (e.g. <code class='inline-token'>mule-artifact.json</code>). </td></tr><tr><td> <code class='inline-token'>requiredFields</code> </td><td> Map </td><td> ‚ùå </td><td> Key-Value pairs that must match exactly. </td></tr><tr><td> <code class='inline-token'>minVersions</code> </td><td> Map </td><td> ‚ùå </td><td> Semantic version comparison (e.g. <code class='inline-token'>mule: &quot;4.9.0&quot;</code>). </td></tr><tr><td> <code class='inline-token'>forbiddenElements</code> </td><td> List </td><td> ‚úÖ (FORB) </td><td> Keys that must not exist in the JSON. </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> <strong>Property Resolution</strong>: Resolves placeholders in JSON values. </td></tr></table>
<br>
---
<br>
<h2 id="QUICK_REFERENCE_ValidationOperatorsComparisonMatrix">Validation Operators & Comparison Matrix</h2>
<br>
<h3>Operator Support by Technology</h3>
<br>
<table><tr><td> Operator </td><td> Type </td><td> Description </td><td> Supported Rules </td></tr><tr><td> <code class='inline-token'>GTE</code> / <code class='inline-token'>minVersion</code> </td><td> SEMVER </td><td> Greater than or equal (4.9.7 >= 4.9.0) </td><td> JSON, POM </td></tr><tr><td> <code class='inline-token'>LTE</code> / <code class='inline-token'>maxVersion</code> </td><td> SEMVER </td><td> Less than or equal </td><td> JSON, POM </td></tr><tr><td> <code class='inline-token'>EQ</code> </td><td> STRING </td><td> Exact string match </td><td> ALL Value Checks </td></tr><tr><td> <code class='inline-token'>CONTAINS</code> </td><td> STRING </td><td> Substring exists within target </td><td> XML_XPATH, TOKEN </td></tr></table>
<br>
<h3>Parameter Support Matrix</h3>
<br>
<table><tr><td> Parameter </td><td> XML_ATTR </td><td> XML_XPATH </td><td> JSON_VAL </td><td> TOKEN_SEARCH </td><td> POM_VAL </td></tr><tr><td> <code class='inline-token'>required</code> / <code class='inline-token'>forbidden</code> </td><td> ‚úÖ </td><td> ‚úÖ </td><td> ‚úÖ </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> ‚úÖ </td><td> ‚úÖ </td><td> ‚úÖ </td><td> ‚ùå </td><td> ‚ùå </td></tr><tr><td> <code class='inline-token'>isRegex</code> </td><td> ‚ùå </td><td> ‚ùå </td><td> ‚ùå </td><td> ‚úÖ </td><td> ‚ùå </td></tr><tr><td> <code class='inline-token'>logic (AND/OR)</code></td><td> ‚úÖ </td><td> ‚úÖ </td><td> ‚úÖ </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <code class='inline-token'>valueType (SEMVER)</code> </td><td> ‚úÖ </td><td> ‚ùå </td><td> ‚úÖ </td><td> ‚ùå </td><td> ‚úÖ </td></tr><tr><td> <code class='inline-token'>elementContent</code> </td><td> ‚úÖ </td><td> ‚ùå </td><td> ‚ùå </td><td> ‚ùå </td><td> ‚ùå </td></tr></table>
<br>
---
<br>
<h2 id="QUICK_REFERENCE_PropertyResolutionGuideFlagshipFeature">Property Resolution Guide (Flagship Feature)</h2>
<br>
<h3>Supported Resolutions</h3>
<br>
<table><tr><td> <code class='inline-token'>XML_ATTRIBUTE_EXISTS</code> </td><td> Attribute Values </td><td> <code class='inline-token'>soapVersion=&quot;${soapversion}&quot;</code> </td></tr><tr><td> <code class='inline-token'>XML_ELEMENT_CONTENT_REQUIRED</code> </td><td> Text Content </td><td> <code class='inline-token'>&lt;version&gt;${pom.version}&lt;/version&gt;</code> </td></tr><tr><td> <code class='inline-token'>JSON_VALIDATION_REQUIRED</code> </td><td> JSON Values </td><td> <code class='inline-token'>{&quot;muleEnv&quot;: &quot;${env}&quot;}</code> </td></tr><tr><td> <code class='inline-token'>TOKEN_SEARCH</code> </td><td> Text Search </td><td> <code class='inline-token'>tokens: [&quot;${db2.url}&quot;]</code> </td></tr></table>
<br>
<h3>Cross-Project Resolution (CODE + CONFIG)</h3>
<br>
When a rule applies to both <code class='inline-token'>CODE</code> and <code class='inline-token'>CONFIG</code> (using <code class='inline-token'>appliesTo: [&quot;CODE&quot;, &quot;CONFIG&quot;]</code>), you can enable cross-project resolution to validate that properties referenced in your code exist in your configuration files.
<br>
<strong>Example</strong>:
<pre><code class='language-yaml'>- id: &quot;DB2-URL-CHECK&quot;
  name: &quot;Validate DB2 URL from Config&quot;
  appliesTo: [&quot;CODE&quot;, &quot;CONFIG&quot;]
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: [&quot;src/main/mule/*.xml&quot;]
        tokens: [&quot;${db2.url}&quot;]
        resolveProperties: true
        resolveLinkedConfig: true
        includeLinkedConfig: true
</code></pre>
<br>
*   <strong>Behavior</strong>:
    1.  Aegis finds <code class='inline-token'>${db2.url}</code> in a Mule XML file.
    2.  <code class='inline-token'>resolveProperties: true</code> triggers the search for <code class='inline-token'>db2.url</code>.
    3.  <code class='inline-token'>resolveLinkedConfig: true</code> allows searching in the linked property files (e.g., <code class='inline-token'>dev.properties</code> in the CONFIG project).
    4.  <code class='inline-token'>includeLinkedConfig: true</code> ensures the property files themselves are also validated if needed.
<br>
<br>
201: > [!TIP]
202: > <strong>Transparency</strong>: Always add <code class='inline-token'>{PROPERTY_RESOLVED}</code> to your messages to see resolution details in reports.
<br>
<br>
<br>
---
<br>
<h2 id="QUICK_REFERENCE_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Property Resolution (XML Attributes)</h3>
<br>
<pre><code class='language-yaml'>rules:
  - id: &quot;SOAP-VERSION-CHECK&quot;
    name: &quot;Validate SOAP Version with Property Resolution&quot;
    checks:
    - type: XML_ATTRIBUTE_EXISTS
      params:
        filePatterns: [&quot;src/main/mule/*-config.xml&quot;]
        elementAttributeSets:
        - element: &quot;apikit-soap:config&quot;
          attributes: {soapVersion: &quot;SOAP_11&quot;}
        - element: &quot;apikit-soap:config&quot;
          attributes: {soapVersion: &quot;SOAP_12&quot;}
        resolveProperties: true  # Resolves ${soapVersion} from properties
</code></pre>
<br>
<strong>XML File</strong>:
<pre><code class='language-xml'>&lt;apikit-soap:config soapVersion=&quot;${soapVersion}&quot; /&gt;
</code></pre>
<br>
<strong>Property File</strong> (<code class='inline-token'>mule-app.properties</code>):
<pre><code class='language-properties'>soapVersion=SOAP_11
</code></pre>
<br>
<strong>Result</strong>: ‚úÖ PASS (resolved <code class='inline-token'>${soapVersion}</code> ‚Üí <code class='inline-token'>SOAP_11</code>)
<br>
<h3>Example 2: Property Resolution (XML Content)</h3>
<br>
<pre><code class='language-yaml'>rules:
  - id: &quot;APP-VERSION-CHECK&quot;
    name: &quot;Validate App Version in XML&quot;
    successMessage: &quot;‚úì Version validated: {PROPERTY_RESOLVED}&quot;
    checks:
    - type: XML_ELEMENT_CONTENT_REQUIRED
      params:
        filePatterns: [&quot;**/version-info.xml&quot;]
        element: &quot;version&quot;
        expectedValue: &quot;1.2.3&quot;
        resolveProperties: true
</code></pre>
<br>
<strong>XML File</strong>:
<pre><code class='language-xml'>&lt;version&gt;${app.version}&lt;/version&gt;
</code></pre>
<br>
<strong>Property File</strong>: <code class='inline-token'>app.version=1.2.3</code>
<br>
<strong>Result</strong>: ‚úÖ PASS (resolved <code class='inline-token'>${app.version}</code> ‚Üí <code class='inline-token'>1.2.3</code>)
<br>
<h3>Example 2: Using {FOUND_ITEMS} Token</h3>
<br>
<pre><code class='language-yaml'>rules:
  - id: &quot;FORBID-LEGACY-ATTRS&quot;
    name: &quot;Forbid Legacy Logger Attributes&quot;
    errorMessage: &quot;‚úó Found forbidden attributes: {FOUND_ITEMS}. {DEFAULT_MESSAGE}&quot;
    checks:
    - type: XML_ATTRIBUTE_NOT_EXISTS
      params:
        filePatterns: [&quot;src/main/mule/*.xml&quot;]
        elements: [&quot;logger&quot;]
        forbiddenAttributes: [&quot;toApplicationCode&quot;, &quot;fromApplicationCode&quot;]
</code></pre>
<br>
<strong>Result</strong>: <code class='inline-token'>‚úó Found forbidden attributes: toApplicationCode, fromApplicationCode. ...</code>
<br>
<h3>Example 3: Exact Token Matching with REGEX</h3>
<br>
<pre><code class='language-yaml'>rules:
  - id: &quot;FORBID-JCE-ENCRYPT&quot;
    name: &quot;Forbid jce-encrypt Token&quot;
    errorMessage: &quot;‚úó Found forbidden token: {FOUND_ITEMS}. Use EncUtil instead.&quot;
    checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns: [&quot;src/main/mule/*.xml&quot;]
        tokens: [&quot;\\bjce-encrypt\\b&quot;]  # \b = word boundary for exact match
        matchMode: REGEX
</code></pre>
<br>
<strong>Matches</strong>: <code class='inline-token'>jce-encrypt</code> (exact word)  
<strong>Does NOT Match</strong>: <code class='inline-token'>my-jce-encrypt-util</code>, <code class='inline-token'>jce-encryption</code>
<br>
---
<br>
<h2 id="QUICK_REFERENCE_BestPractices">Best Practices</h2>
<br>
<h3>1. Message Token Usage</h3>
<br>
‚úÖ <strong>DO</strong>:
<pre><code class='language-yaml'>errorMessage: &quot;‚úó Validation failed: {FOUND_ITEMS}. {DEFAULT_MESSAGE}&quot;
successMessage: &quot;‚úì All checks passed. {CHECKED_FILES}&quot;
</code></pre>
<br>
‚ùå <strong>DON'T</strong>:
<pre><code class='language-yaml'>errorMessage: &quot;Error&quot;  # Too vague, no technical details
</code></pre>
<br>
<h3>2. Property Resolution</h3>
<br>
‚úÖ <strong>DO</strong>: Enable for configuration value checks
<pre><code class='language-yaml'>- type: XML_ATTRIBUTE_EXISTS
  params:
    resolveProperties: true  # Resolve ${...} placeholders
</code></pre>
<br>
‚ùå <strong>DON'T</strong>: Enable for literal token searches
<pre><code class='language-yaml'>- type: GENERIC_TOKEN_SEARCH_FORBIDDEN
  # Property resolution not supported - searches for literal text
</code></pre>
<br>
<h3>3. Match Mode Selection</h3>
<br>
<table><tr><td> Scenario </td><td> Recommended Mode </td></tr><tr><td> "Every file must have X" </td><td> <code class='inline-token'>matchMode: ALL_FILES</code> </td></tr><tr><td> "At least one file must have X" </td><td> <code class='inline-token'>matchMode: ANY_FILE</code> </td></tr><tr><td> "No file should have X" </td><td> Use <code class='inline-token'>*_FORBIDDEN</code> rule type </td></tr></table>
<br>
<h3>4. Performance Optimization</h3>
<br>
<table><tr><td> Scenario </td><td> Recommendation </td></tr><tr><td> Simple keyword search </td><td> Use <code class='inline-token'>matchMode: SUBSTRING</code> (faster) </td></tr><tr><td> Exact Word Match </td><td> Use <code class='inline-token'>wholeWord: true</code> (Simple & Fast) </td></tr><tr><td> Pattern matching </td><td> Use <code class='inline-token'>matchMode: REGEX</code> (more powerful) </td></tr><tr><td> Complex Boundaries </td><td> Use <code class='inline-token'>REGEX</code> with <code class='inline-token'>\b</code> or other regex markers </td></tr><tr><td> Large file sets </td><td> Narrow <code class='inline-token'>filePatterns</code> as much as possible </td></tr></table>
<br>
---
<br>
<h2 id="QUICK_REFERENCE_TechnologySpecificGuides">Technology-Specific Guides</h2>
<br>
<h3>Mule Projects</h3>
<br>
<strong>Common Property Files</strong>:
<li><code class='inline-token'>src/main/resources/mule-app.properties</code></li>
<li><code class='inline-token'>src/main/resources/config-${env}.properties</code></li>
<br>
<strong>Property Syntax</strong>:
<li><code class='inline-token'>${property.name}</code> - Standard placeholder</li>
<li><code class='inline-token'>p('property.name')</code> - DataWeave function</li>
<br>
<strong>Recommended Rules</strong>:
<li><code class='inline-token'>XML_ATTRIBUTE_EXISTS</code> with <code class='inline-token'>resolveProperties: true</code></li>
<li><code class='inline-token'>JSON_VALIDATION_REQUIRED</code> for <code class='inline-token'>mule-artifact.json</code></li>
<li><code class='inline-token'>POM_VALIDATION_REQUIRED</code> for Maven dependencies</li>
<br>
<h3>Spring Boot Projects</h3>
<br>
<strong>Common Property Files</strong>:
<li><code class='inline-token'>src/main/resources/application.yml</code></li>
<li><code class='inline-token'>src/main/resources/application-${profile}.properties</code></li>
<br>
<strong>Property Syntax</strong>:
<li><code class='inline-token'>${property.name}</code> - Standard placeholder</li>
<li><code class='inline-token'>@Value(&quot;${property}&quot;)</code> - Annotation-based</li>
<br>
<h3>TIBCO Projects</h3>
<br>
<strong>Common Property Files</strong>:
<li><code class='inline-token'>*.substvar</code> files</li>
<li><code class='inline-token'>*.properties</code> files</li>
<br>
<strong>Property Syntax</strong>:
<li><code class='inline-token'>%%PROPERTY_NAME%%</code> - Global variable</li>
<li><code class='inline-token'>$_PROPERTY_NAME</code> - Process variable</li>
<br>
---
<br>
<h2 id="QUICK_REFERENCE_Troubleshooting">Troubleshooting</h2>
<br>
<h3>Property Resolution Not Working</h3>
<br>
<strong>Problem</strong>: Properties not being resolved in XML attributes
<br>
<strong>Solution</strong>:
1. Verify <code class='inline-token'>resolveProperties: true</code> is set in rule params
2. Check property files are in expected locations
3. Verify syntax pattern matches your technology (see table above)
4. Check property file paths in <code class='inline-token'>config.propertyResolution.propertyFiles.patterns</code>
<br>
<h3>{FOUND_ITEMS} Token Empty</h3>
<br>
<strong>Problem</strong>: <code class='inline-token'>{FOUND_ITEMS}</code> shows nothing in error message
<br>
<strong>Solution</strong>:
1. <code class='inline-token'>{FOUND_ITEMS}</code> only works with <code class='inline-token'>*_FORBIDDEN</code> and <code class='inline-token'>*_NOT_EXISTS</code> rule types
2. Verify you're using a supported rule type (see compatibility matrix above)
3. For other rule types, use <code class='inline-token'>{DEFAULT_MESSAGE}</code> instead
<br>
<h3>Version Comparison Failing</h3>
<br>
<strong>Problem</strong>: <code class='inline-token'>minVersion: &quot;4.9.0&quot;</code> not matching <code class='inline-token'>4.9.7</code>
<br>
<strong>Solution</strong>:
1. Ensure version format is consistent (use quotes for string versions)
2. Check for special suffixes (<code class='inline-token'>LTS</code>, <code class='inline-token'>SNAPSHOT</code>) - these are handled specially
3. Use <code class='inline-token'>{DEFAULT_MESSAGE}</code> in error to see actual vs expected versions
</div><div id="GLOBAL_CONFIGURATION" class="rule-content" style="display: none;"><h1>GLOBAL_CONFIGURATION</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>GLOBAL</code> </td><td> <strong>Applies To:</strong> All Rule Types
<br>
<h2 id="GLOBAL_CONFIGURATION_Overview">Overview</h2>
<br>
Aegis provides a powerful set of global configuration options that apply across various rule types. Understanding these operators, match modes, and scope controls allows you to create precise, efficient, and robust validation rules across disparate technologies.
<br>
<h2 id="GLOBAL_CONFIGURATION_MatchModes">Match Modes</h2>
<br>
Match modes define how Aegis evaluates rule compliance across multiple file sets.
<br>
<h3>ALL_FILES (Default)</h3>
<br>
The rule passes ONLY if <strong>EVERY</strong> matching file satisfies the condition.
<br>
<li><strong>Use Case</strong>: Consistency checks (e.g., "Every Java file must have a specific license header", "No configuration file should contain hardcoded IPs").</li>
<li><strong>Failure</strong>: Fails if even one file violates the rule.</li>
<br>
<h3>ANY_FILE</h3>
<br>
The rule passes if <strong>AT LEAST ONE</strong> matching file satisfies the condition.
<br>
<li><strong>Use Case</strong>: Existence checks (e.g., "The project must have a <code class='inline-token'>README.md</code> defined somewhere", "At least one security configuration file must exist").</li>
<li><strong>Failure</strong>: Fails ONLY if zero files satisfy the condition.</li>
<br>
<h3>SUBSTRING</h3>
<br>
Simple text matching. Checks if a token exists as a literal substring within the file content.
<br>
<li><strong>Use Case</strong>: Fast, simple checks for specific keywords, property names, or clear-text strings.</li>
<br>
<h3>REGEX</h3>
<br>
Content matching using Regular Expressions.
<br>
<li><strong>Use Case</strong>: Complex pattern matching (e.g., credit card numbers, specific IP ranges, variable naming conventions with wildcards).</li>
<br>
<h3>EXACT (XPath)</h3>
<br>
Strict matching for XPath values. The value extracted from the XML must match the expected value character-for-character.
<br>
---
<br>
<h2 id="GLOBAL_CONFIGURATION_LogicOperators">Logic Operators</h2>
<br>
Operators modify how the rule engine interprets the results of a search or evaluation.
<br>
<h3>failIfFound</h3>
<br>
<strong>Type</strong>: <code class='inline-token'>Boolean</code> </td><td> <strong>Default</strong>: <code class='inline-token'>false</code>
<br>
<li><strong>true</strong>: The rule FAILS if the specified pattern, token, or XPath IS FOUND.</li>
  - *Example*: "Fail if a hardcoded secret is found."
<li><strong>false</strong>: The rule FAILS if the specified pattern, token, or XPath IS NOT FOUND.</li>
  - *Example*: "Fail if a required framework module is missing."
<br>
<h3>caseSensitive</h3>
<br>
<strong>Type</strong>: <code class='inline-token'>Boolean</code> </td><td> <strong>Default</strong>: <code class='inline-token'>true</code>
<br>
<li><strong>true</strong>: "Error" and "error" are treated as different strings.</li>
<li><strong>false</strong>: Case is ignored during matching ("Error" == "error").</li>
<br>
<h3>negativeMatch</h3>
<br>
<strong>Type</strong>: <code class='inline-token'>Boolean</code> </td><td> <strong>Default</strong>: <code class='inline-token'>false</code>
<br>
<li>Used in some specialized token or attribute searches to invert the match logic locally within a check.</li>
<br>
---
<br>
<h2 id="GLOBAL_CONFIGURATION_ScopeControl">Scope Control</h2>
<br>
Control exactly which files and environments a rule targets.
<br>
<h3>environments</h3>
<br>
<strong>Type</strong>: <code class='inline-token'>List</code>
<br>
Defines which environments the rule applies to.
<br>
<li><strong>Values</strong>:</li>
  - <code class='inline-token'>[&quot;ALL&quot;]</code>: Applies to all scans regardless of environment key.
  - <code class='inline-token'>[&quot;DEV&quot;, &quot;QA&quot;]</code>: Applies only when the scan is triggered for these specific environment keys.
<li><strong>Best Practice</strong>: Use this for environment-specific property checks (e.g., ensuring debug mode is only allowed in <code class='inline-token'>DEV</code>).</li>
<br>
<h3>filePatterns</h3>
<br>
<strong>Type</strong>: <code class='inline-token'>List</code>
<br>
Glob patterns to filter which files are scanned by the rule engine.
<br>
<li><strong>Examples</strong>:</li>
  - <code class='inline-token'>src/main/resources/*.properties</code> (Java / Spring)
  - <code class='inline-token'>src/main/mule/*.xml</code> (MuleSoft)
  - <code class='inline-token'>**/*.py</code> (Python)
  - <code class='inline-token'>package.json</code> (Node.js)
<br>
---
<br>
<h2 id="GLOBAL_CONFIGURATION_PropertyResolution">Property Resolution</h2>
<br>
Aegis supports dynamic property resolution in rule parameters to make rules portable.
<br>
<h3><code class='inline-token'>${property.name}</code> Placeholders</h3>
<br>
You can use placeholders in rule values which Aegis will attempt to resolve against:
<br>
1. Project build descriptors (<code class='inline-token'>pom.xml</code>, <code class='inline-token'>package.json</code>, etc.).
2. System environment variables.
3. Custom scan-time variables provided via CLI or UI.
4. <strong>Linked Configuration Projects</strong>: (New) Resolve properties from a separate CONFIG project when using <code class='inline-token'>resolveLinkedConfig: true</code>.
<br>
<h3>Cross-Project Linking</h3>
Aegis automatically links projects when scanned together. If a project is identified as <code class='inline-token'>CODE</code> and another as <code class='inline-token'>CONFIG</code> within the same scan session, the <code class='inline-token'>CODE</code> project can "see" properties defined in the <code class='inline-token'>CONFIG</code> project's property files.
<br>
---
<br>
<h2 id="GLOBAL_CONFIGURATION_2CrossProjectResolutionFlags">2. Cross-Project Resolution Flags</h2>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> Resolves <code class='inline-token'>${...}</code> within the local project. </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> Resolves <code class='inline-token'>${...}</code> from the linked configuration project. </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> Includes linked configuration files in the current search. </td></tr></table>
<br>
---
<br>
---
<br>
<h2 id="GLOBAL_CONFIGURATION_BestPracticesGuidance">Best Practices & Guidance</h2>
<br>
<h3>1. Efficient "Existence" Checks</h3>
<br>
If you want to ensure your project has a specific component (like a global configuration file), don't check every file and fail if it's missing from any of them. Instead, use <code class='inline-token'>matchMode: ANY_FILE</code>.
<br>
<pre><code class='language-yaml'>- type: CODE_FILE_EXISTS
  params:
    filePatterns: [&quot;**/security-config.xml&quot;]
    matchMode: ANY_FILE  # Essential for existence checks!
</code></pre>
<br>
<h3>2. Combining Validations</h3>
<br>
When checking both the presence of a key and its specific value in property files, prefer specialized rules like <code class='inline-token'>MANDATORY_PROPERTY_VALUE_CHECK</code> which handle both logic paths more efficiently than standard substring searches.
<br>
<h3>3. Performance Optimization</h3>
<br>
<li>Prefer <strong>SUBSTRING</strong> over <strong>REGEX</strong> for static tokens. Regex engines are significantly more resource-intensive.</li>
<li>Scope your <strong>filePatterns</strong> as narrowly as possible. Avoid <code class='inline-token'>**/*</code> if the rule only applies to a single configuration file.</li>
<br>
<h3>4. Precision with XPath</h3>
<br>
For XML validation, always use <strong>XPath</strong> rules instead of <strong>Token Search</strong>. Token searches can be fooled by comments or complex formatting, whereas XPath understands the underlying document structure.
<br>
---
<br>
<h2 id="GLOBAL_CONFIGURATION_MessageCustomization">Message Customization</h2>
<br>
Aegis allows you to customize the success and error messages for each rule using placeholders. This allows you to provide context-specific feedback while still retaining the technical details of the check.
<br>
<h3>Supported Tokens</h3>
<br>
You can use the following tokens in your <code class='inline-token'>successMessage</code> and <code class='inline-token'>errorMessage</code> fields:
<br>
<table><tr><td> Token </td><td> Description </td></tr><tr><td> <code class='inline-token'>{RULE_ID}</code> </td><td> The ID of the rule being executed (e.g., <code class='inline-token'>RULE-001</code>). </td></tr><tr><td> <code class='inline-token'>{CORE_DETAILS}</code> </td><td> The technical details of the check result (e.g., "Found 3 issues in pom.xml"). </td></tr><tr><td> <code class='inline-token'>{DEFAULT_MESSAGE}</code> </td><td> <strong>Alias for <code class='inline-token'>{CORE_DETAILS}</code></strong>. Recommended for clarity. </td></tr><tr><td> <code class='inline-token'>{FAILURES}</code> </td><td> A list of specific failure details (if applicable). </td></tr><tr><td> <code class='inline-token'>{CHECKED_FILES}</code> </td><td> A comma-separated list of files that were scanned or passed the check. Useful for listing specific files in the report. </td></tr><tr><td> <code class='inline-token'>{FOUND_ITEMS}</code> </td><td> A comma-separated list of forbidden items (tokens, keys, attributes) that were found, causing the rule to fail. Supports <code class='inline-token'>XmlGenericCheck</code>, <code class='inline-token'>JsonGenericCheck</code>, and <code class='inline-token'>TokenSearchCheck</code>. </td></tr></table>
<br>
<h3>Newline Formatting</h3>
<br>
You can use <code class='inline-token'>\n</code> in your messages to create line breaks. This is useful for separating your custom message from the technical details.
<br>
<strong>Example:</strong>
<br>
<pre><code class='language-yaml'>successMessage: &quot;Validation passed!\n{DEFAULT_MESSAGE}&quot;
errorMessage: &quot;Validation failed.\n{DEFAULT_MESSAGE}&quot;
</code></pre>
<br>
<h3>Token Examples</h3>
<br>
You can use either <code class='inline-token'>{DEFAULT_MESSAGE}</code> or <code class='inline-token'>{CORE_DETAILS}</code>. They result in the exact same output.
<br>
<strong>Using <code class='inline-token'>{DEFAULT_MESSAGE}</code> (Recommended):</strong>
<br>
<pre><code class='language-yaml'>errorMessage: &quot;Validation failed.\n{DEFAULT_MESSAGE}&quot;
</code></pre>
<br>
<strong>Using <code class='inline-token'>{CORE_DETAILS}</code>:</strong>
<br>
<pre><code class='language-yaml'>errorMessage: &quot;Validation failed.\n{CORE_DETAILS}&quot;
</code></pre>
<br>
---
<br>
<h2 id="GLOBAL_CONFIGURATION_ProjectIdentification">Project Identification</h2>
<br>
Aegis uses specific rules to identify which folders contain valid projects to scan. This is configured in the <code class='inline-token'>projectIdentification</code> section of your main configuration file.
<br>
<h3>configFolder</h3>
<br>
Defines patterns to identify configuration projects (e.g., "global-config", "common-library"). These are scanned differently than standard Mule applications.
<br>
<li><strong>namePattern</strong>: Regex to match folder names (e.g., <code class='inline-token'>.*_config.*</code>).</li>
<br>
<h3>targetProject</h3>
<br>
Defines rules for identifying standard Mule applications.
<br>
<li><strong>matchMode</strong>:</li>
  - <code class='inline-token'>ALL</code>: All specified marker files must exist.
  - <code class='inline-token'>ANY</code>: At least one marker file must exist.
<li><strong>markerFiles</strong>: List of files that signify a project root (e.g., <code class='inline-token'>pom.xml</code>, <code class='inline-token'>mule-artifact.json</code>).</li>
<br>
<h3>ignoredFolders</h3>
<br>
Defines folders that are strictly excluded from scanning to improve performance and avoid false positives.
<br>
<li><strong>exactNames</strong>: List of folder names to ignore (e.g., <code class='inline-token'>target</code>, <code class='inline-token'>.git</code>, <code class='inline-token'>node_modules</code>).</li>
</div><div id="PROJECT_IDENTIFICATION" class="rule-content" style="display: none;"><h1>Project Identification</h1>
<br>
Aegis identifies projects to scan based on <strong>Marker Files</strong>. It does not semantically "auto-detect" technology types like Java or Python unless told what files signify the root of such a project.
<br>
<h2 id="PROJECT_IDENTIFICATION_Overview">Overview</h2>
<br>
When Aegis scans a directory, it looks for specific "markers" to decide if a folder should be treated as a project and subjected to the validation rules. This is controlled in the <code class='inline-token'>config</code> section of your <code class='inline-token'>rules.yaml</code>.
<br>
<h2 id="PROJECT_IDENTIFICATION_Configuration">Configuration</h2>
<br>
The <code class='inline-token'>projectIdentification</code> block in <code class='inline-token'>rules.yaml</code> defines these settings:
<br>
<pre><code class='language-yaml'>config:
  projectIdentification:
    targetProject:
      matchMode: ANY      # ANY or ALL
      markerFiles:        # Files that identify a project
      - pom.xml           # Signifies a Maven/Java project
      - package.json       # Signifies a Node.js project
      - requirements.txt  # Signifies a Python project
      - mule-artifact.json # Signifies a MuleSoft project
    configFolder:
      namePattern: .*_config.* # Pattern for identifying configuration projects
</code></pre>
<br>
<h3>Match Modes</h3>
<br>
<li><strong>ANY</strong>: A folder is considered a project if <strong>AT LEAST ONE</strong> of the marker files exists.</li>
<li><strong>ALL</strong>: A folder is considered a project ONLY if <strong>EVERY</strong> marker file in the list exists.</li>
<br>
<h2 id="PROJECT_IDENTIFICATION_ManagingMultipleTechnologies">Managing Multiple Technologies</h2>
<br>
Because Aegis is technology-agnostic, you can scan a mixed repository (e.g., containing both Java and Python services) by simply including markers for both:
<br>
1. <strong>Shared Scan</strong>: Add both <code class='inline-token'>pom.xml</code> and <code class='inline-token'>requirements.txt</code> to <code class='inline-token'>markerFiles</code>.
2. <strong>Targeted Rules</strong>: Use <code class='inline-token'>filePatterns</code> in your rules to ensure Java rules only run on Java files (<code class='inline-token'>**/*.java</code>) and Python rules only on Python files (<code class='inline-token'>**/*.py</code>).
<br>
<h2 id="PROJECT_IDENTIFICATION_BestPractices">Best Practices</h2>
<br>
<li><strong>Narrow the Markers</strong>: Only use files that truly represent the root of a project. Using a very common file like <code class='inline-token'>README.md</code> as a marker might cause Aegis to scan many folders that aren't actually code projects.</li>
<li><strong>Excluded Folders</strong>: Use the <code class='inline-token'>ignoredFolders</code> configuration to skip directories like <code class='inline-token'>node_modules</code>, <code class='inline-token'>target</code>, or <code class='inline-token'>.git</code> to speed up the discovery process.</li>
</div><div id="CROSS_PROJECT_RESOLUTION" class="rule-content" style="display: none;"><h1>Cross-Project Property Resolution</h1>
<br>
Aegis supports resolving property placeholders (<code class='inline-token'>${property}</code>) across different project types. This is essential when your source code (<code class='inline-token'>CODE</code>) references properties defined in a separate configuration project (<code class='inline-token'>CONFIG</code>).
<br>
<h2 id="CROSS_PROJECT_RESOLUTION_KeyParameters">Key Parameters</h2>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enables <code class='inline-token'>${...}</code> resolution within the local project. </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Fallback to searching in the <strong>linked CONFIG project</strong>. </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Also scan files within the linked project for the current check. </td></tr></table>
<br>
<h2 id="CROSS_PROJECT_RESOLUTION_HowitWorks">How it Works</h2>
<br>
1. <strong>Detection</strong>: Aegis identifies projects based on your <code class='inline-token'>config</code> section (e.g., folder names with <code class='inline-token'>_config</code> are identified as <code class='inline-token'>CONFIG</code>).
2. <strong>Linking</strong>: When multiple projects are scanned together, Aegis automatically links them if they form a CODE-CONFIG pair.
3. <strong>Resolution</strong>:
   - If <code class='inline-token'>resolveProperties: true</code>, Aegis looks for values in the project's own property files.
   - If <code class='inline-token'>resolveLinkedConfig: true</code> and the property isn't found locally, Aegis queries the linked <code class='inline-token'>CONFIG</code> project.
<br>
<h2 id="CROSS_PROJECT_RESOLUTION_Examples">Examples</h2>
<br>
<h3>1. Database Connection String Security</h3>
Ensure that SQL Server connection strings in your Mule application reference properties defined in your global configuration.
<br>
<pre><code class='language-yaml'>- id: &quot;BANK-021&quot;
  name: &quot;Enforce SQL Server DB connection String Security&quot;
  appliesTo: [&quot;CODE&quot;, &quot;CONFIG&quot;]
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: [&quot;src/main/mule/*.xml&quot;]
        tokens: [&quot;${sql.db.url}&quot;]
        resolveProperties: true
        resolveLinkedConfig: true
        includeLinkedConfig: true
</code></pre>
<br>
<h3>2. Secure Property Format</h3>
Validate that secure properties (prefixed with <code class='inline-token'>secure::</code>) are correctly defined in your configuration files while being referenced in your source code.
<br>
<pre><code class='language-yaml'>- id: &quot;Secure::Property-001&quot;
  name: &quot;Validate Secure Property Format&quot;
  appliesTo: [&quot;CODE&quot;, &quot;CONFIG&quot;]
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: [&quot;src/main/resources/*.properties&quot;, &quot;src/main/mule/*.xml&quot;]
        tokens: [&quot;\\$\\{secure::.*\\}&quot;]
        isRegex: true
        resolveProperties: true
        resolveLinkedConfig: true
        includeLinkedConfig: true
</code></pre>
<br>
<h2 id="CROSS_PROJECT_RESOLUTION_ReportVisualization">Report Visualization</h2>
<br>
When a property is resolved from a linked configuration project, it is highlighted in the Aegis report with a <strong>CONFIG -</strong> label, making it easy to identify the source of the value.
<br>
> [!TIP]
> Use the <code class='inline-token'>{PROPERTY_RESOLVED}</code> token in your success/error messages to display the resolution path.
</div><div id="FILE_EXISTS" class="rule-content" style="display: none;"><h1>FILE_EXISTS</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> </td><td> <strong>Trigger Engine</strong>
<br>
<h2 id="FILE_EXISTS_Overview">Overview</h2>
<br>
A trigger that checks for the presence of one or more files in the project. It is typically used within a <code class='inline-token'>CONDITIONAL_CHECK</code> to ensure specific templates, security files, or configuration assets exist. This rule helps enforce project structure standards across different technologies.
<br>
<h2 id="FILE_EXISTS_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List </td><td> Glob patterns to search for files (e.g., <code class='inline-token'>src/resources/secure-*.properties</code>) </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>failureMessage</code> </td><td> String </td><td> (Default) </td><td> Custom message if expected files are not found </td></tr></table>
<br>
<h2 id="FILE_EXISTS_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Mandatory Security Documentation</h3>
<br>
Ensures that any project must have a <code class='inline-token'>SECURITY.md</code> file in the root directory.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-FILE-SECURITY&quot;
  name: &quot;Mandatory Security Documentation&quot;
  description: &quot;Ensures every project contains a security policy file&quot;
  enabled: true
  severity: HIGH
  checks:
    - type: FILE_EXISTS
      params:
        filePatterns: [&quot;SECURITY.md&quot;]
        failureMessage: &quot;Project missing mandatory SECURITY.md file in root&quot;
</code></pre>
<br>
<h3>Example 2: API Specification Trigger</h3>
<br>
Ensures that an API specification file (RAML, OAS, or Swagger) exists in the expected directory for projects tagged as APIs.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-API-SPEC-EXISTS&quot;
  checks:
    - type: CONDITIONAL_CHECK
      params:
        preconditions:
          - type: PROJECT_CONTEXT
            params: { nameContains: &quot;-api-&quot; }
        onSuccess:
          - type: FILE_EXISTS
            params:
              filePatterns: 
                - &quot;src/main/resources/api/*.raml&quot;
                - &quot;src/main/resources/api/*.yaml&quot;
                - &quot;src/main/resources/api/*.json&quot;
              failureMessage: &quot;API project missing specification file in src/main/resources/api/&quot;
</code></pre>
<br>
<h2 id="FILE_EXISTS_BestPractices">Best Practices</h2>
<br>
<li><strong>Use as a Precondition</strong>: detect "legacy" projects (e.g., presence of old framework files) to apply specific migration or compatibility rules.</li>
<li><strong>Enforce Readme/Security</strong>: Use <strong>FILE_EXISTS</strong> as an <code class='inline-token'>onSuccess</code> check to ensure standard documentation is always present.</li>
<li><strong>Technology Detection</strong>: Combine with <strong><a href="#" onclick="showRule(event, 'PROJECT_CONTEXT')">PROJECT_CONTEXT</a></strong> to target specific file requirements for specific project types.</li>
<br>
<h2 id="FILE_EXISTS_RelatedCheckTypes">Related Check Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'PROJECT_CONTEXT')">PROJECT_CONTEXT</a></strong>: Trigger based on project metadata or folder names.</li>
<br>
<h2 id="FILE_EXISTS_SolutionPatternsandTechnologyReferences">Solution Patterns and Technology References</h2>
<br>
The following table serves as a quick reference for enforcing file existence across various project types.
<br>
<table><tr><td> Technology </td><td> Best Practice Goal </td><td> Key Files Checked </td><td> Purpose </td></tr><tr><td> <strong>‚òï Java/Maven</strong> </td><td> Build Consistency </td><td> <code class='inline-token'>pom.xml</code> </td><td> Dependency management </td></tr><tr><td> <strong>üì¶ Node.js</strong> </td><td> Project Metadata </td><td> <code class='inline-token'>package.json</code> </td><td> Scripts and dependencies </td></tr><tr><td> <strong>üêé MuleSoft 4</strong> </td><td> Project Structure </td><td> <code class='inline-token'>mule-artifact.json</code> </td><td> Core runtime configuration </td></tr><tr><td> <strong>üêç Python</strong> </td><td> Environment Setup </td><td> <code class='inline-token'>requirements.txt</code> </td><td> Package dependencies </td></tr><tr><td> <strong>‚ö° TIBCO BW</strong> </td><td> Module Validity </td><td> <code class='inline-token'>*.module</code>, <code class='inline-token'>MANIFEST.MF</code> </td><td> OSGi/Module configuration </td></tr><tr><td> <strong>üê≥ Docker</strong> </td><td> Containerization </td><td> <code class='inline-token'>Dockerfile</code> </td><td> Image build definition </td></tr></table>
<br>
<h3>‚òï Java / Spring Boot Patterns</h3>
<br>
Ensure that Maven or Gradle build files are present to guarantee the project can be built in CI/CD.
<br>
<pre><code class='language-yaml'>id: &quot;JAVA-BUILD-DESCRIPTOR&quot;
name: &quot;Require Build Descriptor&quot;
checks:
  - type: FILE_EXISTS
    params:
      filePatterns: [&quot;pom.xml&quot;, &quot;build.gradle&quot;, &quot;build.gradle.kts&quot;]
      failureMessage: &quot;Java projects must have a pom.xml or build.gradle file&quot;
</code></pre>
<br>
<h3>üì¶ Node.js Patterns</h3>
<br>
The <code class='inline-token'>package.json</code> file is the heart of any Node.js application.
<br>
<pre><code class='language-yaml'>id: &quot;NODE-PACKAGE-JSON&quot;
name: &quot;Require Package.json&quot;
checks:
  - type: FILE_EXISTS
    params:
      filePatterns: [&quot;package.json&quot;]
      failureMessage: &quot;Node.js projects must contain a package.json file&quot;
</code></pre>
<br>
<h3>üê≥ DevOps / Docker Patterns</h3>
<br>
For projects intended for containerization, a <code class='inline-token'>Dockerfile</code> is essential.
<br>
<pre><code class='language-yaml'>id: &quot;DOCKER-FILE-REQUIRED&quot;
name: &quot;Require Dockerfile&quot;
checks:
  - type: FILE_EXISTS
    params:
      filePatterns: [&quot;Dockerfile&quot;, &quot;docker-compose.yml&quot;]
</code></pre>
</div><div id="GENERIC_TOKEN_SEARCH" class="rule-content" style="display: none;"><h1>GENERIC_TOKEN_SEARCH</h1>
<br>
<strong>Primary Capacity:</strong> Universal Pattern & Token Engine </td><td> <strong>Validation Target:</strong> Any Text-Based File (Scripts, XML, Java, YAML)
<br>
<h2 id="GENERIC_TOKEN_SEARCH_Overview">Overview</h2>
<br>
Advanced token search with <strong>environment filtering</strong> and <strong>regex support</strong>. This rule acts as a versatile engine that can operate in both <code class='inline-token'>REQUIRED</code> and <code class='inline-token'>FORBIDDEN</code> modes, with additional awareness of target environments. It is the core engine behind more specialized substring and token checks.
<br>
<h2 id="GENERIC_TOKEN_SEARCH_UseCases">Use Cases</h2>
<br>
<li>Detect environment-specific anti-patterns (e.g., "localhost" in Production).</li>
<li>Enforce mandatory headers or license blocks in source files.</li>
<li>Validate configuration compliance across different build stages.</li>
<li>Target specific XML element attributes or plain text strings.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List </td><td> Glob patterns to match source or configuration files </td></tr><tr><td> <code class='inline-token'>tokens</code> </td><td> List </td><td> List of tokens or patterns to search for </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>environments</code> </td><td> List </td><td> N/A </td><td> Filter files by environment keys (e.g., <code class='inline-token'>PROD</code>, <code class='inline-token'>QA</code>) </td></tr><tr><td> <code class='inline-token'>searchMode</code> </td><td> String </td><td> <code class='inline-token'>FORBIDDEN</code> </td><td> Choose <code class='inline-token'>REQUIRED</code> or <code class='inline-token'>FORBIDDEN</code> </td></tr><tr><td> <code class='inline-token'>matchMode</code> </td><td> String </td><td> <code class='inline-token'>SUBSTRING</code> </td><td> Choose <code class='inline-token'>SUBSTRING</code>, <code class='inline-token'>REGEX</code>, or <code class='inline-token'>ELEMENT_ATTRIBUTE</code>. Setting to <code class='inline-token'>REGEX</code> automatically enables regex matching. </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Whether token matching is case-sensitive </td></tr><tr><td> <code class='inline-token'>wholeWord</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> If <code class='inline-token'>true</code>, ensures exact word matching (wraps tokens in <code class='inline-token'>\b</code>). Ignored if <code class='inline-token'>matchMode: REGEX</code>. </td></tr><tr><td> <code class='inline-token'>message</code> </td><td> String </td><td> (Default) </td><td> Custom message to display on failure </td></tr><tr><td> <code class='inline-token'>elementName</code> </td><td> String </td><td> N/A </td><td> For XML element-specific attribute searches </td></tr></table>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Environment-Specific Policy</h3>
<br>
Ensure that production configurations do not contain references to local development servers.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-PROD-NO-LOCALHOST&quot;
  name: &quot;No Localhost in Production&quot;
  severity: CRITICAL
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: [&quot;*.properties&quot;, &quot;*.yaml&quot;]
        environments: [&quot;PROD&quot;]
        tokens: [&quot;localhost&quot;, &quot;127.0.0.1&quot;]
        searchMode: FORBIDDEN
</code></pre>
<br>
<h3>Example 2: Detect IP Addresses</h3>
<br>
Identify hardcoded IP addresses in configuration files for higher environments.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-NOMADIC-IP-CHECK&quot;
  name: &quot;IP Address Detection&quot;
  severity: HIGH
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: [&quot;config/*.yaml&quot;]
        environments: [&quot;QA&quot;, &quot;PROD&quot;]
        tokens: [&quot;\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b&quot;]
        matchMode: REGEX
        searchMode: FORBIDDEN
</code></pre>
<br>
<h3>Example 3: Mandatory Cloud Metadata</h3>
<br>
Ensure all property files in any environment contain a specific metadata reference.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-MANDATORY-CLOUDFLARE&quot;
  name: &quot;Cloud Providers Metadata&quot;
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: [&quot;**/*.properties&quot;]
        environments: [&quot;ALL&quot;]
        tokens: [&quot;${cloud.provider}&quot;, &quot;${region.id}&quot;]
        searchMode: REQUIRED
</code></pre>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_ErrorConfigurationCustomization">Error Configuration & Customization</h2>
<br>
By default, Aegis generates a technical description of the failure. You can override this by providing a custom <code class='inline-token'>message</code> parameter in your rule configuration.
<br>
<pre><code class='language-yaml'>      params:
        tokens: [&quot;localhost&quot;]
        searchMode: FORBIDDEN
        message: &quot;Critical violation: Hardcoded localhost reference found in production config!&quot;
</code></pre>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_BestPractices">Best Practices</h2>
<br>
<li><strong>Filter by Environment</strong>: Use the <code class='inline-token'>environments</code> parameter to avoid noise in development or test configurations while keeping production strictly compliant.</li>
<li><strong>Regex for Complexity</strong>: Use <code class='inline-token'>matchMode: REGEX</code> to search for patterns rather than literal strings (e.g., version formats, ID patterns).</li>
<li><strong>Mode Clarity</strong>: Clearly label whether a rule is for blocking (<code class='inline-token'>FORBIDDEN</code>) or enforcing (<code class='inline-token'>REQUIRED</code>) to make failure messages intuitive.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED')">GENERIC_TOKEN_SEARCH_REQUIRED</a></strong> - Simplified mandatory token check.</li>
<li><strong><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN')">GENERIC_TOKEN_SEARCH_FORBIDDEN</a></strong> - Simplified forbidden token check.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_SolutionPatternsandTechnologyReference">Solution Patterns and Technology Reference</h2>
<br>
Standard configurations for validating multi-technology stacks.
<br>
<table><tr><td> Technology </td><td> Scenario </td><td> Search Mode </td><td> Target File </td></tr><tr><td> <strong>‚òï Java</strong> </td><td> Block <code class='inline-token'>System.out</code> </td><td> <code class='inline-token'>FORBIDDEN</code> </td><td> <code class='inline-token'>*.java</code> </td></tr><tr><td> <strong>üêç Python</strong> </td><td> Block <code class='inline-token'>print()</code> </td><td> <code class='inline-token'>FORBIDDEN</code> </td><td> <code class='inline-token'>*.py</code> </td></tr><tr><td> <strong>üì¶ Node.js</strong> </td><td> Block <code class='inline-token'>console.log</code> </td><td> <code class='inline-token'>FORBIDDEN</code> </td><td> <code class='inline-token'>*.js</code> </td></tr><tr><td> <strong>üê≥ Docker</strong> </td><td> Require standard base image </td><td> <code class='inline-token'>REQUIRED</code> </td><td> <code class='inline-token'>Dockerfile</code> </td></tr><tr><td> <strong>üêé MuleSoft</strong> </td><td> Block non-persistent stores </td><td> <code class='inline-token'>FORBIDDEN</code> </td><td> <code class='inline-token'>*.xml</code> </td></tr></table>
<br>
<h3>‚òï Java Patterns</h3>
<br>
Enterprise standards for logging and output management.
<br>
<pre><code class='language-yaml'>- id: &quot;JAVA-LOG-CLEAN&quot;
  name: &quot;No System.out Usage&quot;
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: [&quot;src/**/*.java&quot;]
        tokens: [&quot;System.out.print&quot;, &quot;System.err.print&quot;]
        searchMode: FORBIDDEN
</code></pre>
<br>
<h3>üêç Python Patterns</h3>
<br>
Ensuring logging standards in production scripts.
<br>
<pre><code class='language-yaml'>- id: &quot;PY-LOG-ENFORCEMENT&quot;
  name: &quot;No Print Statements&quot;
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: [&quot;*.py&quot;]
        tokens: [&quot;print(&quot;]
        searchMode: FORBIDDEN
</code></pre>
</div><div id="GENERIC_TOKEN_SEARCH_FORBIDDEN" class="rule-content" style="display: none;"><h1>GENERIC_TOKEN_SEARCH_FORBIDDEN</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> Any text-based source files
<br>
<h2 id="GENERIC_TOKEN_SEARCH_FORBIDDEN_Overview">Overview</h2>
<br>
Validates that <strong>forbidden tokens or patterns do NOT exist</strong> in files matching specified patterns. This rule <strong>fails</strong> if any of the specified forbidden tokens are <strong>found</strong> within the file content. It is a powerful tool for blocking deprecated functions, hardcoded credentials, and unsafe coding patterns.
<br>
<h2 id="GENERIC_TOKEN_SEARCH_FORBIDDEN_UseCases">Use Cases</h2>
<br>
<li>Prevent usage of deprecated APIs, legacy functions, or insecure libraries.</li>
<li>Block hardcoded credentials (passwords, API keys, secrets) in source and config files.</li>
<li>Disallow specific imports or dependencies that violate architectural standards.</li>
<li>Enforce cleanup of debug code, temporary comments, or test-only artifacts in production.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_FORBIDDEN_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List </td><td> Glob patterns to match source or configuration files </td></tr><tr><td> <code class='inline-token'>tokens</code> </td><td> List </td><td> List of tokens that must NOT be found in the files </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>excludePatterns</code> </td><td> List </td><td> <code class='inline-token'>[]</code> </td><td> Glob patterns to exclude specific files </td></tr><tr><td> <code class='inline-token'>matchMode</code> </td><td> String </td><td> <code class='inline-token'>SUBSTRING</code> </td><td> Choose <code class='inline-token'>SUBSTRING</code> or <code class='inline-token'>REGEX</code>. Setting to <code class='inline-token'>REGEX</code> automatically enables regex matching. </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Whether token matching is case-sensitive </td></tr><tr><td> <code class='inline-token'>wholeWord</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> If <code class='inline-token'>true</code>, ensures exact word matching (wraps tokens in <code class='inline-token'>\b</code>). Ignored if <code class='inline-token'>matchMode: REGEX</code>. </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr><tr><td> <strong><code class='inline-token'>ignoreComments</code></strong> </td><td> <strong>Boolean</strong> </td><td> <strong><code class='inline-token'>false</code></strong> </td><td> <strong>If <code class='inline-token'>true</code>, removes comments before searching (strict mode). Recommended for FORBIDDEN rules to avoid false positives.</strong> </td></tr></table>
<br>
<h3>üéØ Comment Handling (<code class='inline-token'>ignoreComments</code>)</h3>
<br>
<strong>NEW FEATURE:</strong> The <code class='inline-token'>ignoreComments</code> parameter allows you to choose between <strong>strict mode</strong> (comments ignored) and <strong>normal mode</strong> (comments included).
<br>
<h4>Why This Matters</h4>
<br>
By default, token searches include commented code, which can cause <strong>false positives</strong> for FORBIDDEN rules:
<br>
<pre><code class='language-xml'>&lt;!-- &lt;logger level=&quot;DEBUG&quot; /&gt; --&gt;  ‚ùå FALSE POSITIVE without ignoreComments
&lt;logger level=&quot;INFO&quot; /&gt;             ‚úÖ This should be checked
</code></pre>
<br>
<h4>Supported File Types</h4>
<br>
<table><tr><td> File Type </td><td> Extensions </td><td> Comment Syntax </td><td> Single-Line </td><td> Multi-Line Block </td></tr><tr><td> <strong>XML</strong> </td><td> <code class='inline-token'>.xml</code>, <code class='inline-token'>.process</code>, <code class='inline-token'>.bwp</code> </td><td> <code class='inline-token'>&lt;!-- --&gt;</code> </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>Java</strong> </td><td> <code class='inline-token'>.java</code> </td><td> <code class='inline-token'>//</code>, <code class='inline-token'>/* */</code> </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>Groovy</strong> </td><td> <code class='inline-token'>.groovy</code> </td><td> <code class='inline-token'>//</code>, <code class='inline-token'>/* */</code> </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>DataWeave</strong> </td><td> <code class='inline-token'>.dwl</code> </td><td> <code class='inline-token'>//</code>, <code class='inline-token'>/* */</code> </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>JavaScript</strong> </td><td> <code class='inline-token'>.js</code> </td><td> <code class='inline-token'>//</code>, <code class='inline-token'>/* */</code> </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>JSON</strong> </td><td> <code class='inline-token'>.json</code> </td><td> <code class='inline-token'>//</code>, <code class='inline-token'>/* */</code> (non-standard) </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>Properties</strong> </td><td> <code class='inline-token'>.properties</code>, <code class='inline-token'>.substvar</code> </td><td> <code class='inline-token'>#</code>, <code class='inline-token'>!</code> (line start only) </td><td> ‚úÖ </td><td> ‚ùå </td></tr><tr><td> <strong>YAML</strong> </td><td> <code class='inline-token'>.yaml</code>, <code class='inline-token'>.yml</code> </td><td> <code class='inline-token'>#</code> (inline supported) </td><td> ‚úÖ </td><td> ‚ùå </td></tr><tr><td> <strong>SQL</strong> </td><td> <code class='inline-token'>.sql</code> </td><td> <code class='inline-token'>--</code>, <code class='inline-token'>#</code>, <code class='inline-token'>/* */</code> </td><td> ‚úÖ </td><td> ‚úÖ </td></tr><tr><td> <strong>Shell</strong> </td><td> <code class='inline-token'>.sh</code>, <code class='inline-token'>.bash</code> </td><td> <code class='inline-token'>#</code> </td><td> ‚úÖ </td><td> ‚ùå </td></tr></table>
<br>
<h4>When to Use</h4>
<br>
<li><strong>FORBIDDEN Rules:</strong> ‚úÖ <strong>Always use <code class='inline-token'>ignoreComments: true</code></strong> to avoid false positives</li>
<li><strong>REQUIRED Rules:</strong> ‚ö†Ô∏è Use <code class='inline-token'>ignoreComments: false</code> (default) to check documentation</li>
<li><strong>Documentation Files:</strong> ‚ö†Ô∏è Use <code class='inline-token'>ignoreComments: false</code> to ensure content exists</li>
<br>
<h4>Example: Strict Mode (Recommended)</h4>
<br>
<pre><code class='language-yaml'>- id: &quot;BANK-002&quot;
  name: &quot;Forbid Legacy Logger Attributes&quot;
  type: &quot;CODE_GENERIC_TOKEN_SEARCH_FORBIDDEN&quot;
  severity: &quot;HIGH&quot;
  checks:
    - type: &quot;TOKEN_SEARCH&quot;
      params:
        filePatterns: [&quot;**/*.xml&quot;]
        tokens: [&quot;toApplicationCode&quot;, &quot;DEBUG&quot;]
        ignoreComments: true  # ‚úÖ Strict mode - ignore commented code
</code></pre>
<br>
<strong>Test Case:</strong>
<pre><code class='language-xml'>&lt;!-- &lt;logger level=&quot;DEBUG&quot; /&gt; --&gt;  ‚úÖ IGNORED (in comment)
&lt;logger level=&quot;INFO&quot; /&gt;             ‚úÖ CHECKED (active code)
</code></pre>
<strong>Result:</strong> PASS ‚úÖ (no forbidden tokens in active code)
<br>
<h4>Example: Normal Mode</h4>
<br>
<pre><code class='language-yaml'>- id: &quot;DOC-001&quot;
  name: &quot;Ensure Documentation Mentions Feature&quot;
  type: &quot;CODE_GENERIC_TOKEN_SEARCH_REQUIRED&quot;
  checks:
    - type: &quot;TOKEN_SEARCH&quot;
      params:
        filePatterns: [&quot;**/*.md&quot;, &quot;**/*.txt&quot;]
        tokens: [&quot;authentication&quot;]
        ignoreComments: false  # ‚úÖ Check everywhere including comments
</code></pre>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_FORBIDDEN_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Block Deprecated Global Functions</h3>
<br>
Prevent the usage of a deprecated transformation function across all scripts.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-DEPRECATED-TRANSFORM&quot;
  name: &quot;No Legacy Transformations&quot;
  severity: HIGH
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns: [&quot;**/*.dwl&quot;, &quot;**/*.js&quot;]
        tokens: [&quot;toBase64Legacy()&quot;, &quot;oldEncrypt()&quot;]
</code></pre>
<br>
<h3>Example 2: Block Hardcoded Credentials</h3>
<br>
Identify potential hardcoded secrets in properties or XML configuration files.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-NO-HARDCODED-SECRETS&quot;
  name: &quot;No Hardcoded Credentials&quot;
  severity: CRITICAL
  errorMessage: &quot;Security Violation: Hardcoded credentials found.\n{DEFAULT_MESSAGE}&quot;
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns: [&quot;**/*.xml&quot;, &quot;**/*.properties&quot;, &quot;**/*.yaml&quot;]
        tokens: [&quot;password=&quot;, &quot;pwd=&quot;, &quot;aws_secret=&quot;]
        caseSensitive: false

### Example 3: Exact Word Match (Whole Word)
Prevent false positives by ensuring only exact words are matched (e.g., match &quot;admin&quot; but not &quot;administrator&quot;).

</code></pre>yaml
<li>id: "RULE-EXACT-WORD"</li>
  name: "Forbid 'admin' User"
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns: ["**/*.properties"]
        tokens: ["admin"]
        wholeWord: true  # Matches 'admin' but not 'administrator'
<pre><code class='language-text'>
### Example 3: Detect IP Addresses (Regex)
Block hardcoded IP addresses in source code directory to enforce hostname usage.

</code></pre>yaml
<li>id: "RULE-HOSTNAME-ENFORCEMENT"</li>
  name: "No Hardcoded IP Addresses"
  severity: HIGH
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns: ["src/<strong>/*.java", "src/</strong>/*.py"]
        excludePatterns: ["<strong>/test/</strong>"]
        tokens: ["\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b"]
        matchMode: REGEX
<pre><code class='language-text'>
&lt;h2 id=&quot;GENERIC_TOKEN_SEARCH_FORBIDDEN_ErrorMessages&quot;&gt;Error Messages&lt;/h2&gt;

</code></pre>text
AuthService.java: Forbidden token found: password=
legacy-script.js: Forbidden token found: toBase64Legacy()
DatabaseConfig.xml: Forbidden IP pattern found: 192.168.1.1
<pre><code class='language-text'>
&lt;h2 id=&quot;GENERIC_TOKEN_SEARCH_FORBIDDEN_BestPractices&quot;&gt;Best Practices&lt;/h2&gt;

- **Case Sensitivity**: Set `caseSensitive: false` when blocking configuration keys (like `PWD=`) to catch variants like `pwd=` or `Pwd=`.
- **Targeted Exclusions**: Use `excludePatterns` for third-party libraries or internal test suites where forbidden patterns might be legitimate for testing purposes.
- **Whole Word Matching**: Use `wholeWord: true` instead of complex Regex `\b` patterns for simple exact word matching.
- **Regex Guardrails**: When using REGEX, ensure patterns are specific to avoid false positives (e.g., use word boundaries `\\b`).

&lt;h2 id=&quot;GENERIC_TOKEN_SEARCH_FORBIDDEN_RelatedRuleTypes&quot;&gt;Related Rule Types&lt;/h2&gt;

- **[GENERIC_TOKEN_SEARCH_REQUIRED](GENERIC_TOKEN_SEARCH_REQUIRED.md)** - Opposite: ensures tokens DO exist.
- **[XML_XPATH_NOT_EXISTS](XML_XPATH_NOT_EXISTS.md)** - Precise blocking of XML structures.

&lt;h2 id=&quot;GENERIC_TOKEN_SEARCH_FORBIDDEN_SolutionPatternsandTechnologyReference&quot;&gt;Solution Patterns and Technology Reference&lt;/h2&gt;

Standard configurations for blocking anti-patterns.

| Technology | Scenario | Mode | Target File |
| :--- | :--- | :--- | :--- |
| **‚òï Java** | Block `System.out` | `FORBIDDEN` | `**/*.java` |
| **üêç Python** | Block Debugger | `FORBIDDEN` | `**/*.py` |
| **üì¶ Node.js** | Block `eval()` | `FORBIDDEN` | `**/*.js` |
| **üêé MuleSoft** | Block legacy MEL | `FORBIDDEN` | `**/*.xml` |

### ‚òï Java / Spring Boot Patterns

Prevent developers from using standard output streams for logging.

</code></pre>yaml
<li>id: "JAVA-LOGGING-STANDARDS"</li>
  name: "No System.out"
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns: ["**/*.java"]
        tokens: ["System.out.println", "System.err.println"]
<pre><code class='language-text'>
### üêé MuleSoft Patterns

Block legacy Mule Expression Language (MEL) patterns in modern projects.

</code></pre>yaml
<li>id: "MULE-MODERNIZATION"</li>
  name: "No Legacy MEL"
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns: ["**/*.xml"]
        tokens: ["message.inboundProperties", "message.outboundProperties"]
```
</div><div id="GENERIC_TOKEN_SEARCH_REQUIRED" class="rule-content" style="display: none;"><h1>GENERIC_TOKEN_SEARCH_REQUIRED</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> Any text-based source files
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_Overview">Overview</h2>
<br>
Validates that <strong>required tokens or patterns exist</strong> in files matching specified patterns. This rule <strong>fails</strong> if any of the required tokens are <strong>NOT found</strong>. It is ideal for enforcing mandatory boilerplate, specific imports, or standard configuration keys across different frameworks.
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_UseCases">Use Cases</h2>
<br>
<li>Ensure specific imports or modules are present in source files.</li>
<li>Verify that required configuration keys or property placeholders exist.</li>
<li>Validate the presence of mandatory legal headers, author tags, or security annotations.</li>
<li>Check for required framework-specific metadata files or structures.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List </td><td> Glob patterns to match source or configuration files </td></tr><tr><td> <code class='inline-token'>tokens</code> </td><td> List </td><td> List of tokens that must be found in the files </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>excludePatterns</code> </td><td> List </td><td> <code class='inline-token'>[]</code> </td><td> Glob patterns to exclude specific files </td></tr><tr><td> <code class='inline-token'>matchMode</code> </td><td> String </td><td> <code class='inline-token'>SUBSTRING</code> </td><td> Choose <code class='inline-token'>SUBSTRING</code> or <code class='inline-token'>REGEX</code>. Setting to <code class='inline-token'>REGEX</code> automatically enables regex matching. </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Whether token matching is case-sensitive </td></tr><tr><td> <code class='inline-token'>wholeWord</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> If <code class='inline-token'>true</code>, ensures exact word matching (wraps tokens in <code class='inline-token'>\b</code>). Ignored if <code class='inline-token'>matchMode: REGEX</code>. </td></tr><tr><td> <code class='inline-token'>requireAll</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> If <code class='inline-token'>true</code>, ALL tokens must be found. If <code class='inline-token'>false</code>, at least ONE </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> If <code class='inline-token'>true</code>, resolves properties from the linked configuration project as a fallback. </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> If <code class='inline-token'>true</code>, scans files in BOTH the target project and the linked configuration project. </td></tr></table>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Required Framework Import</h3>
<br>
Ensure that all implementation files in a project contain the necessary framework imports for logging.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-JAVA-REQD-LOGGER&quot;
  name: &quot;Required Logger Import&quot;
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: [&quot;src/**/*.java&quot;]
        tokens: [&quot;import org.slf4j.Logger&quot;, &quot;import org.slf4j.LoggerFactory&quot;]
        requireAll: true
</code></pre>
<br>
<h3>Example 2: Mandatory Error Handling Pattern</h3>
<br>
Ensure that application configuration files contain mandatory error handling blocks (either "continue" or "propagate" strategies).
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-CONFIG-ERROR-POLICY&quot;
  name: &quot;Required Error Handling&quot;
  severity: HIGH
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: [&quot;src/main/resources/*.xml&quot;]
        tokens: [&quot;on-error-continue&quot;, &quot;on-error-propagate&quot;]
        requireAll: false  # At least one must exist
</code></pre>
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-VERSION-SEMVER&quot;
  name: &quot;Required SemVer Descriptor&quot;
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: [&quot;**/pom.xml&quot;, &quot;**/package.json&quot;]
        tokens: [&quot;\\d+\\.\\d+\\.\\d+&quot;]
        matchMode: REGEX
</code></pre>
<br>
<h3>Example 4: Cross-Project Validation (New)</h3>
<br>
Validate that a property defined in the linked configuration project is correctly referenced in the source code.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-CROSS-CONFIG-VALIDATION&quot;
  name: &quot;Linked Config Property Validation&quot;
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: [&quot;src/main/mule/*.xml&quot;]
        tokens: [&quot;${secure.key}&quot;]
        resolveProperties: true
        resolveLinkedConfig: true     # Resolves from linked project if not found in current
        includeLinkedConfig: true      # Also scans files in the linked project
</code></pre>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>DatabaseConfig.java: Missing required token: import org.slf4j.Logger
app-descriptor.xml: Missing at least one required token: [on-error-continue, on-error-propagate]
</code></pre>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_BestPractices">Best Practices</h2>
<br>
<li><strong>Broad File Patterns</strong>: Use this rule at a high level to ensure that *every* file of a certain type adheres to structural requirements (like license headers).</li>
<li><strong>Combine with Exclusion</strong>: Use <code class='inline-token'>excludePatterns</code> to skip generated code, third-party libraries, or test files where these rules might not apply.</li>
<li><strong>Fail on Composition</strong>: This rule is most effective when used to ensure that cross-cutting concerns (logging, security, error handling) are at least *present* in the codebase.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN')">GENERIC_TOKEN_SEARCH_FORBIDDEN</a></strong> - Opposite: ensures tokens do NOT exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></strong> - More precise XML validation using structural paths.</li>
<br>
<h2 id="GENERIC_TOKEN_SEARCH_REQUIRED_SolutionPatternsandTechnologyReference">Solution Patterns and Technology Reference</h2>
<br>
Standard configurations for enforcing mandatory components.
<br>
<table><tr><td> Technology </td><td> Requirement </td><td> Mode </td><td> Target File </td></tr><tr><td> <strong>‚òï Java</strong> </td><td> Security Annotations </td><td> <code class='inline-token'>REQUIRED</code> </td><td> <code class='inline-token'>*Controller.java</code> </td></tr><tr><td> <strong>üêç Python</strong> </td><td> Shebang Reference </td><td> <code class='inline-token'>REQUIRED</code> </td><td> <code class='inline-token'>*.py</code> </td></tr><tr><td> <strong>üì¶ Node.js</strong> </td><td> Module Exports </td><td> <code class='inline-token'>REQUIRED</code> </td><td> <code class='inline-token'>*.js</code> </td></tr><tr><td> <strong>üêé MuleSoft</strong> </td><td> DataWeave Version </td><td> <code class='inline-token'>REQUIRED</code> </td><td> <code class='inline-token'>*.dwl</code> </td></tr></table>
<br>
<h3>‚òï Java / Spring Boot Patterns</h3>
<br>
Ensure controllers have standard security annotations.
<br>
<pre><code class='language-yaml'>- id: &quot;JAVA-SECURE-CONTROLLER&quot;
  name: &quot;Secure Controllers&quot;
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: [&quot;**/*Controller.java&quot;]
        tokens: [&quot;@PreAuthorize&quot;, &quot;@Secured&quot;]
        requireAll: false
</code></pre>
<br>
<h3>üêç Python Patterns</h3>
<br>
Ensure scripts specify the required python version via shebang.
<br>
<pre><code class='language-yaml'>- id: &quot;PY-MIN-VERSION&quot;
  name: &quot;Python 3 Shebang&quot;
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns: [&quot;*.py&quot;]
        tokens: [&quot;#!/usr/bin/env python3&quot;]
</code></pre>
</div><div id="JSON_VALIDATION_FORBIDDEN" class="rule-content" style="display: none;"><h1>JSON_VALIDATION_FORBIDDEN</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> JSON configuration files (package.json, config.json, etc.)
<br>
<h2 id="JSON_VALIDATION_FORBIDDEN_Overview">Overview</h2>
<br>
Validates that <strong>forbidden JSON elements do NOT exist</strong> in JSON files. This rule <strong>fails</strong> if forbidden elements <strong>ARE found</strong>. It is useful for blocking deprecated fields, insecure settings, or unapproved metadata.
<br>
<h2 id="JSON_VALIDATION_FORBIDDEN_UseCases">Use Cases</h2>
<br>
<li>Prevent usage of deprecated configuration keys in project descriptors.</li>
<li>Block sensitive data fields (e.g., <code class='inline-token'>password</code>, <code class='inline-token'>secret</code>) in configuration JSON.</li>
<li>Disallow certain unapproved metadata or development-only flags in production JSON.</li>
<li>Enforce strict JSON structure by restricting specific keys.</li>
<br>
<h3>Global Settings (Optional)</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePattern</code> </td><td> String </td><td> Filename pattern to match (e.g., <code class='inline-token'>mule-artifact.json</code>, <code class='inline-token'>package.json</code>) </td></tr></table>
<br>
<h3>Forbidden Parameters (At least one required)</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <strong><code class='inline-token'>forbiddenElements</code></strong> </td><td> List<String> </td><td> List of forbidden JSON keys (top-level or simple nested paths). Fails if <strong>Exists</strong>. </td></tr><tr><td> <strong><code class='inline-token'>forbiddenFields</code></strong> </td><td> Map </td><td> Fails if field <strong>Matches Value</strong> (String equality). Logic: <code class='inline-token'>Actual == ForbiddenValue</code> -> Fail. </td></tr><tr><td> <strong><code class='inline-token'>forbiddenVersions</code></strong> </td><td> Map </td><td> Fails if field <strong>Matches Version</strong> (SemVer equality). Logic: <code class='inline-token'>Actual == ForbiddenVersion</code> -> Fail. </td></tr></table>
<br>
<h2 id="JSON_VALIDATION_FORBIDDEN_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Block Deprecated Project Fields</h3>
Prevents usage of legacy configuration fields in project descriptors.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-JSON-FORBIDDEN-01&quot;
  name: &quot;No Deprecated Project Fields&quot;
  description: &quot;Prevent usage of legacy fields in project descriptors&quot;
  enabled: true
  severity: MEDIUM
  checks:
    - type: JSON_VALIDATION_FORBIDDEN
      params:
        filePattern: &quot;project-descriptor.json&quot;
        forbiddenElements:
          - &quot;legacyMode&quot;
          - &quot;deprecatedConfig&quot;
</code></pre>
<br>
<h3>Example 2: Block Sensitive Fields in Node.js</h3>
Ensures <code class='inline-token'>package.json</code> does not contain sensitive or development-only keys.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-JSON-FORBIDDEN-NODE&quot;
  name: &quot;Clean Package JSON&quot;
  description: &quot;Prevent unapproved keys in package.json&quot;
  enabled: true
  severity: HIGH
  checks:
    - type: JSON_VALIDATION_FORBIDDEN
      params:
        filePattern: &quot;package.json&quot;
        forbiddenElements:
          - &quot;privateRepositoryUrl&quot;
        forbiddenFields:
          &quot;scripts/test&quot;: &quot;echo 'no test'&quot; # Forbid dummy test scripts
        forbiddenVersions:
          &quot;engines/node&quot;: &quot;14.17.0&quot;      # Forbid a specific known-vulnerable version
</code></pre>
<br>
<h2 id="JSON_VALIDATION_FORBIDDEN_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>project-descriptor.json has forbidden element: legacyMode
Forbidden field value found 'scripts/test': 'echo 'no test''
Forbidden version found for 'engines/node': '14.17.0'
</code></pre>
<br>
<h2 id="JSON_VALIDATION_FORBIDDEN_BestPractices">Best Practices</h2>
<br>
<h3>When to Use This Rule</h3>
<li><strong>Deprecation</strong>: Use it to enforce a "hard cut-over" when migrating from old config formats to new ones.</li>
<li><strong>Security</strong>: Prevent hardcoded secrets or insecure flags (like <code class='inline-token'>allowInsecure: true</code>) from being committed.</li>
<li><strong>Cleanliness</strong>: Keep project descriptors streamlined by blocking unapproved experimental fields.</li>
<br>
<h4>GLOBAL Parameters (Optional)</h4>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
---
<br>
<h2 id="JSON_VALIDATION_FORBIDDEN_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED')">JSON_VALIDATION_REQUIRED</a></strong> - Opposite: ensures elements DO exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN')">GENERIC_TOKEN_SEARCH_FORBIDDEN</a></strong> - More flexible search for forbidden patterns across any file type.</li>
</div><div id="JSON_VALIDATION_REQUIRED" class="rule-content" style="display: none;"><h1>JSON_VALIDATION_REQUIRED</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> JSON configuration files (package.json, etc.)
<br>
<h2 id="JSON_VALIDATION_REQUIRED_Overview">Overview</h2>
<br>
Validates that <strong>required JSON elements exist</strong> in JSON files. This rule is essential for validating project descriptors like <code class='inline-token'>mule-artifact.json</code>, <code class='inline-token'>package.json</code>, or custom configuration files. It supports <strong>version checking</strong>, <strong>specific field value validation</strong>, and <strong>field existence checks</strong>.
<br>
<h2 id="JSON_VALIDATION_REQUIRED_UseCases">Use Cases</h2>
<br>
<li>Validate <code class='inline-token'>mule-artifact.json</code> structure and runtime versions.</li>
<li>Ensure <code class='inline-token'>package.json</code> contains required scripts or engines configuration.</li>
<li>Ensure required configuration keys exist in custom JSON config files.</li>
<li>Enforce specific values for critical JSON fields (e.g., <code class='inline-token'>javaSpecificationVersions</code>).</li>
<br>
<h2 id="JSON_VALIDATION_REQUIRED_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePattern</code> </td><td> String </td><td> Precise filename to match (e.g., <code class='inline-token'>mule-artifact.json</code>, <code class='inline-token'>package.json</code>) </td></tr></table>
<br>
<h3>Standard Validation Parameters (Must configure at least one)</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>minVersions</code> </td><td> Map </td><td> Checks if a field's value meets a minimum version (Supports Arrays). Logic: <code class='inline-token'>Actual &gt;= Min</code> (SemVer). If array: Pass if *any* element >= Min. </td></tr><tr><td> <strong><code class='inline-token'>exactVersions</code></strong> </td><td> Map </td><td> Checks if a field's value exactly matches a version (Supports Arrays). Logic: <code class='inline-token'>Actual == Expected</code> (SemVer). If array: Pass if *any* element == Expected. </td></tr><tr><td> <code class='inline-token'>requiredFields</code> </td><td> Map </td><td> Checks if a field matches an expected value (Supports Arrays). Logic: <code class='inline-token'>Actual == Expected</code> (String Equality). If array: Pass if *any* element matches. </td></tr><tr><td> <code class='inline-token'>requiredElements</code> </td><td> List </td><td> Checks if a field simply exists (value ignored) </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="JSON_VALIDATION_REQUIRED_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Project Descriptor Validation (MuleSoft)</h3>
Validates minimum runtime version, required Java version, and presence of secure properties.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-JSON-MULE&quot;
  name: &quot;Validate Mule Project Descriptor&quot;
  description: &quot;Ensures mule-artifact.json meets minimum runtime requirements&quot;
  enabled: true
  severity: HIGH
  checks:
    - type: JSON_VALIDATION_REQUIRED
      params:
        filePattern: &quot;mule-artifact.json&quot;
        exactVersions:
             minMuleVersion: &quot;4.9.0&quot;  # Must be exactly 4.9.0
        requiredFields:
          javaSpecificationVersions: &quot;17&quot; # String match
        requiredElements:
          - &quot;secureProperties&quot;
</code></pre>
<br>
<h3>Example 2: Node.js / TypeScript Package Validation</h3>
Ensures the project has a start script and requires a minimum Node engine.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-JSON-NODE&quot;
  name: &quot;Validate Node.js Package&quot;
  description: &quot;Ensures package.json has required scripts and engines&quot;
  enabled: true
  severity: HIGH
  errorMessage: &quot;Package validation failed.\n{DEFAULT_MESSAGE}&quot;
  checks:
    - type: JSON_VALIDATION_REQUIRED
      params:
        filePattern: &quot;package.json&quot;
        requiredFields:
          scripts/start: &quot;node index.js&quot;
        minVersions:
          engines/node: &quot;18.0.0&quot; # Must be &gt;= 18.0.0
        requiredElements:
          - &quot;dependencies&quot;
          - &quot;license&quot;
</code></pre>
<br>
<h2 id="JSON_VALIDATION_REQUIRED_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>Field 'minMuleVersion' version too low in mule-artifact.json: expected &gt;= 4.9.0, got 4.4.0
Version mismatch for 'minMuleVersion': Found='4.4.0', Expected Exactly='4.9.0'
Element 'secureProperties' missing in mule-artifact.json
</code></pre>
<br>
<br>
<h2 id="JSON_VALIDATION_REQUIRED_BestPractices">Best Practices</h2>
<br>
<h3>When to Use This Rule</h3>
<li> Validating project descriptors for runtime compatibility.</li>
<li> Ensuring minimum platform/engine versions for security.</li>
<li> Enforcing required configuration fields in application JSON.</li>
<li> Standardizing JSON structure across multiple repositories.</li>
<br>
<h2 id="JSON_VALIDATION_REQUIRED_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN')">JSON_VALIDATION_FORBIDDEN</a></strong> - Opposite: ensures elements do NOT exist</li>
</div><div id="POM_VALIDATION_FORBIDDEN" class="rule-content" style="display: none;"><h1>POM_VALIDATION_FORBIDDEN</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> Maven POM files (<code class='inline-token'>pom.xml</code>)
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_Overview">Overview</h2>
<br>
Validates that <strong>forbidden elements do NOT exist</strong> in Maven POM files (<code class='inline-token'>pom.xml</code>). This rule <strong>fails</strong> if forbidden POM elements <strong>ARE found</strong>. It is commonly used to block vulnerable libraries, deprecated plugins, or insecure configuration properties.
<br>
Supports validation of:
<li><strong>Forbidden Properties</strong> (property names)</li>
<li><strong>Forbidden Dependencies</strong> (groupId, artifactId, optional version)</li>
<li><strong>Forbidden Plugins</strong> (groupId, artifactId, optional version)</li>
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_UseCases">Use Cases</h2>
<br>
<li>Block deprecated or vulnerable dependencies (e.g., Log4j 1.x, old Struts).</li>
<li>Prevent usage of forbidden or untrusted Maven plugins.</li>
<li>Disallow specific internal properties from being hardcoded or overridden in production.</li>
<li>Enforce dependency exclusion policies by banning restricted group/artifact IDs.</li>
<li>Block specific vulnerable versions while allowing safe, patched versions.</li>
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>validationType</code> </td><td> String </td><td> Type of validation: <code class='inline-token'>PROPERTIES</code>, <code class='inline-token'>DEPENDENCIES</code>, <code class='inline-token'>PLUGINS</code>, or <code class='inline-token'>COMBINED</code> </td></tr></table>
<br>
<h3>Validation-Specific Parameters</h3>
<br>
<h4>PROPERTIES Validation</h4>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>forbiddenProperties</code> </td><td> List<String> </td><td> Yes </td><td> List of property names that must NOT exist </td></tr></table>
<br>
<h4>DEPENDENCIES Validation</h4>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>forbiddenDependencies</code> </td><td> List<Map> </td><td> Yes </td><td> List of forbidden dependencies </td></tr><tr><td> <code class='inline-token'>forbiddenDependencies[].groupId</code> </td><td> String </td><td> Yes </td><td> Dependency groupId </td></tr><tr><td> <code class='inline-token'>forbiddenDependencies[].artifactId</code> </td><td> String </td><td> Yes </td><td> Dependency artifactId </td></tr><tr><td> <code class='inline-token'>forbiddenDependencies[].version</code> </td><td> String </td><td> <strong>No</strong> </td><td> <strong>Optional</strong>: If specified, only that specific version is forbidden </td></tr></table>
<br>
<h4>PLUGINS Validation</h4>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>forbiddenPlugins</code> </td><td> List<Map> </td><td> Yes </td><td> List of forbidden plugins </td></tr><tr><td> <code class='inline-token'>forbiddenPlugins[].groupId</code> </td><td> String </td><td> Yes </td><td> Plugin groupId </td></tr><tr><td> <code class='inline-token'>forbiddenPlugins[].artifactId</code> </td><td> String </td><td> Yes </td><td> Plugin artifactId </td></tr><tr><td> <code class='inline-token'>forbiddenPlugins[].version</code> </td><td> String </td><td> <strong>No</strong> </td><td> <strong>Optional</strong>: If specified, only that specific version is forbidden </td></tr></table>
<br>
---
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Forbidden Properties (Environment/Security)</h3>
<br>
Block properties that should only be handled via environment variables or CI/CD injection.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-POM-FORBIDDEN-PROP&quot;
  name: &quot;No Hardcoded Credentials&quot;
  description: &quot;Credentials must not be stored as POM properties&quot;
  enabled: true
  severity: CRITICAL
  checks:
    - type: POM_VALIDATION_FORBIDDEN
      params:
        validationType: PROPERTIES
        forbiddenProperties:
          - &quot;db.password&quot;
          - &quot;api.key&quot;
          - &quot;secret.token&quot;
</code></pre>
<br>
---
<br>
<h3>Example 2: Forbidden Dependency (Security Vulnerability)</h3>
<br>
Block a specific version of Log4j known for critical vulnerabilities.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-POM-FORBIDDEN-LOG4J&quot;
  name: &quot;Block Vulnerable Log4j&quot;
  description: &quot;Ensure vulnerable versions of log4j-core are not used&quot;
  enabled: true
  severity: CRITICAL
  checks:
    - type: POM_VALIDATION_FORBIDDEN
      params:
        validationType: DEPENDENCIES
        forbiddenDependencies:
          - groupId: &quot;org.apache.logging.log4j&quot;
            artifactId: &quot;log4j-core&quot;
            version: &quot;2.14.1&quot;
</code></pre>
<br>
---
<br>
<h3>Example 3: Forbidden Plugins (Standardization)</h3>
<br>
Prevent the use of problematic or redundant build plugins.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-POM-FORBIDDEN-PLUGIN&quot;
  name: &quot;Plugin Restriction&quot;
  description: &quot;Block forbidden or deprecated build plugins&quot;
  enabled: true
  severity: MEDIUM
  checks:
    - type: POM_VALIDATION_FORBIDDEN
      params:
        validationType: PLUGINS
        forbiddenPlugins:
          - groupId: &quot;org.codehaus.mojo&quot;
            artifactId: &quot;findbugs-maven-plugin&quot; # Replaced by SpotBugs
</code></pre>
<br>
---
<br>
<h3>Example 4: Combined Validation (Policy Blocklist)</h3>
<br>
Block multiple forbidden elements in one cohesive policy.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-POM-BLOCKLIST&quot;
  name: &quot;Corporate Policy Blocklist&quot;
  description: &quot;Block all known deprecated and insecure elements&quot;
  enabled: true
  severity: HIGH
  checks:
    - type: POM_VALIDATION_FORBIDDEN
      params:
        validationType: COMBINED
        forbiddenProperties:
          - &quot;legacy.mode.enabled&quot;
        forbiddenDependencies:
          - groupId: &quot;log4j&quot;
            artifactId: &quot;log4j&quot; # 1.x version
        forbiddenPlugins:
          - groupId: &quot;org.apache.maven.plugins&quot;
            artifactId: &quot;maven-antrun-plugin&quot;
</code></pre>
<br>
---
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>Forbidden property 'db.password' found in pom.xml
Forbidden dependency org.apache.logging.log4j:log4j-core:2.14.1 found in pom.xml
Forbidden plugin org.codehaus.mojo:findbugs-maven-plugin found in pom.xml
</code></pre>
<br>
---
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_BestPractices">Best Practices</h2>
<br>
<li><strong>Block all versions for deprecation</strong>: If a library is completely replaced, don't specify a version so that ALL versions are forbidden.</li>
<li><strong>Specific versions for security</strong>: If only one version is vulnerable, specify that exact version to allow projects to use safe, newer releases.</li>
<li><strong>Exclusion Lists</strong>: Use combined rules for enterprise-wide policy enforcement (e.g., "Standard Blocklist 2024").</li>
<br>
---
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_SolutionPatternsandTechnologyReferences">Solution Patterns and Technology References</h2>
<br>
<table><tr><td> Technology </td><td> Best Practice Goal </td><td> Forbidden Item </td><td> Reason </td></tr><tr><td> <strong>‚òï Java/Maven</strong> </td><td> Security </td><td> <code class='inline-token'>log4j</code> (1.x) </td><td> Critical vulnerabilities </td></tr><tr><td> <strong>‚òï Java/Maven</strong> </td><td> Build Safety </td><td> <code class='inline-token'>maven-antrun-plugin</code> </td><td> Unstructured build logic </td></tr><tr><td> <strong>üêé MuleSoft</strong> </td><td> Migration Safety </td><td> <code class='inline-token'>mule-module-http</code> </td><td> Deprecated in Mule 4 </td></tr></table>
<br>
<h3>‚òï Java / Maven Patterns</h3>
<br>
<strong>Scenario</strong>: Enterprise security teams often maintain a "banned library" list. Aegis enforces this automatically during the build or code review phase.
<br>
<pre><code class='language-yaml'>id: &quot;SECURITY-BANNED-LIBS&quot;
name: &quot;Banned Security Libraries&quot;
description: &quot;Block known insecure libraries&quot;
checks:
  - type: POM_VALIDATION_FORBIDDEN
    params:
      forbiddenDependencies:
        - groupId: &quot;log4j&quot;
          artifactId: &quot;log4j&quot;
        - groupId: &quot;org.apache.struts&quot;
          artifactId: &quot;struts2-core&quot;
          version: &quot;2.3.20&quot;
</code></pre>
<br>
---
<br>
<h2 id="POM_VALIDATION_FORBIDDEN_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'POM_VALIDATION_REQUIRED')">POM_VALIDATION_REQUIRED</a></strong> - Opposite: ensures elements DO exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')">XML_XPATH_NOT_EXISTS</a></strong> - For complex nested forbidden structures in POM/XML.</li>
<li><strong><a href="#" onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN')">JSON_VALIDATION_FORBIDDEN</a></strong> - Similar validation for JSON-based projects.</li>
<br>
---
<br>
<br>
</div><div id="POM_VALIDATION_REQUIRED" class="rule-content" style="display: none;"><h1>POM_VALIDATION_REQUIRED</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> Maven POM files (<code class='inline-token'>pom.xml</code>)
<br>
<h2 id="POM_VALIDATION_REQUIRED_Overview">Overview</h2>
<br>
Validates that <strong>required elements exist</strong> in Maven POM files (<code class='inline-token'>pom.xml</code>). This rule <strong>fails</strong> if required POM elements are <strong>NOT found</strong> or don't match expected values.
<br>
Supports validation of:
<li><strong>Parent POM</strong> (groupId, artifactId, version)</li>
<li><strong>Properties</strong> (name and value pairs)</li>
<li><strong>Dependencies</strong> (groupId, artifactId, optional version)</li>
<li><strong>Plugins</strong> (groupId, artifactId, optional version)</li>
<br>
<h2 id="POM_VALIDATION_REQUIRED_UseCases">Use Cases</h2>
<br>
<li>Ensure required dependencies (like logging or security libs) are declared.</li>
<li>Validate Maven plugin configurations for build consistency.</li>
<li>Enforce parent POM standards across a microservices architecture.</li>
<li>Check for mandatory project metadata and versioning schemes.</li>
<li>Validate specific dependency versions for security compliance (e.g., blocking known vulnerable versions).</li>
<br>
<h2 id="POM_VALIDATION_REQUIRED_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>validationType</code> </td><td> String </td><td> Type of validation: <code class='inline-token'>PARENT</code>, <code class='inline-token'>PROPERTIES</code>, <code class='inline-token'>DEPENDENCIES</code>, <code class='inline-token'>PLUGINS</code>, or <code class='inline-token'>COMBINED</code> </td></tr></table>
<br>
<h3>Validation-Specific Parameters</h3>
<br>
<h4>PARENT Validation</h4>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>parent</code> </td><td> Map </td><td> Yes </td><td> Parent POM configuration </td></tr><tr><td> <code class='inline-token'>parent.groupId</code> </td><td> String </td><td> Yes </td><td> Expected parent groupId </td></tr><tr><td> <code class='inline-token'>parent.artifactId</code> </td><td> String </td><td> Yes </td><td> Expected parent artifactId </td></tr><tr><td> <code class='inline-token'>parent.version</code> </td><td> String </td><td> No </td><td> <strong>Exact match</strong>: Expected parent version </td></tr><tr><td> <code class='inline-token'>parent.minVersion</code> </td><td> String </td><td> No </td><td> <strong>NEW</strong>: Minimum version (>= comparison) </td></tr><tr><td> <code class='inline-token'>parent.maxVersion</code> </td><td> String </td><td> No </td><td> <strong>NEW</strong>: Maximum version (<= comparison) </td></tr></table>
<br>
<h4>PROPERTIES Validation</h4>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>properties</code> </td><td> List<Map> </td><td> Yes </td><td> List of required properties </td></tr><tr><td> <code class='inline-token'>properties[].name</code> </td><td> String </td><td> Yes </td><td> Property name </td></tr><tr><td> <code class='inline-token'>properties[].expectedValue</code> </td><td> String </td><td> No </td><td> <strong>Exact match</strong>: Expected property value </td></tr><tr><td> <code class='inline-token'>properties[].minVersion</code> </td><td> String </td><td> No </td><td> <strong>NEW</strong>: Minimum version (>= comparison) </td></tr><tr><td> <code class='inline-token'>properties[].maxVersion</code> </td><td> String </td><td> No </td><td> <strong>NEW</strong>: Maximum version (<= comparison) </td></tr><tr><td> <code class='inline-token'>properties[].greaterThan</code> </td><td> String </td><td> No </td><td> <strong>NEW</strong>: Greater than (> comparison) </td></tr><tr><td> <code class='inline-token'>properties[].lessThan</code> </td><td> String </td><td> No </td><td> <strong>NEW</strong>: Less than (< comparison) </td></tr></table>
<br>
<h4>DEPENDENCIES Validation</h4>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>dependencies</code> </td><td> List<Map> </td><td> Yes </td><td> List of required dependencies </td></tr><tr><td> <code class='inline-token'>dependencies[].groupId</code> </td><td> String </td><td> Yes </td><td> Dependency groupId </td></tr><tr><td> <code class='inline-token'>dependencies[].artifactId</code> </td><td> String </td><td> Yes </td><td> Dependency artifactId </td></tr><tr><td> <code class='inline-token'>dependencies[].version</code> </td><td> String </td><td> <strong>No</strong> </td><td> <strong>Optional</strong>: If specified, validates exact version </td></tr></table>
<br>
<h4>PLUGINS Validation</h4>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>plugins</code> </td><td> List<Map> </td><td> Yes </td><td> List of required plugins </td></tr><tr><td> <code class='inline-token'>plugins[].groupId</code> </td><td> String </td><td> Yes </td><td> Plugin groupId </td></tr><tr><td> <code class='inline-token'>plugins[].artifactId</code> </td><td> String </td><td> Yes </td><td> Plugin artifactId </td></tr></table>
<h4>GLOBAL Parameters (Optional)</h4>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
---
<br>
<h2 id="POM_VALIDATION_REQUIRED_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Parent POM Validation - Minimum Version (NEW)</h3>
<br>
Enforce a minimum parent POM version instead of exact match.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-POM-PARENT&quot;
  name: &quot;Enforce Standard Parent POM (Minimum Version)&quot;
  description: &quot;All projects must use CorporateParent version &gt;= 2.5.0&quot;
  enabled: true
  severity: HIGH
  checks:
    - type: POM_VALIDATION_REQUIRED
      params:
        validationType: PARENT
        parent:
          groupId: &quot;com.corporation.framework&quot;
          artifactId: &quot;CorporateParent&quot;
          minVersion: &quot;2.5.0&quot;  # NEW: Allows 2.5.0, 2.5.1, 2.6.0, 3.0.0, etc.
</code></pre>
<br>
<strong>Benefits</strong>: More flexible - allows patch/minor updates without rule changes.
<br>
<strong>Test Results</strong>:
<li>Parent version <code class='inline-token'>2.5.0</code> ‚Üí ‚úÖ PASS</li>
<li>Parent version <code class='inline-token'>2.5.5</code> ‚Üí ‚úÖ PASS  </li>
<li>Parent version <code class='inline-token'>3.0.0</code> ‚Üí ‚úÖ PASS</li>
<li>Parent version <code class='inline-token'>2.4.9</code> ‚Üí ‚ùå FAIL</li>
<br>
---
<br>
<h3>Example 2: Properties Validation - Minimum Versions (NEW)</h3>
<br>
Validate minimum versions for build tools and runtime.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-POM-PROP&quot;
  name: &quot;Build Tool Minimum Versions&quot;
  description: &quot;Ensure mule.maven.plugin.version &gt;= 4.5.0 and app.runtime &gt;= 4.9.0&quot;
  enabled: true
  severity: HIGH
  checks:
    - type: POM_VALIDATION_REQUIRED
      params:
        validationType: PROPERTIES
        properties:
          - name: &quot;mule.maven.plugin.version&quot;
            minVersion: &quot;4.5.0&quot;  # NEW: Allows 4.5.0, 4.6.1, 5.0.0, etc.
          - name: &quot;app.runtime&quot;
            minVersion: &quot;4.9.0&quot;  # NEW: Works with 4.9.0, 4.9.LTS, 4.10.0, etc.
          - name: &quot;cicd.mule.version&quot;
            expectedValue: &quot;4.9.LTS&quot;  # Exact match still supported
</code></pre>
<br>
<strong>Alphanumeric Version Support</strong>: Versions like <code class='inline-token'>4.9.LTS</code> are supported. LTS qualifier is treated as HIGHER than no qualifier.
<br>
<strong>Test Results</strong>:
<li><code class='inline-token'>mule.maven.plugin.version: 4.6.1</code> ‚Üí ‚úÖ PASS</li>
<li><code class='inline-token'>mule.maven.plugin.version: 4.4.9</code> ‚Üí ‚ùå FAIL</li>
<li><code class='inline-token'>app.runtime: 4.9.LTS</code> ‚Üí ‚úÖ PASS (LTS >= 4.9.0)</li>
<li><code class='inline-token'>app.runtime: 4.8.5</code> ‚Üí ‚ùå FAIL</li>
<br>
---
<br>
<h3>Example 3: Dependency Validation (Security Libs)</h3>
<br>
Require a specific security library version.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-POM-DEP&quot;
  name: &quot;Security Library Requirement&quot;
  description: &quot;Standard security core must be present&quot;
  enabled: true
  severity: CRITICAL
  checks:
    - type: POM_VALIDATION_REQUIRED
      params:
        validationType: DEPENDENCIES
        dependencies:
          - groupId: &quot;com.corporation.security&quot;
            artifactId: &quot;security-core&quot;
            version: &quot;3.2.1&quot;
</code></pre>
<br>
---
<br>
<h3>Example 4: Version Range Validation (NEW)</h3>
<br>
Combine minVersion and maxVersion for range validation.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-POM-VERSION-RANGE&quot;
  name: &quot;Plugin Version Range&quot;
  description: &quot;Plugin version must be between 4.5.0 and 5.0.0&quot;
  enabled: true
  severity: MEDIUM
  checks:
    - type: POM_VALIDATION_REQUIRED
      params:
        validationType: PROPERTIES
        properties:
          - name: &quot;plugin.version&quot;
            minVersion: &quot;4.5.0&quot;
            maxVersion: &quot;5.0.0&quot;  # Must be between 4.5.0 and 5.0.0
</code></pre>
<br>
<strong>Test Results</strong>:
<li><code class='inline-token'>plugin.version: 4.6.1</code> ‚Üí ‚úÖ PASS (within range)</li>
<li><code class='inline-token'>plugin.version: 5.0.0</code> ‚Üí ‚úÖ PASS (at max)</li>
<li><code class='inline-token'>plugin.version: 5.0.1</code> ‚Üí ‚ùå FAIL (exceeds max)</li>
<li><code class='inline-token'>plugin.version: 4.4.9</code> ‚Üí ‚ùå FAIL (below min)</li>
<br>
---
<br>
<h2 id="POM_VALIDATION_REQUIRED_EnhancedReportingNEW">Enhanced Reporting (NEW)</h2>
<br>
Success messages now include <strong>actual values found</strong> for better transparency:
<br>
<pre><code class='language-text'>‚úÖ PASS: Validate Parent POM (Minimum Version)

All required POM elements found
Files validated: pom.xml

Actual Values Found:
‚Ä¢ Parent: com.corporation.framework:CorporateParent:2.5.5 (in pom.xml)
‚Ä¢ Property 'mule.maven.plugin.version': 4.6.1 (in pom.xml)
‚Ä¢ Property 'app.runtime': 4.9.LTS (in pom.xml)
</code></pre>
<br>
This shows:
<li>‚úÖ What was expected (rule configuration)</li>
<li>‚úÖ What was actually found (actual values)</li>
<li>‚úÖ Builds confidence in validation results</li>
<br>
---
<br>
<h2 id="POM_VALIDATION_REQUIRED_ErrorMessages">Error Messages</h2>
<br>
<strong>Version Comparison Errors</strong> (NEW):
<pre><code class='language-text'>Parent version too low in pom.xml: com.corp:Parent expected &gt;= '2.5.0', got '2.4.9'
Property 'mule.maven.plugin.version' version too low in pom.xml: expected &gt;= '4.5.0', got '4.4.9'
Property 'app.runtime' version too high in pom.xml: expected &lt;= '5.0.0', got '5.1.0'
</code></pre>
<br>
<strong>Exact Match Errors</strong> (Existing):
<pre><code class='language-text'>Parent version mismatch in pom.xml: expected com.corp:Parent:2.5.0, got version '1.0.0'
Property 'maven.compiler.source' has wrong value in pom.xml: expected '17', got '11'
Dependency com.corporation.security:security-core not found in pom.xml
</code></pre>
<br>
---
<br>
<h2 id="POM_VALIDATION_REQUIRED_VersionComparisonLogicNEW">Version Comparison Logic (NEW)</h2>
<br>
<h3>Numeric Versions</h3>
Versions are compared numerically by major.minor.patch:
<pre><code class='language-text'>4.9.0 &lt; 4.9.1 &lt; 4.10.0 &lt; 5.0.0
</code></pre>
<br>
<h3>Alphanumeric Versions (e.g., LTS)</h3>
Versions with qualifiers like <code class='inline-token'>LTS</code> are supported:
<pre><code class='language-text'>Version: &quot;4.9.LTS&quot;
  ‚îú‚îÄ‚îÄ major: 4
  ‚îú‚îÄ‚îÄ minor: 9
  ‚îú‚îÄ‚îÄ patch: 0
  ‚îî‚îÄ‚îÄ qualifier: &quot;LTS&quot;
</code></pre>
<br>
<strong>Comparison Rules</strong>:
1. Compare major.minor.patch numerically first
2. If equal, compare qualifiers
3. <strong>LTS is treated as HIGHER than no qualifier</strong>
<br>
<strong>Examples</strong>:
<li><code class='inline-token'>4.9.LTS &gt;= 4.9.0</code> ‚Üí ‚úÖ TRUE (LTS > no qualifier)</li>
<li><code class='inline-token'>4.9.0 &gt;= 4.9.0</code> ‚Üí ‚úÖ TRUE (equal)</li>
<li><code class='inline-token'>4.10.0 &gt;= 4.9.LTS</code> ‚Üí ‚úÖ TRUE (4.10 > 4.9)</li>
<li><code class='inline-token'>4.8.5 &gt;= 4.9.0</code> ‚Üí ‚ùå FALSE (4.8 < 4.9)</li>
<br>
---
<br>
<h2 id="POM_VALIDATION_REQUIRED_BestPractices">Best Practices</h2>
<br>
<li><strong>Use version validation for security</strong>: Lock critical security libraries to specific patched versions.</li>
<li><strong>Flexible utilities</strong>: For standard utilities (e.g., <code class='inline-token'>commons-lang</code>), omit the <code class='inline-token'>version</code> parameter to allow project-specific updates unless a specific version is required for compatibility.</li>
<li><strong>Combined Rules</strong>: Use <code class='inline-token'>validationType: COMBINED</code> to reduce the number of rules defined when multiple checks are related to the same "standard" (e.g., "Corporate Standard v2").</li>
<br>
---
<br>
<h2 id="POM_VALIDATION_REQUIRED_SolutionPatternsandTechnologyReferences">Solution Patterns and Technology References</h2>
<br>
<table><tr><td> Technology </td><td> Best Practice Goal </td><td> Key Elements </td><td> Attributes Checked </td></tr><tr><td> <strong>‚òï Java/Maven</strong> </td><td> Parent POM Usage </td><td> <code class='inline-token'>parent</code> </td><td> <code class='inline-token'>version</code> </td></tr><tr><td> <strong>‚òï Java/Maven</strong> </td><td> Compiler Standard </td><td> <code class='inline-token'>properties</code> </td><td> <code class='inline-token'>maven.compiler.source</code> </td></tr><tr><td> <strong>üêé MuleSoft</strong> </td><td> Mule Plugin Check </td><td> <code class='inline-token'>mule-maven-plugin</code> </td><td> <code class='inline-token'>version</code> </td></tr></table>
<br>
<h3>‚òï Java / Maven Patterns</h3>
<br>
<strong>Scenario</strong>: To ensure reproducible builds, it is critical that the <code class='inline-token'>parent</code> POM is strictly versioned and that major build plugins are explicitly defined with their respective versions.
<br>
<pre><code class='language-yaml'>id: &quot;MAVEN-PARENT-CHECK&quot;
name: &quot;Parent POM Validation&quot;
description: &quot;Ensure specific corporate parent POM is used&quot;
checks:
  - type: POM_VALIDATION_REQUIRED
    params:
      parent:
        groupId: &quot;com.corporation.framework&quot;
        artifactId: &quot;CorporateParent&quot;
        version: &quot;2.5.0&quot;
</code></pre>
<br>
---
<br>
<h2 id="POM_VALIDATION_REQUIRED_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN')">POM_VALIDATION_FORBIDDEN</a></strong> - Opposite: ensures elements do NOT exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></strong> - For more granular POM validation using raw XPath.</li>
<li><strong><a href="#" onclick="showRule(event, 'JSON_VALIDATION_REQUIRED')">JSON_VALIDATION_REQUIRED</a></strong> - Similar validation for JSON-based projects (Node.js, Mule artifacts).</li>
<br>
---
<br>
<br>
</div><div id="PROJECT_CONTEXT" class="rule-content" style="display: none;"><h1>PROJECT_CONTEXT</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> </td><td> <strong>Trigger Engine</strong>
<br>
<h2 id="PROJECT_CONTEXT_Overview">Overview</h2>
<br>
A contextual trigger that evaluates the properties of the project itself (primarily the project folder name). It is typically used within a <code class='inline-token'>CONDITIONAL_CHECK</code> to enable or disable rules based on project classification, technology tiers, or organizational layers.
<br>
<h2 id="PROJECT_CONTEXT_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
Choose at least one of the following to match the project name:
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>nameEquals</code> </td><td> String </td><td> Exact match of the project folder name </td></tr><tr><td> <code class='inline-token'>nameContains</code> </td><td> String </td><td> Matches if the project name contains this substring </td></tr><tr><td> <code class='inline-token'>nameMatches</code> </td><td> String </td><td> Regex pattern to match the project name </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>ignoreCase</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Perform case-insensitive matching </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Perform case-sensitive matching (overrides <code class='inline-token'>ignoreCase</code>) </td></tr></table>
<br>
<h2 id="PROJECT_CONTEXT_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Target Specific API Layers (MuleSoft/generic)</h3>
<br>
Triggers only for projects classified as "Experience" layers (containing <code class='inline-token'>-exp-</code> in their name).
<br>
<pre><code class='language-yaml'>preconditions:
  - type: PROJECT_CONTEXT
    params:
      nameContains: &quot;-exp-&quot;
      ignoreCase: true
</code></pre>
<br>
<h3>Example 2: Target Microservices (Generic)</h3>
<br>
Triggers for projects following a specific organizational naming convention for microservices.
<br>
<pre><code class='language-yaml'>preconditions:
  - type: PROJECT_CONTEXT
    params:
      nameMatches: &quot;^svc-[a-z0-9-]+$&quot;
</code></pre>
<br>
<h3>Example 3: Tiered Validation (Frontend vs Backend)</h3>
<br>
Apply different security rules for frontend projects.
<br>
<pre><code class='language-yaml'>- id: &quot;FRONTEND-SECURITY-POLICY&quot;
  checks:
    - type: CONDITIONAL_CHECK
      params:
        preconditions:
          - type: PROJECT_CONTEXT
            params: { nameContains: &quot;-ui&quot; }
        onSuccess:
          # Run frontend-specific checks here (e.g., package.json for unapproved libs)
</code></pre>
<br>
<h2 id="PROJECT_CONTEXT_BestPractices">Best Practices</h2>
<br>
<li><strong>Naming Conventions</strong>: Use <strong>PROJECT_CONTEXT</strong> to leverage established naming conventions (e.g., prefixing services with <code class='inline-token'>svc-</code>, or including environment tags like <code class='inline-token'>-prod-</code>).</li>
<li><strong>Layered Security</strong>: Use it to differentiate security requirements between customer-facing layers (Experience/Frontend) and protected internal layers (System/Data).</li>
<li><strong>Cleanup Migration</strong>: Identify legacy projects by name (e.g., <code class='inline-token'>v1-</code>) to apply "Sunset" rules that encourage migration.</li>
<br>
<h2 id="PROJECT_CONTEXT_RelatedCheckTypes">Related Check Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'CONDITIONAL_CHECK')">CONDITIONAL_CHECK</a></strong>: The parent engine that uses these context triggers.</li>
<li><strong><a href="#" onclick="showRule(event, 'FILE_EXISTS')">FILE_EXISTS</a></strong>: Trigger based on physical file presence (e.g., existence of <code class='inline-token'>pom.xml</code> vs <code class='inline-token'>package.json</code>).</li>
</div><div id="XML_ATTRIBUTE_EXISTS" class="rule-content" style="display: none;"><h1>XML_ATTRIBUTE_EXISTS</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> XML configuration files
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_Overview">Overview</h2>
<br>
Validates that <strong>required XML attributes exist</strong> on specified elements, optionally checking for specific values. This is a highly flexible rule supporting simple existence checks, specific value matching, and multi-attribute set validation.
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_UseCases">Use Cases</h2>
<br>
<li>Ensure configuration elements have required identifiers (name, ID).</li>
<li>Validate security settings (cipher suites, protocols, encrypted="true").</li>
<li>Enforce naming conventions for specific components.</li>
<li>Validate infrastructure settings (hosts, ports, timeouts).</li>
<li>Ensure required metadata or schema references are present.</li>
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_ValidationModes">Validation Modes</h2>
<br>
This rule supports <strong>three distinct modes</strong>:
<br>
1. <strong>Simple Attribute Existence</strong>: Check if attributes exist (any value).
2. <strong>Attribute Value Pairs</strong>: Validate specific attribute values on elements.
3. <strong>Element Attribute Sets</strong>: Validate multiple attributes on the same element instance.
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List<String> </td><td> Glob patterns to match XML files (e.g., <code class='inline-token'>src/**/*.xml</code>) </td></tr></table>
<br>
<h3>Mode-Specific Parameters</h3>
<br>
You must configure <strong>at least one</strong> of these modes:
<br>
<h4>Mode 1: Simple Attribute Existence</h4>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>elements</code> </td><td> List<String> </td><td> XML element names to check </td></tr><tr><td> <code class='inline-token'>attributes</code> </td><td> List<String> </td><td> Attributes that MUST exist on those elements </td></tr></table>
<br>
<h4>Mode 2: Attribute Value Pairs</h4>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>attributeValuePairs</code> </td><td> List<Map> </td><td> List of element-attribute-value triplets </td></tr></table>
<br>
<h4>Mode 3: Element Attribute Sets</h4>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>elementAttributeSets</code> </td><td> List<Map> </td><td> List of element configurations with multiple required attributes </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Case sensitivity for value matching </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Simple Existence</h3>
Check that a "connector" element has both a <code class='inline-token'>name</code> and a <code class='inline-token'>type</code> attribute (any values).
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-ATTR-01&quot;
  name: &quot;Connector Metadata Required&quot;
  checks:
    - type: XML_ATTRIBUTE_EXISTS
      params:
        filePatterns: [&quot;**/config/*.xml&quot;]
        elements: [&quot;connector&quot;]
        attributes: [&quot;name&quot;, &quot;type&quot;]
</code></pre>
<br>
<h3>Example 2: Attribute Value Validation</h3>
Ensure that any <code class='inline-token'>security-manager</code> element has the <code class='inline-token'>enabled</code> attribute set to <code class='inline-token'>true</code>.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-ATTR-VAL-01&quot;
  name: &quot;Security Manager Integration&quot;
  checks:
    - type: XML_ATTRIBUTE_EXISTS
      params:
        filePatterns: [&quot;src/main/resources/*.xml&quot;]
        attributeValuePairs:
          - element: &quot;security-manager&quot;
            attribute: &quot;enabled&quot;
            expectedValue: &quot;true&quot;
</code></pre>
<br>
<h3>Example 3: Multi-Attribute Set (Security)</h3>
Validate that a <code class='inline-token'>connection</code> element uses the correct port AND protocol.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-ATTR-SET-SEC&quot;
  name: &quot;Secure Connection Standard&quot;
  errorMessage: &quot;Insecure connection access point found.\n{DEFAULT_MESSAGE}&quot;
  checks:
    - type: XML_ATTRIBUTE_EXISTS
      params:
        filePatterns: [&quot;**/*.xml&quot;]
        elementAttributeSets:
          - element: &quot;connection&quot;
            attributes:
              protocol: &quot;HTTPS&quot;
              port: &quot;443&quot;
              secure: &quot;true&quot;
</code></pre>
<br>
<h3>Example 4: Property Resolution Support</h3>
Allow property placeholders (e.g., <code class='inline-token'>${env.port}</code>) to count as a valid match for a required port.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-ATTR-PROP&quot;
  name: &quot;Resolved Port Configuration&quot;
  checks:
    - type: XML_ATTRIBUTE_EXISTS
      params:
        filePatterns: [&quot;**/*.xml&quot;]
        propertyResolution: true
        attributeValuePairs:
          - element: &quot;server-config&quot;
            attribute: &quot;port&quot;
            expectedValue: &quot;8080&quot;
</code></pre>
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>Element 'connector' missing attribute 'type' in file: config/main.xml
Element 'security-manager' with attribute 'enabled'='true' not found in file: auth.xml
</code></pre>
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_BestPractices">Best Practices</h2>
<br>
<li><strong>Use Mode 3 for Dependencies</strong>: If an element's validity depends on multiple attributes (e.g., host + port), use <code class='inline-token'>elementAttributeSets</code> to ensure both are correct on the *same* element instance.</li>
<li><strong>Enable propertyResolution for Environments</strong>: Most enterprise projects use property placeholders; enabling this prevents false negatives for required values.</li>
<li><strong>Path Specificity</strong>: Use <code class='inline-token'>filePatterns</code> to target only the relevant configuration files to improve performance and reduce noise.</li>
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_SolutionPatternsandTechnologyReferences">Solution Patterns and Technology References</h2>
<br>
<table><tr><td> Technology </td><td> Best Practice Goal </td><td> Key Elements </td><td> Attributes Checked </td></tr><tr><td> <strong>üêé MuleSoft 4.X</strong> </td><td> Flow Identification </td><td> <code class='inline-token'>flow</code>, <code class='inline-token'>sub-flow</code> </td><td> <code class='inline-token'>name</code>, <code class='inline-token'>doc:id</code> </td></tr><tr><td> <strong>‚ö° TIBCO BW 6.X</strong> </td><td> Process Configuration </td><td> <code class='inline-token'>bpws:process</code> </td><td> <code class='inline-token'>name</code>, <code class='inline-token'>targetNamespace</code> </td></tr><tr><td> <strong>‚ö° TIBCO BW 5.X</strong> </td><td> Activity Naming </td><td> <code class='inline-token'>pd:startType</code> </td><td> <code class='inline-token'>name</code> </td></tr><tr><td> <strong>‚òï Java/Maven</strong> </td><td> Dependency Locking </td><td> <code class='inline-token'>dependency</code> </td><td> <code class='inline-token'>version</code> </td></tr></table>
<br>
<h3>üêé MuleSoft 4.X Patterns</h3>
<br>
<pre><code class='language-yaml'>id: &quot;MULE-FLOW-ATTRS&quot;
name: &quot;Mule Flow Identification&quot;
description: &quot;Flows must have name and doc:id attributes&quot;
checks:
  - type: XML_ATTRIBUTE_EXISTS
    params:
      filePatterns: [&quot;src/main/mule/**/*.xml&quot;]
      elements: [&quot;flow&quot;, &quot;sub-flow&quot;, &quot;error-handler&quot;]
      attributes: [&quot;name&quot;, &quot;doc:id&quot;]
</code></pre>
<br>
<h3>‚òï Java / Maven Patterns</h3>
<br>
<pre><code class='language-yaml'>id: &quot;JAVA-MAVEN-DEP-VERSION&quot;
name: &quot;Maven Dependency Version Enforced&quot;
description: &quot;Dependencies in this project must explicitly state versions&quot;
checks:
  - type: XML_ATTRIBUTE_EXISTS
    params:
      filePatterns: [&quot;pom.xml&quot;]
      elements: [&quot;dependency&quot;]
      attributes: [&quot;version&quot;]
</code></pre>
<br>
<h2 id="XML_ATTRIBUTE_EXISTS_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS')">XML_ATTRIBUTE_NOT_EXISTS</a></strong> - Opposite: ensures attributes do NOT exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></strong> - For advanced structure or nested path validation.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED')">XML_ELEMENT_CONTENT_REQUIRED</a></strong> - Validates tag body text instead of attributes.</li>
</div><div id="XML_ATTRIBUTE_NOT_EXISTS" class="rule-content" style="display: none;"><h1>XML_ATTRIBUTE_NOT_EXISTS</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> XML configuration files
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_Overview">Overview</h2>
<br>
Validates that <strong>forbidden XML attributes do NOT exist</strong> on specified elements. This rule <strong>fails</strong> if any of the specified forbidden attributes are found on the target elements. It is commonly used for deprecation cleanup and blocking unsafe configuration flags.
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_UseCases">Use Cases</h2>
<br>
<li>Detect and remove deprecated attributes (e.g., legacy tracking flags).</li>
<li>Enforce cleanup of temporary or debug configurations (e.g., <code class='inline-token'>debug=&quot;true&quot;</code>).</li>
<li>Prevent usage of insecure or prohibited attribute settings.</li>
<li>Standardize components by blocking non-standard configuration keys.</li>
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List<String> </td><td> Glob patterns to match XML files </td></tr><tr><td> <code class='inline-token'>elements</code> </td><td> List<String> </td><td> List of XML element names to scan </td></tr><tr><td> <code class='inline-token'>forbiddenAttributes</code> </td><td> List<String> </td><td> List of attributes that must NOT be present </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>matchMode</code> </td><td> String </td><td> <code class='inline-token'>SUBSTRING</code> </td><td> Choose <code class='inline-token'>SUBSTRING</code> or <code class='inline-token'>REGEX</code> </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Case sensitivity for content matching </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Remove Legacy Tracking</h3>
Ensure that no message processing elements contain legacy application tracking attributes.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-ATTR-FORBIDDEN-LEGACY&quot;
  name: &quot;Remove Forbidden Legacy Attributes&quot;
  checks:
    - type: XML_ATTRIBUTE_NOT_EXISTS
      params:
        filePatterns: [&quot;src/**/*.xml&quot;]
        elements:
          - &quot;request-handler&quot;
          - &quot;transform-component&quot;
        forbiddenAttributes:
          - &quot;fromApplicationCode&quot;
          - &quot;toApplicationCode&quot;
          - &quot;legacyFlag&quot;
</code></pre>
<br>
<h3>Example 2: Block Debug/Test Modes</h3>
Ensure that configuration elements do not have debug mode enabled in the committed code.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-ATTR-FORBIDDEN-DEBUG&quot;
  name: &quot;No Debug Mode in XML&quot;
  severity: HIGH
  checks:
    - type: XML_ATTRIBUTE_NOT_EXISTS
      params:
        filePatterns: [&quot;src/main/resources/*.xml&quot;]
        elements: [&quot;app-config&quot;, &quot;connector-config&quot;]
        forbiddenAttributes: [&quot;debug&quot;, &quot;test-mode&quot;, &quot;verbose-logging&quot;]
</code></pre>
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>Forbidden attribute 'fromApplicationCode' found on element 'request-handler' in file: src/main/resources/config.xml
Forbidden attribute 'debug' found on element 'connector-config' in file: src/main/resources/connectors.xml
</code></pre>
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_BestPractices">Best Practices</h2>
<br>
<li><strong>Layered Cleanup</strong>: Use this rule during platform migrations to systematically identify and remove old configuration keys that are no longer referenced.</li>
<li><strong>Fail on Side-Loads</strong>: Block attributes that might bypass standard security controls (e.g., <code class='inline-token'>bypass-auth</code>, <code class='inline-token'>ignore-ssl</code>).</li>
<li><strong>Combine with XPATH</strong>: For more complex conditions (e.g., "block attribute X only if element has parent Y"), use <strong><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')">XML_XPATH_NOT_EXISTS</a></strong> instead.</li>
<br>
<h2 id="XML_ATTRIBUTE_NOT_EXISTS_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS')">XML_ATTRIBUTE_EXISTS</a></strong> - Opposite: ensures attributes DO exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')">XML_XPATH_NOT_EXISTS</a></strong> - Block complex structures using XPath.</li>
</div><div id="XML_ELEMENT_CONTENT_FORBIDDEN" class="rule-content" style="display: none;"><h1>XML_ELEMENT_CONTENT_FORBIDDEN</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> XML configuration files
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_Overview">Overview</h2>
<br>
Validates that XML elements do <strong>NOT contain forbidden content or tokens</strong>. This rule <strong>fails</strong> if any of the specified forbidden tokens are <strong>found</strong> within the element's text content. It is primarily used to block hardcoded credentials, deprecated values, or insecure configurations.
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_UseCases">Use Cases</h2>
<br>
<li>Prevent usage of deprecated values or legacy patterns.</li>
<li>Block hardcoded credentials (passwords, secrets) in element bodies.</li>
<li>Disallow specific configuration values (e.g., insecure protocols, debug levels).</li>
<li>Enforce content restrictions for production-ready code.</li>
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List<String> </td><td> Glob patterns to match XML files </td></tr><tr><td> <code class='inline-token'>elementContentPairs</code> </td><td> List<Map> </td><td> Element names paired with their forbidden content tokens </td></tr></table>
<br>
<h4>Element Content Pair Map Structure</h4>
<br>
<table><tr><td> Field </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>element</code> </td><td> String </td><td> Yes </td><td> XML element name </td></tr><tr><td> <code class='inline-token'>forbiddenTokens</code> </td><td> List<String> </td><td> Yes </td><td> Tokens that must NOT be present in the element's body </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>matchMode</code> </td><td> String </td><td> <code class='inline-token'>SUBSTRING</code> </td><td> Choose <code class='inline-token'>SUBSTRING</code> or <code class='inline-token'>REGEX</code> </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Case sensitivity for content matching </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Block Hardcoded Secrets</h3>
Ensure that password or secret-related elements do not contain common default or hardcoded values.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-FORBIDDEN-CREDS&quot;
  name: &quot;No Hardcoded Credentials&quot;
  severity: CRITICAL
  checks:
    - type: XML_ELEMENT_CONTENT_FORBIDDEN
      params:
        filePatterns: [&quot;**/*.xml&quot;]
        elementContentPairs:
          - element: &quot;password&quot;
            forbiddenTokens: [&quot;admin&quot;, &quot;password123&quot;, &quot;default&quot;]
          - element: &quot;secret-key&quot;
            forbiddenTokens: [&quot;hardcoded&quot;, &quot;placeholder&quot;]
</code></pre>
<br>
<h3>Example 2: Block Deprecated Log Levels</h3>
Prevent usage of overly verbose or deprecated logging levels in production-bound configurations.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-LOG-POLICY&quot;
  name: &quot;Forbidden Log Levels&quot;
  severity: MEDIUM
  checks:
    - type: XML_ELEMENT_CONTENT_FORBIDDEN
      params:
        filePatterns: [&quot;src/main/resources/**/*.xml&quot;]
        elementContentPairs:
          - element: &quot;logger&quot;
            forbiddenTokens: [&quot;TRACE&quot;, &quot;ALL&quot;, &quot;DEBUG&quot;]
</code></pre>
<br>
<h3>Example 3: Block IP Addresses (Regex)</h3>
Ensure that host configurations use domain names instead of hardcoded IP addresses.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-NO-IP-HOSTS&quot;
  name: &quot;No Hardcoded IPs in Hosts&quot;
  severity: HIGH
  checks:
    - type: XML_ELEMENT_CONTENT_FORBIDDEN
      params:
        filePatterns: [&quot;**/*.xml&quot;]
        matchMode: REGEX
        elementContentPairs:
          - element: &quot;host-config&quot;
            forbiddenTokens: [&quot;\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b&quot;]
</code></pre>
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>config.xml: Element 'password' contains forbidden token: admin
main-flow.xml: Element 'logger' contains forbidden token: TRACE
host-config.xml: Element 'host-config' contains forbidden IP pattern
</code></pre>
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_BestPractices">Best Practices</h2>
<br>
<li><strong>Strict Mode for Credentials</strong>: Use <code class='inline-token'>caseSensitive: true</code> (default) when blocking passwords to avoid false positives on legitimate similar strings, but consider <code class='inline-token'>false</code> for logging levels.</li>
<li><strong>REGEX for Complexity</strong>: Use REGEX mode to block entire classes of strings, such as IP addresses or specific ID formats.</li>
<li><strong>Fail Early</strong>: Apply this rule to core configuration files to catch architectural violations before they reach higher environments.</li>
<br>
<h2 id="XML_ELEMENT_CONTENT_FORBIDDEN_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED')">XML_ELEMENT_CONTENT_REQUIRED</a></strong> - Opposite: ensures tokens ARE present in the content.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')">XML_XPATH_NOT_EXISTS</a></strong> - Block complex structures using XPath.</li>
</div><div id="XML_ELEMENT_CONTENT_REQUIRED" class="rule-content" style="display: none;"><h1>XML_ELEMENT_CONTENT_REQUIRED</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> XML configuration files
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_Overview">Overview</h2>
<br>
Validates that XML elements contain <strong>required content strings or tokens</strong>. This rule <strong>fails</strong> if the required tokens are <strong>NOT found</strong> within the element's text content. It is ideal for enforcing descriptive messages, documentation standards, or specific data formats inside XML tags.
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_UseCases">Use Cases</h2>
<br>
<li>Ensure log messages or display names contain descriptive keywords.</li>
<li>Validate documentation or comment tags for specific sections (e.g., "Author", "Version").</li>
<li>Check that configuration values follow a specific format (e.g., semantic versioning).</li>
<li>Enforce organizational content standards in shared XML descriptors.</li>
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List<String> </td><td> Glob patterns to match XML files </td></tr><tr><td> <code class='inline-token'>elementContentPairs</code> </td><td> List<Map> </td><td> Element names paired with their required content tokens </td></tr></table>
<br>
<h4>Element Content Pair Map Structure</h4>
<br>
<table><tr><td> Field </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>element</code> </td><td> String </td><td> Yes </td><td> XML element name (can be local-name or prefixed) </td></tr><tr><td> <code class='inline-token'>requiredTokens</code> </td><td> List<String> </td><td> Yes </td><td> Tokens that must be present in the element's body </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Case sensitivity for content matching </td></tr><tr><td> <code class='inline-token'>requireAll</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> If <code class='inline-token'>true</code>, ALL tokens must be found. If <code class='inline-token'>false</code>, at least ONE </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Validate Message Quality</h3>
Ensure that elements used for logging or reporting are descriptive enough.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-CONTENT-REQ-01&quot;
  name: &quot;Descriptive Logger Messages&quot;
  checks:
    - type: XML_ELEMENT_CONTENT_REQUIRED
      params:
        filePatterns: [&quot;**/*.xml&quot;]
        elementContentPairs:
          - element: &quot;logger&quot;
            requiredTokens: [&quot;Flow&quot;, &quot;Request&quot;, &quot;Response&quot;, &quot;Status&quot;]
        requireAll: false  # Pass if at least one of these is mentioned
</code></pre>
<br>
<h3>Example 2: Enforce Documentation Standards</h3>
Check that a "description" or "note" tag contains required metadata headers.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-DOC-POLICY&quot;
  name: &quot;Documentation Header Policy&quot;
  checks:
    - type: XML_ELEMENT_CONTENT_REQUIRED
      params:
        filePatterns: [&quot;src/main/resources/*.xml&quot;]
        elementContentPairs:
          - element: &quot;note&quot;
            requiredTokens: [&quot;Author:&quot;, &quot;Last-Updated:&quot;, &quot;Business-Unit:&quot;]
        requireAll: true  # All headers must be present
</code></pre>
<br>
<h3>Example 3: Regex Format Validation</h3>
Verify that a version tag follows a specific semantic versioning pattern.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-VERSION-FORMAT&quot;
  name: &quot;Version Pattern Validation&quot;
  checks:
    - type: XML_ELEMENT_CONTENT_REQUIRED
      params:
        filePatterns: [&quot;pom.xml&quot;, &quot;manifest.xml&quot;]
        matchMode: REGEX
        elementContentPairs:
          - element: &quot;version&quot;
            requiredTokens: [&quot;^\\d+\\.\\d+\\.\\d+(-SNAPSHOT)?$&quot;]
</code></pre>
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>config.xml: Element 'logger' is missing required tokens: Flow, Request, Response
manifest.xml: Element 'version' content does not match pattern: ^\d+\.\d+\.\d+(-SNAPSHOT)?$
</code></pre>
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_BestPractices">Best Practices</h2>
<br>
<li><strong>Use caseSensitive: false for flexibility</strong>: For documentation or log messages, case sensitivity often leads to false negatives.</li>
<li><strong>REGEX for Strict Formats</strong>: Use REGEX mode when the *order* or *format* matters (e.g., dates, versions, IDs).</li>
<li><strong>Combine with existence</strong>: This rule only checks content *on elements it finds*. If the element is missing entirely, this rule won't trigger. Combine with <strong><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></strong> to ensure the element exists first if needed.</li>
<br>
<h2 id="XML_ELEMENT_CONTENT_REQUIRED_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN')">XML_ELEMENT_CONTENT_FORBIDDEN</a></strong> - Opposite: ensures tokens do NOT exist in the content.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></strong> - Check for existence and hierarchy using XPath.</li>
</div><div id="XML_XPATH_EXISTS" class="rule-content" style="display: none;"><h1>XML_XPATH_EXISTS</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> XML configuration files
<br>
<h2 id="XML_XPATH_EXISTS_Overview">Overview</h2>
<br>
Validates that <strong>required XPath expressions match</strong> in XML files. This rule <strong>fails</strong> if any required XPath expression does <strong>NOT</strong> find matching nodes. It is the core tool for complex XML structure validation.
<br>
<h2 id="XML_XPATH_EXISTS_UseCases">Use Cases</h2>
<br>
<li>Verify specific XML elements or attributes exist within a hierarchy.</li>
<li>Ensure required configuration is present in integration flows (MSoft, TIBCO, etc.).</li>
<li>Validate XML structure beyond simple existence (e.g., "Parent must have Child").</li>
<li>Check for mandatory namespaces, schemas, or specific attribute values.</li>
<br>
<h2 id="XML_XPATH_EXISTS_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List<String> </td><td> Glob patterns to match XML files </td></tr><tr><td> <code class='inline-token'>xpathExpressions</code> </td><td> List<Map> </td><td> List of XPath expressions with optional custom failure messages </td></tr><tr><td> <code class='inline-token'>requiredFields</code> </td><td> Map<String, String> </td><td> XPath-Value pairs for exact matching (Optional) </td></tr><tr><td> <code class='inline-token'>minVersions</code> </td><td> Map<String, String> </td><td> XPath-MinVersion pairs for SemVer check (Optional) </td></tr><tr><td> <code class='inline-token'>exactVersions</code> </td><td> Map<String, String> </td><td> XPath-Version pairs for Exact SemVer check (Optional) </td></tr></table>
<br>
<h4>XPath Expression Map Structure</h4>
<br>
Each item in <code class='inline-token'>xpathExpressions</code> can have:
<br>
<table><tr><td> Field </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>xpath</code> </td><td> String </td><td> Yes </td><td> The XPath expression to evaluate </td></tr><tr><td> <code class='inline-token'>failureMessage</code> </td><td> String </td><td> No </td><td> Custom message if XPath doesn't match </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${property}</code> placeholder resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="XML_XPATH_EXISTS_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Basic component existence</h3>
Ensure that a specific component (e.g., a "logger" or custom plugin) is used in the configuration.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-XPATH-01&quot;
  name: &quot;Logger Component Required&quot;
  description: &quot;Ensure all flows have at least one logger&quot;
  enabled: true
  severity: MEDIUM
  checks:
    - type: XML_XPATH_EXISTS
      params:
        filePatterns:
          - &quot;**/*.xml&quot;
        xpathExpressions:
          - xpath: &quot;//logger&quot;
            failureMessage: &quot;Configuration must contain at least one logger&quot;
</code></pre>
<br>
<h3>Example 2: Check for specific nested configuration</h3>
Validates that a <code class='inline-token'>service</code> element has a defined <code class='inline-token'>endpoint</code> attribute.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-XPATH-02&quot;
  name: &quot;Endpoint Config Required&quot;
  description: &quot;All services must have a defined endpoint&quot;
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_EXISTS
      params:
        filePatterns:
          - &quot;**/*-config.xml&quot;
        xpathExpressions:
          - xpath: &quot;//service[@endpoint]&quot;
            failureMessage: &quot;Service element missing required 'endpoint' attribute&quot;
</code></pre>
<br>
<h3>Example 3: Namespace-Aware local-name validation</h3>
Safely validate elements regardless of their specific prefix by using <code class='inline-token'>local-name()</code>.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-XPATH-NAMESPACE&quot;
  name: &quot;Listener Configuration Check&quot;
  description: &quot;Ensure specific listener configuration exists&quot;
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_EXISTS
      params:
        filePatterns:
          - &quot;**/global-*.xml&quot;
        xpathExpressions:
          - xpath: &quot;//*[local-name()='listener-config']&quot;
            failureMessage: &quot;Missing required listener configuration&quot;
</code></pre>
<br>
<h2 id="XML_XPATH_EXISTS_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>config.xml: Configuration must contain at least one logger (found 0 occurrence(s))
main-flow.xml: Service element missing required 'endpoint' attribute (found 0 occurrence(s))
</code></pre>
<br>
<h2 id="XML_XPATH_EXISTS_BestPractices">Best Practices</h2>
<br>
<li><strong>Use local-name() for portability</strong>: When XML files use multiple namespaces/prefixes, <code class='inline-token'>//*[local-name()='elementName']</code> is often more robust than prefix-dependent paths.</li>
<li><strong>Fail Early</strong>: Combine with <code class='inline-token'>FILE_EXISTS</code> or <code class='inline-token'>FILE_PATTERN</code> to ensure you are scanning the correct files.</li>
<li><strong>Granular Paths</strong>: Avoid too many <code class='inline-token'>//</code> (deep descendants) if performance is a concern on massive XML files; use specific paths like <code class='inline-token'>/root/parent/child</code> when possible.</li>
<br>
<h2 id="XML_XPATH_EXISTS_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')">XML_XPATH_NOT_EXISTS</a></strong> - Opposite: ensures nodes do NOT exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS')">XML_ATTRIBUTE_EXISTS</a></strong> - Simpler check for high-level attributes.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED')">XML_ELEMENT_CONTENT_REQUIRED</a></strong> - Validate the text content inside an element.</li>
<br>
<h2 id="XML_XPATH_EXISTS_SolutionPatternsandTechnologyReferences">Solution Patterns and Technology References</h2>
<br>
<table><tr><td> Technology </td><td> Best Practice Goal </td><td> Key Elements </td><td> XPath Logic </td></tr><tr><td> <strong>‚ö° TIBCO BW 5</strong> </td><td> Process Validity </td><td> <code class='inline-token'>ProcessDefinition</code> </td><td> Check for start/end activities </td></tr><tr><td> <strong>‚ö° TIBCO BW 6</strong> </td><td> Namespace Binding </td><td> <code class='inline-token'>service</code> </td><td> Namespace-aware paths </td></tr><tr><td> <strong>üêé MuleSoft</strong> </td><td> Build Configuration </td><td> <code class='inline-token'>mule-maven-plugin</code> </td><td> Value-based predicate check </td></tr><tr><td> <strong>üåê Web Svcs</strong> </td><td> WSDL Compliance </td><td> <code class='inline-token'>definitions</code> </td><td> Structure validation </td></tr></table>
<br>
<h3>‚ö° TIBCO BW 5.x Patterns</h3>
<br>
<pre><code class='language-yaml'>id: &quot;TIBCO-XPATH-PD&quot;
name: &quot;Valid Process Definition&quot;
description: &quot;Ensure pd:ProcessDefinition has start and end activities&quot;
checks:
  - type: XML_XPATH_EXISTS
    params:
      filePatterns: [&quot;*.process&quot;]
      xpathExpressions:
        - xpath: &quot;//*[local-name()='ProcessDefinition']/*[local-name()='startType']&quot;
        - xpath: &quot;//*[local-name()='ProcessDefinition']/*[local-name()='endType']&quot;
</code></pre>
<br>
<h3>üêé MuleSoft / Java Patterns</h3>
<br>
<pre><code class='language-yaml'>id: &quot;MAVEN-MULE-PLUGIN&quot;
name: &quot;Mule Maven Plugin Required&quot;
description: &quot;Ensure correct plugin is present in pom.xml build section&quot;
checks:
  - type: XML_XPATH_EXISTS
    params:
      filePatterns: [&quot;pom.xml&quot;]
      xpathExpressions:
        - xpath: &quot;//*[local-name()='plugin']/*[local-name()='artifactId' and text()='mule-maven-plugin']&quot;
</code></pre>
</div><div id="XML_XPATH_NOT_EXISTS" class="rule-content" style="display: none;"><h1>XML_XPATH_NOT_EXISTS</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CODE</code> - <strong>Applies To:</strong> XML configuration files
<br>
<h2 id="XML_XPATH_NOT_EXISTS_Overview">Overview</h2>
<br>
Validates that <strong>forbidden XPath expressions do NOT match</strong> in XML files. This rule <strong>fails</strong> if any forbidden XPath expression <strong>DOES</strong> find matching nodes. It is used to block deprecated components, anti-patterns, or insecure configurations.
<br>
<h2 id="XML_XPATH_NOT_EXISTS_UseCases">Use Cases</h2>
<br>
<li>Prevent usage of deprecated XML elements or custom tags.</li>
<li>Block specific insecure configurations (e.g., protocol="HTTP" instead of "HTTPS").</li>
<li>Enforce architectural constraints (e.g., "No direct database calls from the presentation layer").</li>
<li>Disallow anti-patterns or redundant configurations.</li>
<br>
<h2 id="XML_XPATH_NOT_EXISTS_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>filePatterns</code> </td><td> List<String> </td><td> Glob patterns to match XML files </td></tr><tr><td> <code class='inline-token'>xpathExpressions</code> </td><td> List<Map> </td><td> List of XPath expressions that should NOT match </td></tr></table>
<br>
<h4>XPath Expression Map Structure</h4>
<br>
<table><tr><td> Field </td><td> Type </td><td> Required </td><td> Description </td></tr><tr><td> <code class='inline-token'>xpath</code> </td><td> String </td><td> Yes </td><td> The XPath expression to evaluate </td></tr><tr><td> <code class='inline-token'>failureMessage</code> </td><td> String </td><td> No </td><td> Custom message if XPath matches (forbidden) </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${property}</code> placeholder resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="XML_XPATH_NOT_EXISTS_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Block Deprecated Components</h3>
Prevents usage of legacy connectors or custom XML tags that are no longer supported.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-XPATH-FORBIDDEN-01&quot;
  name: &quot;No Legacy Transports&quot;
  description: &quot;Prevent usage of deprecated transport elements&quot;
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_NOT_EXISTS
      params:
        filePatterns:
          - &quot;**/*.xml&quot;
        xpathExpressions:
          - xpath: &quot;//*[local-name()='legacy-transport']&quot;
            failureMessage: &quot;Deprecated 'legacy-transport' found - please migrate to the new standard&quot;
</code></pre>
<br>
<h3>Example 2: Prevent Hardcoded Environment Values</h3>
Ensures that environment-specific settings (like hostnames) are property-driven and not hardcoded to <code class='inline-token'>localhost</code>.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-XPATH-FORBIDDEN-02&quot;
  name: &quot;No Hardcoded Localhost&quot;
  description: &quot;Prevent hardcoded localhost in service configurations&quot;
  enabled: true
  severity: MEDIUM
  checks:
    - type: XML_XPATH_NOT_EXISTS
      params:
        filePatterns:
          - &quot;src/main/resources/**/*.xml&quot;
        xpathExpressions:
          - xpath: &quot;//service[@host='localhost']&quot;
            failureMessage: &quot;Hardcoded 'localhost' found - use property placeholders&quot;
</code></pre>
<br>
<h3>Example 3: Enforce Layered Architecture</h3>
Prevents direct database access from high-level API or presentation layer configurations.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-XML-XPATH-FORBIDDEN-ARCH&quot;
  name: &quot;Layered Architecture Compliance&quot;
  description: &quot;API layers cannot contain direct database listeners or operations&quot;
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_NOT_EXISTS
      params:
        filePatterns:
          - &quot;**/api-*.xml&quot;
        xpathExpressions:
          - xpath: &quot;//db:select | //db:insert | //db:update | //db:delete&quot;
            failureMessage: &quot;Direct database operations forbidden in API layer - use the persistence layer&quot;
</code></pre>
<br>
<h2 id="XML_XPATH_NOT_EXISTS_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>config.xml: Deprecated 'legacy-transport' found - please migrate to the new standard (found 2 occurrence(s))
api-main.xml: Direct database operations forbidden in API layer - use the persistence layer (found 1 occurrence(s))
</code></pre>
<br>
<h2 id="XML_XPATH_NOT_EXISTS_BestPractices">Best Practices</h2>
<br>
<li><strong>Use predicates for precise blocking</strong>: Instead of blocking an entire element, use predicates like <code class='inline-token'>//config[@secure='false']</code> to block only the insecure variants.</li>
<li><strong>Fail with clear instructions</strong>: Always provide a <code class='inline-token'>failureMessage</code> that explains the preferred alternative.</li>
<li><strong>Architecture over Code</strong>: Use path-based <code class='inline-token'>filePatterns</code> to enforce different restrictions on different project layers (e.g., <code class='inline-token'>src/web/*.xml</code> vs <code class='inline-token'>src/service/*.xml</code>).</li>
<br>
<h2 id="XML_XPATH_NOT_EXISTS_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></strong> - Opposite: ensures XPath DOES match.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS')">XML_ATTRIBUTE_NOT_EXISTS</a></strong> - Simpler attribute validation.</li>
<li><strong><a href="#" onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN')">XML_ELEMENT_CONTENT_FORBIDDEN</a></strong> - Validate forbidden text content inside an element.</li>
</div><div id="CONDITIONAL_CHECK" class="rule-content" style="display: none;"><h1>CONDITIONAL_CHECK</h1>
<br>
<h2 id="CONDITIONAL_CHECK_Overview">Overview</h2>
<br>
The <strong>Universal "If-Then" Engine</strong>. This is the most powerful check type in Aegis. It allows you to create complex, multi-step validation logic by combining any other check type as a trigger (<code class='inline-token'>preconditions</code>) and an action (<code class='inline-token'>onSuccess</code>).
<br>
It is not limited to code analysis! You can combine configuration checks, XML/JSON checks, file existence checks, and project metadata checks in any combination.
<br>
<h2 id="CONDITIONAL_CHECK_UseCases">Use Cases</h2>
<br>
*   <strong>Context-Specific Rules</strong>: "If this is a frontend project (<code class='inline-token'>-ui-</code>), THEN it must have a <code class='inline-token'>LICENSE</code> file."
*   <strong>Cross-File Dependencies</strong>: "If <code class='inline-token'>package.json</code> contains <code class='inline-token'>react</code>, THEN <code class='inline-token'>src/App.tsx</code> must exist."
*   <strong>Technology Standards</strong>: "If an <code class='inline-token'>IBM MQ</code> connector is found (XML), THEN the project must have the corresponding client library dependency (POM)."
*   <strong>Environment Validation</strong>: "If the <code class='inline-token'>env</code> property is set to <code class='inline-token'>PROD</code> (Config), THEN debug logging must be disabled (Log configuration)."
<br>
<h2 id="CONDITIONAL_CHECK_HowItWorks">How It Works</h2>
<br>
This check executes in two phases:
1.  <strong>Preconditions (IF)</strong>: The engine runs these checks first.
    *   If ALL preconditions match (pass), the engine proceeds to step 2.
    *   If ANY precondition fails (doesn't match), the rule is <strong>SKIPPED</strong> (it does not fail, it just implies this rule doesn't apply to this project).
2.  <strong>OnSuccess (THEN)</strong>: The engine runs these checks ONLY if preconditions were met.
    *   If these checks pass, the Rule PASSES.
    *   If any of these checks fail, the Rule FAILS.
<br>
<h3>Supported Triggers & Actions</h3>
<strong>ANY</strong> check type can be used in either <code class='inline-token'>preconditions</code> or <code class='inline-token'>onSuccess</code>. Common triggers include:
<br>
*   <strong>Project Identity</strong>: <code class='inline-token'>PROJECT_CONTEXT</code> (Name matching)
*   <strong>File Presence</strong>: <code class='inline-token'>FILE_EXISTS</code> (e.g., specific config files)
*   <strong>XML/JSON Content</strong>: <code class='inline-token'>XML_XPATH_EXISTS</code> or <code class='inline-token'>JSON_VALIDATION_REQUIRED</code>
*   <strong>Properties</strong>: <code class='inline-token'>MANDATORY_PROPERTY_VALUE_CHECK</code> (e.g., environment checks)
*   <strong>Dependencies</strong>: <code class='inline-token'>POM_VALIDATION_REQUIRED</code> (Check for Maven libraries)
<br>
<h2 id="CONDITIONAL_CHECK_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>preconditions</code> </td><td> List<Map> </td><td> A list of standard check definitions that define <strong>WHEN</strong> this rule applies. </td></tr><tr><td> <code class='inline-token'>onSuccess</code> </td><td> List<Map> </td><td> A list of standard check definitions that define <strong>WHAT</strong> must be validated if the preconditions are met. </td></tr></table>
<br>
<h2 id="CONDITIONAL_CHECK_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Frontend Resource Security</h3>
<strong>Scenario</strong>: "If this is a Web UI project (Name) AND it uses a private repository (JSON), THEN it must have a security policy file."
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-COND-FE-01&quot;
  name: &quot;Web UI Security Policy&quot;
  checks:
    - type: CONDITIONAL_CHECK
      params:
        preconditions:
          - type: PROJECT_CONTEXT
            params:
              nameContains: &quot;-ui-&quot;
          - type: JSON_VALIDATION_REQUIRED
            params:
              filePattern: &quot;package.json&quot;
              requiredElements:
                - &quot;publishConfig.registry&quot;
        onSuccess:
          - type: FILE_EXISTS
            params:
              filePatterns: [&quot;SECURITY.md&quot;]
</code></pre>
<br>
<h3>Example 2: Unused Dependency Check (POM + XML)</h3>
<strong>Scenario</strong>: "If the Messaging library is in the POM, you MUST actually use it in the XML (prevent bloat)."
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-UNUSED-DEP&quot;
  name: &quot;Messaging Library Usage&quot;
  checks:
    - type: CONDITIONAL_CHECK
      params:
        preconditions:
          - type: POM_VALIDATION_REQUIRED
            params:
              validationType: DEPENDENCIES
              dependencies:
                - artifactId: messaging-client
        onSuccess:
          - type: XML_XPATH_EXISTS
            params:
              filePatterns: [&quot;src/main/resources/*.xml&quot;]
              xpathExpressions:
                - xpath: &quot;//*[local-name()='messaging-config']&quot;
              failureMessage: &quot;Messaging dependency found in POM but no usage found in XML.&quot;
</code></pre>
<br>
<h3>Example 3: Environment-Specific Enforcement</h3>
Only require production metadata if the <code class='inline-token'>PROD</code> environment is active in the configuration.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-ENV-PROD&quot;
  name: &quot;Production Metadata Check&quot;
  checks:
    - type: CONDITIONAL_CHECK
      params:
        preconditions:
          - type: MANDATORY_PROPERTY_VALUE_CHECK
            params: { properties: [{ name: &quot;env&quot;, values: [&quot;PROD&quot;] }] }
        onSuccess:
          - type: JSON_VALIDATION_REQUIRED
            params:
              filePattern: &quot;metadata.json&quot;
              requiredElements: [&quot;ops_contact&quot;, &quot;sla_tier&quot;]
</code></pre>
<br>
<h2 id="CONDITIONAL_CHECK_RelatedCheckTypes">Related Check Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'PROJECT_CONTEXT')">PROJECT_CONTEXT</a></strong>: Trigger based on project metadata.</li>
<li><strong><a href="#" onclick="showRule(event, 'FILE_EXISTS')">FILE_EXISTS</a></strong>: Trigger based on file presence.</li>
<li>Any standard XML, POM, JSON, or Property check.</li>
</div><div id="GENERIC_PROPERTY_FILE_CHECK" class="rule-content" style="display: none;"><h1>GENERIC_PROPERTY_FILE_CHECK</h1>
<br>
<strong>Primary Capacity:</strong> Structural XML Analysis </td><td> <strong>Validation Target:</strong> XML, POM, Config Archive
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_Overview">Overview</h2>
<br>
A versatile engine for validating property-based configuration files across different environments. It allows for complex validation logic including mandatory keys, forbidden values, and pattern-based format enforcement.
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_UseCases">Use Cases</h2>
<br>
<li>Enforce standard property naming across microservices.</li>
<li>Ensure all environments have matching configuration keys (prevent "forgot to update PROD").</li>
<li>Block hardcoded secrets or environment-specific triggers in production.</li>
<li>Validate the format of critical configuration values (e.g., ports, timeouts, URLs).</li>
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>fileExtensions</code> </td><td> List </td><td> File extensions to scan (e.g., <code class='inline-token'>.properties</code>, <code class='inline-token'>.yaml</code>) </td></tr><tr><td> <code class='inline-token'>environments</code> </td><td> List </td><td> Environment keys to target (e.g., <code class='inline-token'>DEV</code>, <code class='inline-token'>QA</code>, <code class='inline-token'>PROD</code> or <code class='inline-token'>ALL</code>) </td></tr><tr><td> <code class='inline-token'>validationRules</code> </td><td> List<Map> </td><td> A collection of validation logic blocks </td></tr><tr><td> <code class='inline-token'>requiredFields</code> </td><td> Map<String, String> </td><td> Key-value pairs for exact matching (Optional) </td></tr><tr><td> <code class='inline-token'>minVersions</code> </td><td> Map<String, String> </td><td> Key-MinVersion pairs for SemVer check (Optional) </td></tr><tr><td> <code class='inline-token'>exactVersions</code> </td><td> Map<String, String> </td><td> Key-Version pairs for Exact SemVer check (Optional) </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h3>Validation Rule Map</h3>
<br>
<table><tr><td> Field </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>type</code> </td><td> String </td><td> <code class='inline-token'>REQUIRED</code>, <code class='inline-token'>FORBIDDEN</code>, or <code class='inline-token'>FORMAT</code> </td></tr><tr><td> <code class='inline-token'>pattern</code> </td><td> String </td><td> The key or regex pattern to evaluate </td></tr><tr><td> <code class='inline-token'>message</code> </td><td> String </td><td> Custom message to display on failure </td></tr></table>
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Mandatory Boilerplate Properties</h3>
<br>
Ensure that every property file contains the core application identification keys.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-CONFIG-BOILERPLATE&quot;
  name: &quot;Require App Metadata&quot;
  severity: MEDIUM
  checks:
    - type: GENERIC_PROPERTY_FILE_CHECK
      params:
        fileExtensions: [&quot;.properties&quot;]
        environments: [&quot;ALL&quot;]
        validationRules:
          - type: &quot;REQUIRED&quot;
            pattern: &quot;app.id&quot;
          - type: &quot;REQUIRED&quot;
            pattern: &quot;app.version&quot;
</code></pre>
<br>
<h3>Example 2: Type and Format Enforcement</h3>
<br>
Validate that technical configurations like ports and timeouts follow specific numeric or unit-based formats.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-CONFIG-TECHNICAL&quot;
  name: &quot;Technical Format Validation&quot;
  severity: HIGH
  checks:
    - type: GENERIC_PROPERTY_FILE_CHECK
      params:
        fileExtensions: [&quot;.properties&quot;, &quot;.yaml&quot;]
        environments: [&quot;DEV&quot;, &quot;QA&quot;, &quot;PROD&quot;]
        validationRules:
          - type: &quot;FORMAT&quot;
            pattern: &quot;http.port=\\d+&quot;
            message: &quot;Http port must be a numeric integer.\n{DEFAULT_MESSAGE}&quot;
          - type: &quot;FORMAT&quot;
            pattern: &quot;db.timeout=\\d+[ms]&quot;
            message: &quot;Database timeout must include 'ms' unit.\n{DEFAULT_MESSAGE}&quot;
</code></pre>
<br>
<h3>Example 3: Version and Field Validation</h3>
Enforce specific versions and exact field values using standard parameters.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-PROP-STANDARDS&quot;
  name: &quot;Standard Property Validation&quot;
  severity: HIGH
  checks:
    - type: GENERIC_PROPERTY_FILE_CHECK
      params:
        fileExtensions: [&quot;.properties&quot;]
        environments: [&quot;ALL&quot;]
        requiredFields:
          &quot;app.type&quot;: &quot;microservice&quot;
          &quot;deploy.mode&quot;: &quot;blue-green&quot;
        minVersions:
          &quot;lib.version&quot;: &quot;1.2.0&quot;
        exactVersions:
          &quot;fixed.dep&quot;: &quot;3.0.1&quot;
</code></pre>
<br>
<h3>Example 4: Production Security Guardrails</h3>
Block the usage of insecure protocols or hardcoded local development strings in production.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-PROD-SECURITY-KEYS&quot;
  name: &quot;Production Access Guard&quot;
  severity: CRITICAL
  errorMessage: &quot;Production security violation found.\n{DEFAULT_MESSAGE}&quot;
  checks:
    - type: GENERIC_PROPERTY_FILE_CHECK
      params:
        fileExtensions: [&quot;.properties&quot;, &quot;.yaml&quot;]
        environments: [&quot;PROD&quot;]
        validationRules:
          - type: &quot;FORBIDDEN&quot;
            pattern: &quot;auth.mode=local&quot;
            # Overrides the generic error message
            message: &quot;Production must use SSO or external auth.\n{DEFAULT_MESSAGE}&quot;
          - type: &quot;FORBIDDEN&quot;
            pattern: &quot;debug.enabled=true&quot;
</code></pre>
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_ErrorConfigurationCustomization">Error Configuration & Customization</h2>
<br>
You can customize error messages at two levels:
<br>
1.  <strong>Rule Level (Recommended)</strong>: Use <code class='inline-token'>errorMessage</code> at the top level for a consistent message across all failures.
2.  <strong>Check/Rule Level</strong>: Use <code class='inline-token'>message</code> inside <code class='inline-token'>validationRules</code> to provide specific instructions for a single failure type.
<br>
<strong>Both support tokens:</strong>
<li><code class='inline-token'>{DEFAULT_MESSAGE}</code>: Detailed technical reason for the failure.</li>
<li><code class='inline-token'>{CORE_DETAILS}</code>: Alias for default message.</li>
<br>
<pre><code class='language-yaml'>      params:
        property: &quot;api.key&quot;
        mode: EXISTS
        message: &quot;Security violation: Missing mandatory API Key!\n{DEFAULT_MESSAGE}&quot;
</code></pre>
<br>
qa-env.properties: Production must use SSO (found 'auth.mode=local').
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_BestPractices">Best Practices</h2>
<br>
<li><strong>Atomic Rules</strong>: Keep <code class='inline-token'>validationRules</code> focused on specific areas (e.g., separate security rules from formatting rules) for cleaner error reporting.</li>
<li><strong>Cross-Environment Consistency</strong>: Use <code class='inline-token'>environments: [&quot;ALL&quot;]</code> to ensure that if a property is added to <code class='inline-token'>DEV</code>, it is also present (even if empty/placeholder) in <code class='inline-token'>PROD</code>.</li>
<li><strong>Regex Boundaries</strong>: Use anchors (<code class='inline-token'>^</code>, <code class='inline-token'>$</code>) in your patterns if you want to match the whole key or value exactly.</li>
<br>
<h2 id="GENERIC_PROPERTY_FILE_CHECK_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">MANDATORY_PROPERTY_VALUE_CHECK</a></strong> - Deep validation of property values.</li>
<li><strong><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK')">MANDATORY_SUBSTRING_CHECK</a></strong> - Simpler substring checks for config files.</li>
<li><strong><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH')">GENERIC_TOKEN_SEARCH</a></strong> - Advanced text-based search.</li>
</div><div id="MANDATORY_PROPERTY_VALUE_CHECK" class="rule-content" style="display: none;"><h1>MANDATORY_PROPERTY_VALUE_CHECK</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CONFIG</code> </td><td> <strong>Config Engine</strong> </td><td> <code class='inline-token'>.properties</code>
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_Overview">Overview</h2>
<br>
Validates that <strong>required property name-value pairs exist</strong> in environment-specific configuration files. This rule ensures that critical configuration keys are not only present but also set to one of the approved values.
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_UseCases">Use Cases</h2>
<br>
<li>Enforce production-grade log levels (e.g., block <code class='inline-token'>DEBUG</code> in <code class='inline-token'>PROD</code>).</li>
<li>Ensure security features like SSL or authentication are explicitly enabled.</li>
<li>Validate environment-specific type tags (e.g., <code class='inline-token'>environment.type=PROD</code>).</li>
<li>Standardize timeout values or retry counts across different services.</li>
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>fileExtensions</code> </td><td> List </td><td> File extensions to check (e.g., <code class='inline-token'>.properties</code>) </td></tr><tr><td> <code class='inline-token'>environments</code> </td><td> List </td><td> Environment names to check (e.g., <code class='inline-token'>PROD</code>, <code class='inline-token'>ALL</code>) </td></tr><tr><td> <code class='inline-token'>properties</code> </td><td> List<Map> </td><td> List of property configurations </td></tr></table>
<br>
<h3>Property Configuration Map</h3>
<br>
<table><tr><td> Field </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>name</code> </td><td> String </td><td> Exactly matching property key name </td></tr><tr><td> <code class='inline-token'>values</code> </td><td> List </td><td> List of allowed values (OR logic) </td></tr><tr><td> <code class='inline-token'>caseSensitiveName</code> </td><td> Boolean </td><td> Override global name case sensitivity </td></tr><tr><td> <code class='inline-token'>caseSensitiveValue</code> </td><td> Boolean </td><td> Override global value case sensitivity </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>delimiter</code> </td><td> String </td><td> <code class='inline-token'>=</code> </td><td> The character separating key and value </td></tr><tr><td> <code class='inline-token'>caseSensitiveNames</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Global case sensitivity for property names </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Whether value comparison is case-sensitive </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution before validation </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve values from the linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in the linked CONFIG project </td></tr></table>
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Enforce Production Log Level</h3>
Ensure that logging is set to a sustainable level for production environments.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-PROD-LOG-LOCK&quot;
  name: &quot;Production Log Level&quot;
  severity: HIGH
  errorMessage: &quot;Production Log Level violation.\n{DEFAULT_MESSAGE}&quot;
  checks:
    - type: MANDATORY_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [&quot;.properties&quot;]
        environments: [&quot;PROD&quot;]
        properties:
          - name: &quot;log.level&quot;
            values: [&quot;INFO&quot;, &quot;WARN&quot;, &quot;ERROR&quot;]
</code></pre>
<br>
<h3>Example 2: Infrastructure Compliance</h3>
Verify that SSL is enabled and timeout values are within organizational limits.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-INFRA-STANDARDS&quot;
  name: &quot;Required Infrastructure Settings&quot;
  severity: HIGH
  checks:
    - type: MANDATORY_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [&quot;.properties&quot;]
        environments: [&quot;DEV&quot;, &quot;QA&quot;, &quot;PROD&quot;]
        properties:
          - name: &quot;ssl.enabled&quot;
            values: [&quot;true&quot;]
          - name: &quot;connect.timeout&quot;
            values: [&quot;30&quot;, &quot;60&quot;, &quot;120&quot;]
</code></pre>
<br>
<h3>Example 3: Flexible Boolean Validation</h3>
Allow various string representations of "true" or "false" in a case-insensitive manner.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-FLEX-BOOLEAN&quot;
  name: &quot;Boolean Property Validation&quot;
  severity: MEDIUM
  checks:
    - type: MANDATORY_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [&quot;.properties&quot;]
        environments: [&quot;ALL&quot;]
        caseSensitiveValues: false
        properties:
          - name: &quot;debug.mode&quot;
            values: [&quot;true&quot;, &quot;false&quot;, &quot;on&quot;, &quot;off&quot;, &quot;yes&quot;, &quot;no&quot;]
</code></pre>
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>PROD.properties: Property 'log.level' not found in file.
QA.properties: Property 'ssl.enabled' found but value 'false' does not match allowed values [true].
</code></pre>
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_BestPractices">Best Practices</h2>
<br>
<li><strong>Explicit Failures</strong>: This rule fails if the property is missing OR if the value is incorrect. Use it when a configuration must be present and correctly set.</li>
<li><strong>Service-Level Consistency</strong>: Apply these rules to ensure all components in a multi-service architecture use consistent timeout or retry logic.</li>
<li><strong>Environment Targeting</strong>: Heavily use the <code class='inline-token'>environments</code> parameter to apply stricter value requirements to <code class='inline-token'>PROD</code> than to <code class='inline-token'>DEV</code>.</li>
<br>
<h2 id="MANDATORY_PROPERTY_VALUE_CHECK_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK')">OPTIONAL_PROPERTY_VALUE_CHECK</a></strong> - Logic for properties that might not exist.</li>
<li><strong><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK')">MANDATORY_SUBSTRING_CHECK</a></strong> - Validates substrings within property values.</li>
</div><div id="MANDATORY_SUBSTRING_CHECK" class="rule-content" style="display: none;"><h1>MANDATORY_SUBSTRING_CHECK</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CONFIG</code> </td><td> <strong>Config Engine</strong> </td><td> <code class='inline-token'>.properties</code>, <code class='inline-token'>.yaml</code>
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_Overview">Overview</h2>
<br>
Validates that <strong>required or forbidden substrings exist</strong> in environment-specific configuration files. This rule is optimized for filtering configuration files by their environment name (e.g., <code class='inline-token'>DEV.properties</code>, <code class='inline-token'>PROD.yaml</code>), making it an essential tool for cross-environment compliance.
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_UseCases">Use Cases</h2>
<br>
<li>Ensure critical configuration keys (like <code class='inline-token'>api.key</code>) exist in all environment descriptors.</li>
<li>Prevent unsafe settings (e.g., <code class='inline-token'>debug=true</code>) from reaching production configurations.</li>
<li>Enforce mandatory protocol usage (e.g., <code class='inline-token'>https://</code> in callback URLs).</li>
<li>Validate naming conventions or standard placeholders across different build stages.</li>
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_Parameters">Parameters</h2>
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>fileExtensions</code> </td><td> List </td><td> File extensions to scan (e.g., <code class='inline-token'>.properties</code>, <code class='inline-token'>.yaml</code>) </td></tr><tr><td> <code class='inline-token'>tokens</code> </td><td> List </td><td> List of substrings to search for </td></tr><tr><td> <code class='inline-token'>environments</code> </td><td> List </td><td> Environment keys (file basenames) to validate (e.g., <code class='inline-token'>PROD</code>, <code class='inline-token'>ALL</code>) </td></tr></table>
<br>
<h3>Optional Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Default </td><td> Description </td></tr><tr><td> <code class='inline-token'>searchMode</code> </td><td> String </td><td> <code class='inline-token'>REQUIRED</code> </td><td> Choose <code class='inline-token'>REQUIRED</code> or <code class='inline-token'>FORBIDDEN</code> </td></tr><tr><td> <code class='inline-token'>caseSensitive</code> </td><td> Boolean </td><td> <code class='inline-token'>true</code> </td><td> Whether substring matching is case-sensitive </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr><tr><td> <code class='inline-token'>message</code> </td><td> String </td><td> (Default) </td><td> Custom message to display on failure </td></tr><tr><td> <code class='inline-token'>message</code> </td><td> String </td><td> (Default) </td><td> Custom message to display on failure </td></tr></table>
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Required Service Discovery Configuration</h3>
Ensure that all environment property files contain the mandatory service ID and client identification.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-CONFIG-DISCOVERY&quot;
  name: &quot;Required Service Identifiers&quot;
  severity: HIGH
  checks:
    - type: MANDATORY_SUBSTRING_CHECK
      params:
        fileExtensions: [&quot;.properties&quot;]
        environments: [&quot;DEV&quot;, &quot;QA&quot;, &quot;PROD&quot;]
        tokens: [&quot;service.id&quot;, &quot;service.owner&quot;]
        searchMode: REQUIRED
</code></pre>
<br>
<h3>Example 2: Block Insecure Production Flags</h3>
Prevent "debug" or "verbose" flags from being enabled in production configuration files.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-PROD-NO-DEBUG&quot;
  name: &quot;Disable Debug in Production&quot;
  severity: CRITICAL
  checks:
    - type: MANDATORY_SUBSTRING_CHECK
      params:
        fileExtensions: [&quot;.properties&quot;, &quot;.yaml&quot;]
        environments: [&quot;PROD&quot;]
        tokens: [&quot;debug=true&quot;, &quot;verbose.logging=on&quot;]
        searchMode: FORBIDDEN
</code></pre>
<br>
<h3>Example 3: Mandatory Protocol Enforcement</h3>
Ensure that all environments reference security components using standard case-insensitive keywords.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-SECURE-KEYWORDS&quot;
  name: &quot;Mandatory Security Keywords&quot;
  severity: HIGH
  checks:
    - type: MANDATORY_SUBSTRING_CHECK
      params:
        fileExtensions: [&quot;.properties&quot;, &quot;.yaml&quot;]
        environments: [&quot;ALL&quot;]
        tokens: [&quot;ssl&quot;, &quot;tls&quot;, &quot;https&quot;]
        searchMode: REQUIRED
        caseSensitive: false
</code></pre>
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_ErrorConfigurationCustomization">Error Configuration & Customization</h2>
<br>
By default, Aegis generates a technical description of the failure. You can override this by providing a custom <code class='inline-token'>message</code> parameter in your rule configuration.
<br>
<pre><code class='language-yaml'>      params:
        tokens: [&quot;debug=true&quot;]
        searchMode: FORBIDDEN
        message: &quot;Insecure debug flag found! Please disable for production.&quot;
</code></pre>
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_BestPractices">Best Practices</h2>
<br>
<li><strong>Environment Mapping</strong>: This rule relies on matching the <code class='inline-token'>environments</code> list against the filenames. Ensure your configuration files follow a consistent naming pattern (e.g., <code class='inline-token'>ENV_NAME.properties</code>).</li>
<li><strong>Global Enforcement</strong>: Use <code class='inline-token'>environments: [&quot;ALL&quot;]</code> to apply a rule across every discovered environment file automatically.</li>
<li><strong>Substrings vs. Full Values</strong>: Remember that this rule checks for *substrings*. If you need to validate that a property precisely equals a value, use <strong><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">MANDATORY_PROPERTY_VALUE_CHECK</a></strong>.</li>
<br>
<h2 id="MANDATORY_SUBSTRING_CHECK_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'GENERIC_TOKEN_SEARCH')">GENERIC_TOKEN_SEARCH</a></strong> - Similar logic but without environment-specific file filtering.</li>
<li><strong><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">MANDATORY_PROPERTY_VALUE_CHECK</a></strong> - Validates exact key-value pairs.</li>
</div><div id="OPTIONAL_PROPERTY_VALUE_CHECK" class="rule-content" style="display: none;"><h1>OPTIONAL_PROPERTY_VALUE_CHECK</h1>
<br>
<strong>Rule Type:</strong> <code class='inline-token'>CONFIG</code> </td><td> <strong>Config Engine</strong> </td><td> <code class='inline-token'>.properties</code>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_Overview">Overview</h2>
<br>
Validates <strong>optional property values</strong> in configuration files. This rule is designed for settings that are not required for the application to run, but if they are present, they must adhere to specific value constraints.
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_UseCases">Use Cases</h2>
<br>
<li>Validate experimental or feature flags when enabled (e.g., <code class='inline-token'>feature.x=true/false</code>).</li>
<li>Restrict cache provider types if the user chooses to configure caching.</li>
<li>Enforce allowed TTL (Time-To-Live) values for non-mandatory session management.</li>
<li>Validate optional monitoring levels or diagnostic flags.</li>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_Parameters">Parameters</h2>
<br>
Same as <strong><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">MANDATORY_PROPERTY_VALUE_CHECK</a></strong>, but with different validation logic.
<br>
<h3>Required Parameters</h3>
<br>
<table><tr><td> Parameter </td><td> Type </td><td> Description </td></tr><tr><td> <code class='inline-token'>fileExtensions</code> </td><td> List </td><td> File extensions to check (e.g., <code class='inline-token'>.properties</code>) </td></tr><tr><td> <code class='inline-token'>environments</code> </td><td> List </td><td> Environment names to check (e.g., <code class='inline-token'>ALL</code>, <code class='inline-token'>PROD</code>) </td></tr><tr><td> <code class='inline-token'>properties</code> </td><td> List </td><td> List of optional property configurations </td></tr><tr><td> <code class='inline-token'>resolveProperties</code> </td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Enable <code class='inline-token'>${...}</code> resolution </td></tr><tr><td> <code class='inline-token'>resolveLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Resolve from linked CONFIG project </td></tr><tr><td> <code class='inline-token'>includeLinkedConfig</code></td><td> Boolean </td><td> <code class='inline-token'>false</code> </td><td> Scan files in linked CONFIG project </td></tr></table>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_ConfigurationExamples">Configuration Examples</h2>
<br>
<h3>Example 1: Optional Feature Flags</h3>
<br>
Ensure that if a feature toggle is present, it uses valid boolean string values.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-OPTIONAL-TOGGLE&quot;
  name: &quot;Validate Optional Toggles&quot;
  severity: MEDIUM
  errorMessage: &quot;Optional toggle validation failed.\n{DEFAULT_MESSAGE}&quot;
  checks:
    - type: OPTIONAL_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [&quot;.properties&quot;]
        environments: [&quot;ALL&quot;]
        properties:
          - name: &quot;feature.beta.enabled&quot;
            values: [&quot;true&quot;, &quot;false&quot;]
</code></pre>
<br>
<h3>Example 2: Optional Cache Tuning</h3>
<br>
Restrict choices for cache providers and durations when developers choose to override defaults.
<br>
<pre><code class='language-yaml'>- id: &quot;RULE-OPTIONAL-CACHE&quot;
  name: &quot;Optional Cache Settings&quot;
  severity: LOW
  checks:
    - type: OPTIONAL_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [&quot;.properties&quot;]
        environments: [&quot;DEV&quot;, &quot;QA&quot;, &quot;PROD&quot;]
        properties:
          - name: &quot;cache.provider&quot;
            values: [&quot;memory&quot;, &quot;redis&quot;, &quot;in-memory&quot;]
          - name: &quot;cache.timeout&quot;
            values: [&quot;300&quot;, &quot;600&quot;, &quot;3600&quot;]
</code></pre>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_ValidationLogic">Validation Logic</h2>
<br>
<li><strong>‚úÖ PASS</strong>: Property is NOT found in the configuration file (since it is optional).</li>
<li><strong>‚úÖ PASS</strong>: Property is found and its value matches one of the allowed <code class='inline-token'>values</code>.</li>
<li><strong>‚ùå FAIL</strong>: Property is found but its value is NOT in the allowed list.</li>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_ErrorMessages">Error Messages</h2>
<br>
<pre><code class='language-text'>dev.properties: Optional property 'cache.provider' found but value 'custom-val' does not match allowed choices [memory, redis, in-memory].
</code></pre>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_BestPractices">Best Practices</h2>
<br>
<li><strong>Use for "Nice to Have" Rules</strong>: This is ideal for validating developer-facing flags or performance tuning parameters where a default exists in code if the property is missing.</li>
<li><strong>Environment Variance</strong>: Even for optional properties, you can restrict <code class='inline-token'>PROD</code> to a subset of <code class='inline-token'>DEV</code> values (e.g., only allowing certain cache providers in a production cloud environment).</li>
<li><strong>Documentation</strong>: Use the <code class='inline-token'>values</code> list to document allowed types for other team members.</li>
<br>
<h2 id="OPTIONAL_PROPERTY_VALUE_CHECK_RelatedRuleTypes">Related Rule Types</h2>
<br>
<li><strong><a href="#" onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">MANDATORY_PROPERTY_VALUE_CHECK</a></strong> - For properties that MUST be present.</li>
<li><strong><a href="#" onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK')">MANDATORY_SUBSTRING_CHECK</a></strong> - For validating parts of property values.</li>
</div>
        </div>
    </div>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                var path = window.location.pathname;
                var isReport = path.includes('/reports/');
                var isStandalone = path.endsWith('/rule_guide.html');
                var dashboardBtn = document.getElementById('dashboardBtn');
                var mainPageBtn = document.getElementById('mainPageBtn');

                var isInMuleWrapper = path.includes('/apiguard/');
                var basePath = isInMuleWrapper ? '/apiguard/aegis' : '';

                var sessionId = new URLSearchParams(window.location.search).get('session');
                if (!sessionId && isReport) {
                    var parts = path.split('/reports/');
                    if (parts.length > 1) {
                        var subparts = parts[1].split('/');
                        if (subparts.length > 0) sessionId = subparts[0];
                    }
                }

                if (dashboardBtn) {
                    if (isStandalone) {
                        dashboardBtn.innerText = "Home";
                        dashboardBtn.href = basePath + "/";
                        dashboardBtn.title = "Go to Main Page";
                        dashboardBtn.style.display = 'inline-block';
                        if (mainPageBtn) mainPageBtn.style.display = 'none';
                    } else {
                        dashboardBtn.style.display = 'inline-block';
                    }
                }

                if (isReport && mainPageBtn) {
                    mainPageBtn.style.display = 'inline-block';
                    var mainPageUrl = basePath + '/';
                    if (!isInMuleWrapper) mainPageUrl = '/';
                    if (sessionId) mainPageUrl += '?session=' + sessionId;
                    mainPageBtn.href = mainPageUrl;
                }
            });
        </script>
</body>
</html>
