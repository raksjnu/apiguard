<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>MuleGuard - Rule Guide</title>
  <style>
    :root {
      --truist-purple: #663399;
      --truist-purple-light: #7d4fb2;
      --text-white: #FFFFFF;
      --sidebar-width: 300px;
    }

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #f0f0f0;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    .sidebar {
      width: var(--sidebar-width);
      background: white;
      border-right: 1px solid #ddd;
      display: flex;
      flex-direction: column;
      height: 100%;
      /* Removed native resize to use custom handle */
      overflow: auto;
      min-width: 200px;
      max-width: 600px;
      flex-shrink: 0;
    }

    .sidebar-header {
      padding: 20px;
      background: var(--truist-purple);
      color: white;
    }

    .sidebar-header h2 {
      margin: 0;
      font-size: 1.2rem;
      color: white;
    }

    .sidebar-nav {
      flex: 1;
      overflow-y: auto;
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar-nav li a {
      display: block;
      padding: 15px 20px;
      color: #333;
      text-decoration: none;
      border-bottom: 1px solid #eee;
      transition: background 0.2s;
    }

    .sidebar-nav li a:hover {
      background: #f5f5f5;
    }

    .sidebar-nav li a.active {
      background: var(--truist-purple-light);
      color: white;
    }

    /* Custom Resizer Handle */
    .resizer {
      width: 5px;
      background-color: #ddd;
      cursor: col-resize;
      height: 100%;
      flex-shrink: 0;
      transition: background-color 0.2s;
    }

    .resizer:hover,
    .resizer.resizing {
      background-color: var(--truist-purple);
    }

    .main-content {
      flex: 1;
      padding: 40px;
      overflow-y: auto;
      background: #f9f9f9;
      position: relative;
      /* Context for absolute positioning */
    }

    .report-container {
      background: white;
      padding: 40px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      max-width: 1000px;
      margin: 0 auto;
      border: 5px solid var(--truist-purple);
      position: relative;
    }

    /* Top Nav Button Style */
    .top-nav-container {
      position: absolute;
      top: 20px;
      right: 40px;
      display: flex;
      gap: 10px;
      z-index: 100;
    }

    .top-nav-button {
      background-color: var(--truist-purple);
      color: var(--text-white);
      border: none;
      padding: 8px 16px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      border-radius: 5px;
      transition: background-color 0.3s ease;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .top-nav-button:hover {
      background-color: var(--truist-purple-light);
    }

    /* Markdown Styles */
    h1 {
      color: var(--truist-purple);
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
      margin-top: 0;
    }

    /* Added margin-top: 0 */
    h2 {
      color: #444;
      margin-top: 30px;
    }

    h3 {
      color: #666;
    }

    pre {
      background: #f4f4f4;
      padding: 15px;
      border-radius: 5px;
      overflow-x: auto;
      border: 1px solid #ddd;
    }

    code {
      font-family: Consolas, monospace;
      color: #d63384;
    }

    pre code {
      color: #333;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      margin: 20px 0;
    }

    th,
    td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: left;
    }

    th {
      background: #f1f1f1;
    }

    blockquote {
      border-left: 4px solid var(--truist-purple);
      margin: 0;
      padding-left: 20px;
      color: #555;
    }
  </style>
  <script>
    function showRule(event, ruleId) {
      event.preventDefault();

      // Hide all content
      document.querySelectorAll('.rule-content').forEach(el => el.style.display = 'none');
      // Show selected
      document.getElementById(ruleId).style.display = 'block';

      // Update active nav
      document.querySelectorAll('.sidebar-nav a').forEach(el => el.classList.remove('active'));
      event.target.classList.add('active');
    }

    // Resizer Logic
    document.addEventListener('DOMContentLoaded', function () {
      const sidebar = document.getElementById('sidebar');
      const resizer = document.getElementById('resizer');

      if (!sidebar || !resizer) return; // Guard clause

      let isResizing = false;

      resizer.addEventListener('mousedown', function (e) {
        isResizing = true;
        resizer.classList.add('resizing');
        document.body.style.cursor = 'col-resize'; // enforce cursor
        document.body.style.userSelect = 'none'; // prevent text selection
      });

      document.addEventListener('mousemove', function (e) {
        if (!isResizing) return;
        const newWidth = e.clientX;
        // Min/Max constraints (match CSS)
        if (newWidth > 200 && newWidth < 600) {
          sidebar.style.width = newWidth + 'px';
        }
      });

      document.addEventListener('mouseup', function (e) {
        if (isResizing) {
          isResizing = false;
          resizer.classList.remove('resizing');
          document.body.style.cursor = '';
          document.body.style.userSelect = '';
        }
      });
    });
  </script>
</head>

<body>
  <div class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h2>MuleGuard Rules</h2>
    </div>
    <ul class="sidebar-nav">
      <li><a href='#' class='active' onclick="showRule(event, 'CLIENTIDMAP_VALIDATOR')">CLIENTIDMAP_VALIDATOR</a></li>
      <li><a href='#' class='' onclick="showRule(event, 'GENERIC_PROPERTY_FILE_CHECK')">GENERIC_PROPERTY_FILE_CHECK</a>
      </li>
      <li><a href='#' class='' onclick="showRule(event, 'GENERIC_TOKEN_SEARCH')">GENERIC_TOKEN_SEARCH</a></li>
      <li><a href='#' class=''
          onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_FORBIDDEN')">GENERIC_TOKEN_SEARCH_FORBIDDEN</a></li>
      <li><a href='#' class=''
          onclick="showRule(event, 'GENERIC_TOKEN_SEARCH_REQUIRED')">GENERIC_TOKEN_SEARCH_REQUIRED</a></li>
      <li><a href='#' class='' onclick="showRule(event, 'JSON_VALIDATION_FORBIDDEN')">JSON_VALIDATION_FORBIDDEN</a></li>
      <li><a href='#' class='' onclick="showRule(event, 'JSON_VALIDATION_REQUIRED')">JSON_VALIDATION_REQUIRED</a></li>
      <li><a href='#' class=''
          onclick="showRule(event, 'MANDATORY_PROPERTY_VALUE_CHECK')">MANDATORY_PROPERTY_VALUE_CHECK</a></li>
      <li><a href='#' class='' onclick="showRule(event, 'MANDATORY_SUBSTRING_CHECK')">MANDATORY_SUBSTRING_CHECK</a></li>
      <li><a href='#' class=''
          onclick="showRule(event, 'OPTIONAL_PROPERTY_VALUE_CHECK')">OPTIONAL_PROPERTY_VALUE_CHECK</a></li>
      <li><a href='#' class='' onclick="showRule(event, 'POM_VALIDATION_FORBIDDEN')">POM_VALIDATION_FORBIDDEN</a></li>
      <li><a href='#' class='' onclick="showRule(event, 'POM_VALIDATION_REQUIRED')">POM_VALIDATION_REQUIRED</a></li>
      <li><a href='#' class='' onclick="showRule(event, 'XML_ATTRIBUTE_EXISTS')">XML_ATTRIBUTE_EXISTS</a></li>
      <li><a href='#' class='' onclick="showRule(event, 'XML_ATTRIBUTE_NOT_EXISTS')">XML_ATTRIBUTE_NOT_EXISTS</a></li>
      <li><a href='#' class=''
          onclick="showRule(event, 'XML_ELEMENT_CONTENT_FORBIDDEN')">XML_ELEMENT_CONTENT_FORBIDDEN</a></li>
      <li><a href='#' class=''
          onclick="showRule(event, 'XML_ELEMENT_CONTENT_REQUIRED')">XML_ELEMENT_CONTENT_REQUIRED</a></li>
      <li><a href='#' class='' onclick="showRule(event, 'XML_XPATH_EXISTS')">XML_XPATH_EXISTS</a></li>
      <li><a href='#' class='' onclick="showRule(event, 'XML_XPATH_NOT_EXISTS')">XML_XPATH_NOT_EXISTS</a></li>
    </ul>
  </div>
  <div class="resizer" id="resizer"></div>
  <div class="main-content">
    <div class="top-nav-container">
      <a href="index.html" id="dashboardBtn" class="top-nav-button" title="Return to home">üè† Home</a>
    </div>
    <div class="report-container">
      <div id='CLIENTIDMAP_VALIDATOR' class='rule-content' style='display: block;'>
        <h1>CLIENTIDMAP_VALIDATOR</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Specialized validator for <strong>client ID mapping</strong> and <strong>secure property</strong> validation.
        Ensures client ID mappings follow specific patterns and secure properties are properly configured.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Validate client ID mapping format</li>
        <li>Ensure secure property references</li>
        <li>Check API key configurations</li>
        <li>Enforce security standards for credentials</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>fileExtensions</code> </td>
          <td> List<String>
          </td>
          <td> File extensions to check (typically <code>.properties</code>) </td>
        </tr>
        <tr>
          <td> <code>environments</code> </td>
          <td> List<String>
          </td>
          <td> Environment names to validate </td>
        </tr>
        <br>
        <h2>Built-in Validations</h2>
        <br>
        This rule performs the following checks automatically:
        <br>
        1. <strong>Client ID Format</strong>: Validates <code>clientId</code> properties match expected patterns
        2. <strong>Secure Properties</strong>: Ensures sensitive properties use <code>${secure::...}</code> syntax
        3. <strong>API Key Format</strong>: Validates API key references follow standards
        4. <strong>Credential Patterns</strong>: Checks for proper credential configuration
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Basic Client ID Validation</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-160"</li>
  name: "Client ID Mapping Validation"
  description: "Validate client ID mappings in all environments"
  enabled: true
  severity: HIGH
  checks:
    - type: CLIENTIDMAP_VALIDATOR
      params:
        fileExtensions: [".properties"]
        environments: ["DEV", "QA", "PROD"]
</code></pre>
        <br>
        <h3>Example 2: Production-Only Validation</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-161"</li>
  name: "Production Client ID Security"
  description: "Strict client ID validation for production"
  enabled: true
  severity: CRITICAL
  checks:
    - type: CLIENTIDMAP_VALIDATOR
      params:
        fileExtensions: [".properties"]
        environments: ["PROD"]
</code></pre>
        <br>
        <h2>Validation Rules</h2>
        <br>
        The validator checks for:
        <br>
        <li>‚úÖ Proper <code>clientId</code> format (alphanumeric with hyphens/underscores)</li>
        <li>‚úÖ Secure property syntax: <code>${secure::propertyName}</code></li>
        <li>‚úÖ No hardcoded credentials</li>
        <li>‚úÖ Valid API key references</li>
        <li>‚ùå Plain text passwords or secrets</li>
        <li>‚ùå Invalid client ID patterns</li>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
PROD.properties: Invalid client ID format detected
DEV.properties: Secure property must use ${secure::...} syntax
QA.properties: Hardcoded credential detected - use secure properties
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[MANDATORY_PROPERTY_VALUE_CHECK](MANDATORY_PROPERTY_VALUE_CHECK.md)</strong> - General property
          validation</li>
        <li><strong>[MANDATORY_SUBSTRING_CHECK](MANDATORY_SUBSTRING_CHECK.md)</strong> - Token-based validation</li>
      </div>
      <div id='GENERIC_PROPERTY_FILE_CHECK' class='rule-content' style='display: none;'>
        <h1>GENERIC_PROPERTY_FILE_CHECK</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Generic property file validation with flexible configuration options. Provides comprehensive validation for
        property files across environments.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>General property file validation</li>
        <li>Multi-environment configuration checks</li>
        <li>Property format validation</li>
        <li>Configuration completeness verification</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>fileExtensions</code> </td>
          <td> List<String>
          </td>
          <td> File extensions to check </td>
        </tr>
        <tr>
          <td> <code>environments</code> </td>
          <td> List<String>
          </td>
          <td> Environment names to validate </td>
        </tr>
        <tr>
          <td> <code>validationRules</code> </td>
          <td> List<Map> </td>
          <td> Custom validation rules </td>
        </tr>
        <br>
        <h4>Validation Rule Map</h4>
        <br>
        <tr>
          <td> Field </td>
          <td> Type </td>
          <td> Required </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>type</code> </td>
          <td> String </td>
          <td> Yes </td>
          <td> Validation type: <code>REQUIRED</code>, <code>FORBIDDEN</code>, <code>FORMAT</code> </td>
        </tr>
        <tr>
          <td> <code>pattern</code> </td>
          <td> String </td>
          <td> Yes </td>
          <td> Pattern to match or validate </td>
        </tr>
        <tr>
          <td> <code>message</code> </td>
          <td> String </td>
          <td> No </td>
          <td> Custom error message </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Basic Property Validation</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-170"</li>
  name: "Property File Format Validation"
  description: "Validate property file format and required keys"
  enabled: true
  severity: MEDIUM
  checks:
    - type: GENERIC_PROPERTY_FILE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["ALL"]
        validationRules:
          - type: "REQUIRED"
            pattern: "app.name"
          - type: "REQUIRED"
            pattern: "app.version"
</code></pre>
        <br>
        <h3>Example 2: Format Validation</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-171"</li>
  name: "Property Value Format"
  description: "Ensure property values follow expected formats"
  enabled: true
  severity: LOW
  checks:
    - type: GENERIC_PROPERTY_FILE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["DEV", "QA", "PROD"]
        validationRules:
          - type: "FORMAT"
            pattern: "port=\\d+"
            message: "Port must be numeric"
          - type: "FORMAT"
            pattern: "timeout=\\d+[smh]"
            message: "Timeout must include unit (s/m/h)"
</code></pre>
        <br>
        <h3>Example 3: Forbidden Patterns</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-172"</li>
  name: "No Hardcoded Values"
  description: "Prevent hardcoded values in property files"
  enabled: true
  severity: HIGH
  checks:
    - type: GENERIC_PROPERTY_FILE_CHECK
      params:
        fileExtensions: [".properties", ".yaml"]
        environments: ["PROD"]
        validationRules:
          - type: "FORBIDDEN"
            pattern: "password=.*"
            message: "Passwords must use secure properties"
          - type: "FORBIDDEN"
            pattern: "localhost"
            message: "No hardcoded localhost in production"
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
PROD.properties: Required property 'app.name' not found
DEV.properties: Port must be numeric (validation failed for 'port=abc')
QA.properties: No hardcoded localhost in production
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[MANDATORY_PROPERTY_VALUE_CHECK](MANDATORY_PROPERTY_VALUE_CHECK.md)</strong> - Specific
          property-value validation</li>
        <li><strong>[MANDATORY_SUBSTRING_CHECK](MANDATORY_SUBSTRING_CHECK.md)</strong> - Token-based validation</li>
        <li><strong>[GENERIC_TOKEN_SEARCH](GENERIC_TOKEN_SEARCH.md)</strong> - Advanced token search</li>
      </div>
      <div id='GENERIC_TOKEN_SEARCH' class='rule-content' style='display: none;'>
        <h1>GENERIC_TOKEN_SEARCH</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Advanced token search with <strong>environment filtering</strong> and <strong>regex support</strong>. This is
        the config-specific version of GENERIC_TOKEN_SEARCH_REQUIRED/FORBIDDEN with additional environment awareness.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Complex token validation with environment filtering</li>
        <li>Regex-based pattern matching in config files</li>
        <li>Environment-specific validation rules</li>
        <li>Advanced configuration compliance checks</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>filePatterns</code> </td>
          <td> List<String>
          </td>
          <td> Glob patterns to match files </td>
        </tr>
        <tr>
          <td> <code>tokens</code> </td>
          <td> List<String>
          </td>
          <td> List of tokens to search for </td>
        </tr>
        <br>
        <h3>Optional Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Default </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>environments</code> </td>
          <td> List<String>
          </td>
          <td> <code>null</code> </td>
          <td> Filter files by environment names </td>
        </tr>
        <tr>
          <td> <code>searchMode</code> </td>
          <td> String </td>
          <td> <code>FORBIDDEN</code> </td>
          <td> <code>REQUIRED</code> or <code>FORBIDDEN</code> </td>
        </tr>
        <tr>
          <td> <code>matchMode</code> </td>
          <td> String </td>
          <td> <code>SUBSTRING</code> </td>
          <td> <code>SUBSTRING</code>, <code>REGEX</code>, or <code>ELEMENT_ATTRIBUTE</code> </td>
        </tr>
        <tr>
          <td> <code>elementName</code> </td>
          <td> String </td>
          <td> <code>null</code> </td>
          <td> For XML element-specific searches </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Environment-Specific Token Search</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-150"</li>
  name: "No Hardcoded Localhost in Production"
  description: "Production configs must not contain localhost"
  enabled: true
  severity: CRITICAL
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: ["*.properties"]
        environments: ["PROD"]
        tokens: ["localhost", "127.0.0.1"]
        searchMode: FORBIDDEN
</code></pre>
        <br>
        <h3>Example 2: Regex Pattern with Environment Filter</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-151"</li>
  name: "IP Address Detection in Config"
  description: "Detect hardcoded IP addresses in QA and PROD configs"
  enabled: true
  severity: HIGH
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: ["*.yaml", "*.properties"]
        environments: ["QA", "PROD"]
        tokens: ["\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b"]
        matchMode: REGEX
        searchMode: FORBIDDEN
</code></pre>
        <br>
        <h3>Example 3: Required Token in All Environments</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-152"</li>
  name: "API Key Configuration Required"
  description: "All environment configs must reference API key property"
  enabled: true
  severity: HIGH
  checks:
    - type: GENERIC_TOKEN_SEARCH
      params:
        filePatterns: ["*.properties"]
        environments: ["ALL"]
        tokens: ["${api.key}", "${secure::api.key}"]
        searchMode: REQUIRED
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
PROD.properties: Forbidden token 'localhost' found in file
QA.yaml: Required token(s) not found in files matching: *.yaml
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[GENERIC_TOKEN_SEARCH_REQUIRED](GENERIC_TOKEN_SEARCH_REQUIRED.md)</strong> - Code-specific version
        </li>
        <li><strong>[GENERIC_TOKEN_SEARCH_FORBIDDEN](GENERIC_TOKEN_SEARCH_FORBIDDEN.md)</strong> - Code-specific version
        </li>
        <li><strong>[MANDATORY_SUBSTRING_CHECK](MANDATORY_SUBSTRING_CHECK.md)</strong> - Simpler config-specific
          validation</li>
      </div>
      <div id='GENERIC_TOKEN_SEARCH_FORBIDDEN' class='rule-content' style='display: none;'>
        <h1>GENERIC_TOKEN_SEARCH_FORBIDDEN</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that <strong>forbidden tokens do NOT exist</strong> in files matching specified patterns. This rule
        <strong>fails</strong> if any forbidden token <strong>IS found</strong>.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Prevent usage of deprecated APIs or functions</li>
        <li>Block hardcoded credentials or sensitive data</li>
        <li>Disallow specific libraries or imports</li>
        <li>Enforce coding standards by blocking anti-patterns</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>filePatterns</code> </td>
          <td> List<String>
          </td>
          <td> Glob patterns to match files (e.g., <code>**/*.xml</code>, <code>src/main/mule/*.xml</code>) </td>
        </tr>
        <tr>
          <td> <code>tokens</code> </td>
          <td> List<String>
          </td>
          <td> List of tokens that must NOT be found </td>
        </tr>
        <br>
        <h3>Optional Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Default </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>excludePatterns</code> </td>
          <td> List<String>
          </td>
          <td> <code>[]</code> </td>
          <td> Glob patterns to exclude files </td>
        </tr>
        <tr>
          <td> <code>matchMode</code> </td>
          <td> String </td>
          <td> <code>SUBSTRING</code> </td>
          <td> <code>SUBSTRING</code> or <code>REGEX</code> - how to match tokens </td>
        </tr>
        <tr>
          <td> <code>caseSensitive</code> </td>
          <td> Boolean </td>
          <td> <code>true</code> </td>
          <td> Whether token matching is case-sensitive </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Block Deprecated Function</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-010"</li>
  name: "No Deprecated toBase64 Function"
  description: "Prevent usage of deprecated toBase64() function"
  enabled: true
  severity: HIGH
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns:
          - "**/*.dwl"
        tokens:
          - "toBase64()"
</code></pre>
        <br>
        <h3>Example 2: Block Hardcoded Credentials</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-011"</li>
  name: "No Hardcoded Passwords"
  description: "Prevent hardcoded passwords in configuration files"
  enabled: true
  severity: CRITICAL
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns:
          - "**/*.xml"
          - "**/*.properties"
        tokens:
          - "password="
          - "pwd="
          - "secret="
        caseSensitive: false
</code></pre>
        <br>
        <h3>Example 3: Block IP Addresses (Regex)</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-012"</li>
  name: "No Hardcoded IP Addresses"
  description: "Prevent hardcoded IP addresses in code"
  enabled: true
  severity: HIGH
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns:
          - "src/main/mule/**/*.xml"
        excludePatterns:
          - "<strong>/test/</strong>"
        tokens:
          - "\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b"  # IP address pattern
        matchMode: REGEX
</code></pre>
        <br>
        <h3>Example 4: Block Multiple Deprecated APIs</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-013"</li>
  name: "No Deprecated Mule Components"
  description: "Block usage of deprecated Mule 3 components"
  enabled: true
  severity: MEDIUM
  checks:
    - type: GENERIC_TOKEN_SEARCH_FORBIDDEN
      params:
        filePatterns:
          - "**/*.xml"
        tokens:
          - "http://www.mulesoft.org/schema/mule/http-deprecated"
          - "mule-transport-"
          - "endpoint-ref"
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        When validation fails, you'll see messages like:
        <br>
        <pre><code>
config.xml has forbidden token: toBase64()
application.properties has forbidden token: password=
main.xml has forbidden token: 192.168.1.1
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[GENERIC_TOKEN_SEARCH_REQUIRED](GENERIC_TOKEN_SEARCH_REQUIRED.md)</strong> - Opposite: ensures
          tokens DO exist</li>
        <li><strong>[XML_XPATH_NOT_EXISTS](XML_XPATH_NOT_EXISTS.md)</strong> - More precise XML validation using XPath
        </li>
        <li><strong>[MANDATORY_SUBSTRING_CHECK](MANDATORY_SUBSTRING_CHECK.md)</strong> - Config-specific validation with
          searchMode: FORBIDDEN</li>
      </div>
      <div id='GENERIC_TOKEN_SEARCH_REQUIRED' class='rule-content' style='display: none;'>
        <h1>GENERIC_TOKEN_SEARCH_REQUIRED</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that <strong>required tokens exist</strong> in files matching specified patterns. This rule
        <strong>fails</strong> if any required token is <strong>NOT found</strong>.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Ensure specific imports are present in code files</li>
        <li>Verify required configuration keys exist</li>
        <li>Validate presence of mandatory comments or annotations</li>
        <li>Check for required DataWeave functions or variables</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>filePatterns</code> </td>
          <td> List<String>
          </td>
          <td> Glob patterns to match files (e.g., <code>**/*.xml</code>, <code>src/main/mule/*.xml</code>) </td>
        </tr>
        <tr>
          <td> <code>tokens</code> </td>
          <td> List<String>
          </td>
          <td> List of tokens that must be found </td>
        </tr>
        <br>
        <h3>Optional Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Default </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>excludePatterns</code> </td>
          <td> List<String>
          </td>
          <td> <code>[]</code> </td>
          <td> Glob patterns to exclude files </td>
        </tr>
        <tr>
          <td> <code>matchMode</code> </td>
          <td> String </td>
          <td> <code>SUBSTRING</code> </td>
          <td> <code>SUBSTRING</code> or <code>REGEX</code> - how to match tokens </td>
        </tr>
        <tr>
          <td> <code>caseSensitive</code> </td>
          <td> Boolean </td>
          <td> <code>true</code> </td>
          <td> Whether token matching is case-sensitive </td>
        </tr>
        <tr>
          <td> <code>requireAll</code> </td>
          <td> Boolean </td>
          <td> <code>true</code> </td>
          <td> If <code>true</code>, ALL tokens must be found. If <code>false</code>, at least ONE token must be found
          </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Basic - Ensure Required Import Exists</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-001"</li>
  name: "Required Logger Import"
  description: "Ensure all XML files import the logger component"
  enabled: true
  severity: MEDIUM
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns:
          - "**/*.xml"
        tokens:
          - "http://www.mulesoft.org/schema/mule/logger"
        caseSensitive: true
</code></pre>
        <br>
        <h3>Example 2: Advanced - Regex Pattern with OR Logic</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-002"</li>
  name: "Required Error Handling"
  description: "Ensure error handling is present (on-error-continue OR on-error-propagate)"
  enabled: true
  severity: HIGH
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns:
          - "src/main/mule/**/*.xml"
        excludePatterns:
          - "<strong>/test/</strong>"
        tokens:
          - "on-error-continue"
          - "on-error-propagate"
        matchMode: SUBSTRING
        requireAll: false  # At least ONE must exist
</code></pre>
        <br>
        <h3>Example 3: Case-Insensitive Search</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-003"</li>
  name: "Required API Documentation"
  description: "Ensure API documentation keywords are present"
  enabled: true
  severity: LOW
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns:
          - "**/*.dwl"
        tokens:
          - "description"
          - "summary"
        caseSensitive: false
        requireAll: false
</code></pre>
        <br>
        <h3>Example 4: Regex Pattern Matching</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-004"</li>
  name: "Required Version Pattern"
  description: "Ensure version number follows semantic versioning"
  enabled: true
  severity: MEDIUM
  checks:
    - type: GENERIC_TOKEN_SEARCH_REQUIRED
      params:
        filePatterns:
          - "**/pom.xml"
        tokens:
          - "\\d+\\.\\d+\\.\\d+"  # Regex: X.Y.Z format
        matchMode: REGEX
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        When validation fails, you'll see messages like:
        <br>
        <pre><code>
config.xml is missing required token: http://www.mulesoft.org/schema/mule/logger
main.dwl is missing required token: description
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[GENERIC_TOKEN_SEARCH_FORBIDDEN](GENERIC_TOKEN_SEARCH_FORBIDDEN.md)</strong> - Opposite: ensures
          tokens do NOT exist</li>
        <li><strong>[XML_XPATH_EXISTS](XML_XPATH_EXISTS.md)</strong> - More precise XML validation using XPath</li>
        <li><strong>[MANDATORY_SUBSTRING_CHECK](MANDATORY_SUBSTRING_CHECK.md)</strong> - Config-specific token
          validation with environment filtering</li>
      </div>
      <div id='JSON_VALIDATION_FORBIDDEN' class='rule-content' style='display: none;'>
        <h1>JSON_VALIDATION_FORBIDDEN</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that <strong>forbidden JSON elements do NOT exist</strong> in JSON files. This rule
        <strong>fails</strong> if forbidden elements <strong>ARE found</strong>.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Prevent deprecated configuration keys</li>
        <li>Block specific JSON fields</li>
        <li>Disallow certain metadata in JSON files</li>
        <li>Enforce JSON structure restrictions</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>filePattern</code> </td>
          <td> String </td>
          <td> Filename pattern to match (e.g., <code>mule-artifact.json</code>) </td>
        </tr>
        <tr>
          <td> <code>forbiddenElements</code> </td>
          <td> List<String>
          </td>
          <td> List of forbidden JSON keys (top-level only) </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Block Deprecated Fields</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-110"</li>
  name: "No Deprecated Mule Artifact Fields"
  description: "Prevent usage of deprecated fields in mule-artifact.json"
  enabled: true
  severity: MEDIUM
  checks:
    - type: JSON_VALIDATION_FORBIDDEN
      params:
        filePattern: "mule-artifact.json"
        forbiddenElements:
          - "deprecatedField"
          - "legacyConfig"
</code></pre>
        <br>
        <h3>Example 2: Block Sensitive Data</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-111"</li>
  name: "No Credentials in Config JSON"
  description: "Prevent hardcoded credentials in JSON configuration"
  enabled: true
  severity: CRITICAL
  checks:
    - type: JSON_VALIDATION_FORBIDDEN
      params:
        filePattern: "config.json"
        forbiddenElements:
          - "password"
          - "apiKey"
          - "secret"
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
mule-artifact.json has forbidden element: deprecatedField
config.json has forbidden element: password
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[JSON_VALIDATION_REQUIRED](JSON_VALIDATION_REQUIRED.md)</strong> - Opposite: ensures elements DO
          exist</li>
        <li><strong>[GENERIC_TOKEN_SEARCH_FORBIDDEN](GENERIC_TOKEN_SEARCH_FORBIDDEN.md)</strong> - More flexible JSON
          content validation</li>
      </div>
      <div id='JSON_VALIDATION_REQUIRED' class='rule-content' style='display: none;'>
        <h1>JSON_VALIDATION_REQUIRED</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that <strong>required JSON elements exist</strong> in JSON files. This rule is essential for
        validating <code>mule-artifact.json</code> and other configuration files. It supports <strong>version
          checking</strong>, <strong>specific field value validation</strong>, and <strong>field existence
          checks</strong>.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Validate <code>mule-artifact.json</code> structure and Mule runtime versions</li>
        <li>Ensure required configuration keys exist in custom JSON config files</li>
        <li>Enforce specific values for critical JSON fields (e.g., javaVersion)</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>filePattern</code> </td>
          <td> String </td>
          <td> Precise filename to match (e.g., <code>mule-artifact.json</code>) </td>
        </tr>
        <br>
        <h3>Validation Parameters (Must configure at least one)</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>minVersions</code> </td>
          <td> Map </td>
          <td> Checks if a field's version string is >= specified version (e.g., "4.4.0") </td>
        </tr>
        <tr>
          <td> <code>requiredFields</code> </td>
          <td> Map </td>
          <td> Checks if a field exists AND has a specifically required value </td>
        </tr>
        <tr>
          <td> <code>requiredElements</code> </td>
          <td> List </td>
          <td> Checks if a field simply exists (value ignored) </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Full Mule Artifact Validation</h3>
        Validates minimum Mule version, required Java version, and presence of secure properties.
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-007"</li>
  name: "Validate mule-artifact.json"
  description: "Ensures mule-artifact.json meets minimum runtime and security requirements"
  enabled: true
  severity: HIGH
  checks:
    - type: JSON_VALIDATION_REQUIRED
      params:
        filePattern: "mule-artifact.json"
        
        # Check minimum version (Numeric comparison)
        minVersions:
          minMuleVersion: "4.9.0"
          
        # Check exact values
        requiredFields:
          javaSpecificationVersions: "17"
          
        # Check simple existence
        requiredElements:
          - "secureProperties"
          - "classLoaderModelLoaderDescriptor"
</code></pre>
        <br>
        <h3>Example 2: Simple Config Existence</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-101"</li>
  name: "App Config Required Fields"
  enabled: true
  checks:
    - type: JSON_VALIDATION_REQUIRED
      params:
        filePattern: "app-config.json"
        requiredElements:
          - "appName"
          - "environment"
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
Field 'minMuleVersion' version too low in mule-artifact.json: expected >= 4.9.0, got 4.4.0
Field 'javaSpecificationVersions' has wrong value in mule-artifact.json: expected '17', got '8'
Element 'secureProperties' missing in mule-artifact.json
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[JSON_VALIDATION_FORBIDDEN](JSON_VALIDATION_FORBIDDEN.md)</strong> - Opposite: ensures elements do
          NOT exist</li>
      </div>
      <div id='MANDATORY_PROPERTY_VALUE_CHECK' class='rule-content' style='display: none;'>
        <h1>MANDATORY_PROPERTY_VALUE_CHECK</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that <strong>required property name-value pairs exist</strong> in environment-specific configuration
        files. Ensures properties have correct values.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Validate property values match expected values</li>
        <li>Ensure configuration correctness across environments</li>
        <li>Check for required property settings</li>
        <li>Enforce configuration standards</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>fileExtensions</code> </td>
          <td> List<String>
          </td>
          <td> File extensions to check (e.g., <code>.properties</code>) </td>
        </tr>
        <tr>
          <td> <code>environments</code> </td>
          <td> List<String>
          </td>
          <td> Environment names to check </td>
        </tr>
        <tr>
          <td> <code>properties</code> </td>
          <td> List<Map> </td>
          <td> List of property configurations </td>
        </tr>
        <br>
        <h4>Property Configuration Map</h4>
        <br>
        <tr>
          <td> Field </td>
          <td> Type </td>
          <td> Required </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>name</code> </td>
          <td> String </td>
          <td> Yes </td>
          <td> Property name </td>
        </tr>
        <tr>
          <td> <code>values</code> </td>
          <td> List<String>
          </td>
          <td> Yes </td>
          <td> Allowed values (OR logic) </td>
        </tr>
        <tr>
          <td> <code>caseSensitiveName</code> </td>
          <td> Boolean </td>
          <td> No </td>
          <td> Override global name case sensitivity </td>
        </tr>
        <tr>
          <td> <code>caseSensitiveValue</code> </td>
          <td> Boolean </td>
          <td> No </td>
          <td> Override global value case sensitivity </td>
        </tr>
        <br>
        <h3>Optional Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Default </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>delimiter</code> </td>
          <td> String </td>
          <td> <code>=</code> </td>
          <td> Property delimiter </td>
        </tr>
        <tr>
          <td> <code>caseSensitiveNames</code> </td>
          <td> Boolean </td>
          <td> <code>true</code> </td>
          <td> Global case sensitivity for property names </td>
        </tr>
        <tr>
          <td> <code>caseSensitiveValues</code> </td>
          <td> Boolean </td>
          <td> <code>true</code> </td>
          <td> Global case sensitivity for property values </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Validate Log Level</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-130"</li>
  name: "Production Log Level"
  description: "Production must use INFO or WARN log level"
  enabled: true
  severity: HIGH
  checks:
    - type: MANDATORY_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["PROD"]
        properties:
          - name: "log.level"
            values: ["INFO", "WARN"]
</code></pre>
        <br>
        <h3>Example 2: Multiple Properties</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-131"</li>
  name: "Required Environment Configuration"
  description: "Validate required environment properties"
  enabled: true
  severity: HIGH
  checks:
    - type: MANDATORY_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["DEV", "QA", "PROD"]
        properties:
          - name: "environment.type"
            values: ["DEV", "QA", "PROD"]
          - name: "ssl.enabled"
            values: ["true"]
          - name: "timeout.seconds"
            values: ["30", "60", "120"]
</code></pre>
        <br>
        <h3>Example 3: Case-Insensitive Values</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-132"</li>
  name: "Boolean Property Validation"
  description: "Validate boolean properties accept various formats"
  enabled: true
  severity: MEDIUM
  checks:
    - type: MANDATORY_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["ALL"]
        caseSensitiveValues: false
        properties:
          - name: "debug.enabled"
            values: ["true", "false", "yes", "no"]
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
PROD.properties: Property 'log.level' not found in file
DEV.properties: Property 'ssl.enabled' found but value does not match expected values [true]
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[OPTIONAL_PROPERTY_VALUE_CHECK](OPTIONAL_PROPERTY_VALUE_CHECK.md)</strong> - Validates optional
          properties</li>
        <li><strong>[MANDATORY_SUBSTRING_CHECK](MANDATORY_SUBSTRING_CHECK.md)</strong> - Simpler substring validation
        </li>
      </div>
      <div id='MANDATORY_SUBSTRING_CHECK' class='rule-content' style='display: none;'>
        <h1>MANDATORY_SUBSTRING_CHECK</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that <strong>required or forbidden tokens exist</strong> in environment-specific configuration files.
        This is a config-specific rule that filters files by environment name.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Ensure required configuration keys exist in environment files</li>
        <li>Prevent forbidden values in specific environments</li>
        <li>Validate environment-specific property files</li>
        <li>Enforce configuration standards across environments</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>fileExtensions</code> </td>
          <td> List<String>
          </td>
          <td> File extensions to check (e.g., <code>.properties</code>, <code>.yaml</code>) </td>
        </tr>
        <tr>
          <td> <code>tokens</code> </td>
          <td> List<String>
          </td>
          <td> List of tokens to search for </td>
        </tr>
        <tr>
          <td> <code>environments</code> </td>
          <td> List<String>
          </td>
          <td> Environment names (file basenames) to check </td>
        </tr>
        <br>
        <h3>Optional Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Default </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>searchMode</code> </td>
          <td> String </td>
          <td> <code>REQUIRED</code> </td>
          <td> <code>REQUIRED</code> (tokens must exist) or <code>FORBIDDEN</code> (tokens must NOT exist) </td>
        </tr>
        <tr>
          <td> <code>caseSensitive</code> </td>
          <td> Boolean </td>
          <td> <code>true</code> </td>
          <td> Whether token matching is case-sensitive </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Ensure Required Properties</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-120"</li>
  name: "Required API Configuration"
  description: "All environment property files must have apiId"
  enabled: true
  severity: HIGH
  checks:
    - type: MANDATORY_SUBSTRING_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["DEV", "QA", "PROD"]
        tokens: ["apiId", "clientId"]
        searchMode: REQUIRED
</code></pre>
        <br>
        <h3>Example 2: Block Forbidden Values</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-121"</li>
  name: "No Debug Mode in Production"
  description: "Production properties must not have debug=true"
  enabled: true
  severity: CRITICAL
  checks:
    - type: MANDATORY_SUBSTRING_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["PROD"]
        tokens: ["debug=true", "verbose=true"]
        searchMode: FORBIDDEN
</code></pre>
        <br>
        <h3>Example 3: Case-Insensitive Search</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-122"</li>
  name: "SSL Configuration Required"
  description: "All environments must have SSL configuration"
  enabled: true
  severity: HIGH
  checks:
    - type: MANDATORY_SUBSTRING_CHECK
      params:
        fileExtensions: [".properties", ".yaml"]
        environments: ["ALL"]  # Will be expanded to global environments list
        tokens: ["ssl", "tls", "https"]
        searchMode: REQUIRED
        caseSensitive: false
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
DEV.properties: Required token 'apiId' not found in file
PROD.properties: Forbidden token 'debug=true' found in file
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[GENERIC_TOKEN_SEARCH_REQUIRED](GENERIC_TOKEN_SEARCH_REQUIRED.md)</strong> - More flexible token
          search without environment filtering</li>
        <li><strong>[MANDATORY_PROPERTY_VALUE_CHECK](MANDATORY_PROPERTY_VALUE_CHECK.md)</strong> - Validates property
          name-value pairs</li>
      </div>
      <div id='OPTIONAL_PROPERTY_VALUE_CHECK' class='rule-content' style='display: none;'>
        <h1>OPTIONAL_PROPERTY_VALUE_CHECK</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates <strong>optional property values</strong> in configuration files. If property does NOT exist ‚Üí PASS.
        If property exists ‚Üí value must match allowed values.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Validate optional configuration when present</li>
        <li>Ensure correct values for optional properties</li>
        <li>Allow flexibility while enforcing correctness</li>
        <li>Check conditional configuration</li>
        <br>
        <h2>Parameters</h2>
        <br>
        Same as [MANDATORY_PROPERTY_VALUE_CHECK](MANDATORY_PROPERTY_VALUE_CHECK.md), but with different validation
        logic.
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>fileExtensions</code> </td>
          <td> List<String>
          </td>
          <td> File extensions to check </td>
        </tr>
        <tr>
          <td> <code>environments</code> </td>
          <td> List<String>
          </td>
          <td> Environment names to check </td>
        </tr>
        <tr>
          <td> <code>properties</code> </td>
          <td> List<Map> </td>
          <td> List of optional property configurations </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Optional Debug Configuration</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-140"</li>
  name: "Optional Debug Configuration"
  description: "If debug property exists, it must be true or false"
  enabled: true
  severity: MEDIUM
  checks:
    - type: OPTIONAL_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["ALL"]
        properties:
          - name: "debug.enabled"
            values: ["true", "false"]
</code></pre>
        <br>
        <h3>Example 2: Optional Cache Settings</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-141"</li>
  name: "Optional Cache Configuration"
  description: "If cache.type exists, validate allowed values"
  enabled: true
  severity: LOW
  checks:
    - type: OPTIONAL_PROPERTY_VALUE_CHECK
      params:
        fileExtensions: [".properties"]
        environments: ["DEV", "QA", "PROD"]
        properties:
          - name: "cache.type"
            values: ["memory", "redis", "none"]
          - name: "cache.ttl"
            values: ["300", "600", "1800", "3600"]
</code></pre>
        <br>
        <h2>Validation Logic</h2>
        <br>
        <li><strong>Property NOT found</strong> ‚Üí ‚úÖ PASS (optional, so absence is OK)</li>
        <li><strong>Property found with valid value</strong> ‚Üí ‚úÖ PASS</li>
        <li><strong>Property found with invalid value</strong> ‚Üí ‚ùå FAIL</li>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
DEV.properties: Optional property 'debug.enabled' found but value does not match expected values [true, false]
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[MANDATORY_PROPERTY_VALUE_CHECK](MANDATORY_PROPERTY_VALUE_CHECK.md)</strong> - For required
          properties</li>
        <li><strong>[MANDATORY_SUBSTRING_CHECK](MANDATORY_SUBSTRING_CHECK.md)</strong> - Simpler substring validation
        </li>
      </div>
      <div id='POM_VALIDATION_FORBIDDEN' class='rule-content' style='display: none;'>
        <h1>POM_VALIDATION_FORBIDDEN</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that <strong>forbidden elements do NOT exist</strong> in Maven POM files. This rule
        <strong>fails</strong> if forbidden POM elements <strong>ARE found</strong>.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Prevent deprecated dependencies</li>
        <li>Block specific Maven plugins</li>
        <li>Disallow snapshot versions in production</li>
        <li>Enforce dependency restrictions</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>forbiddenElements</code> </td>
          <td> List<Map> </td>
          <td> List of forbidden POM elements with optional value patterns </td>
        </tr>
        <br>
        <h4>Forbidden Element Map Structure</h4>
        <br>
        <tr>
          <td> Field </td>
          <td> Type </td>
          <td> Required </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>element</code> </td>
          <td> String </td>
          <td> Yes </td>
          <td> POM element path </td>
        </tr>
        <tr>
          <td> <code>values</code> </td>
          <td> List<String>
          </td>
          <td> No </td>
          <td> If specified, only fail if element has one of these values </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Block Deprecated Dependencies</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-090"</li>
  name: "No Deprecated Mule Transports"
  description: "Prevent usage of deprecated Mule 3 transports"
  enabled: true
  severity: HIGH
  checks:
    - type: POM_VALIDATION_FORBIDDEN
      params:
        forbiddenElements:
          - element: "dependencies/dependency/artifactId"
            values: ["mule-transport-http", "mule-transport-vm", "mule-transport-jms"]
</code></pre>
        <br>
        <h3>Example 2: Block Snapshot Versions</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-091"</li>
  name: "No Snapshot Dependencies"
  description: "Production builds must not use SNAPSHOT versions"
  enabled: true
  severity: CRITICAL
  checks:
    - type: POM_VALIDATION_FORBIDDEN
      params:
        forbiddenElements:
          - element: "dependencies/dependency/version"
            values: [".*-SNAPSHOT"]  # Regex pattern
</code></pre>
        <br>
        <h3>Example 3: Prevent Specific Plugins</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-092"</li>
  name: "No Exec Maven Plugin"
  description: "Prevent usage of exec-maven-plugin for security reasons"
  enabled: true
  severity: HIGH
  checks:
    - type: POM_VALIDATION_FORBIDDEN
      params:
        forbiddenElements:
          - element: "build/plugins/plugin/artifactId"
            values: ["exec-maven-plugin"]
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
pom.xml has forbidden element: dependencies/dependency/artifactId with value: mule-transport-http
pom.xml has forbidden element: dependencies/dependency/version with value: 1.0.0-SNAPSHOT
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[POM_VALIDATION_REQUIRED](POM_VALIDATION_REQUIRED.md)</strong> - Opposite: ensures elements DO exist
        </li>
        <li><strong>[XML_XPATH_NOT_EXISTS](XML_XPATH_NOT_EXISTS.md)</strong> - More complex XPath-based POM validation
        </li>
      </div>
      <div id='POM_VALIDATION_REQUIRED' class='rule-content' style='display: none;'>
        <h1>POM_VALIDATION_REQUIRED</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that <strong>required elements exist</strong> in Maven POM files (<code>pom.xml</code>). This rule
        <strong>fails</strong> if required POM elements are <strong>NOT found</strong>.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Ensure required dependencies are declared</li>
        <li>Validate Maven plugin configurations</li>
        <li>Check for mandatory project metadata</li>
        <li>Enforce dependency management standards</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>requiredElements</code> </td>
          <td> List<Map> </td>
          <td> List of required POM elements with optional value validation </td>
        </tr>
        <br>
        <h4>Required Element Map Structure</h4>
        <br>
        <tr>
          <td> Field </td>
          <td> Type </td>
          <td> Required </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>element</code> </td>
          <td> String </td>
          <td> Yes </td>
          <td> POM element path (e.g., <code>dependencies/dependency/groupId</code>) </td>
        </tr>
        <tr>
          <td> <code>values</code> </td>
          <td> List<String>
          </td>
          <td> No </td>
          <td> If specified, element value must match one of these </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Ensure Required Dependency</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-080"</li>
  name: "Mule HTTP Connector Required"
  description: "All projects must include Mule HTTP connector"
  enabled: true
  severity: HIGH
  checks:
    - type: POM_VALIDATION_REQUIRED
      params:
        requiredElements:
          - element: "dependencies/dependency/artifactId"
            values: ["mule-http-connector"]
</code></pre>
        <br>
        <h3>Example 2: Validate Maven Compiler Plugin</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-081"</li>
  name: "Maven Compiler Plugin Configuration"
  description: "Ensure Maven compiler plugin is configured with Java 17"
  enabled: true
  severity: MEDIUM
  checks:
    - type: POM_VALIDATION_REQUIRED
      params:
        requiredElements:
          - element: "build/plugins/plugin/artifactId"
            values: ["maven-compiler-plugin"]
          - element: "build/plugins/plugin/configuration/source"
            values: ["17"]
          - element: "build/plugins/plugin/configuration/target"
            values: ["17"]
</code></pre>
        <br>
        <h3>Example 3: Check Project Metadata</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-082"</li>
  name: "Project Metadata Complete"
  description: "POM must have required project metadata"
  enabled: true
  severity: LOW
  checks:
    - type: POM_VALIDATION_REQUIRED
      params:
        requiredElements:
          - element: "groupId"
          - element: "artifactId"
          - element: "version"
          - element: "name"
          - element: "description"
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
pom.xml is missing required element: dependencies/dependency/artifactId with value: mule-http-connector
pom.xml is missing required element: build/plugins/plugin/configuration/source
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[POM_VALIDATION_FORBIDDEN](POM_VALIDATION_FORBIDDEN.md)</strong> - Opposite: ensures elements do NOT
          exist</li>
        <li><strong>[XML_XPATH_EXISTS](XML_XPATH_EXISTS.md)</strong> - More complex XPath-based POM validation</li>
      </div>
      <div id='XML_ATTRIBUTE_EXISTS' class='rule-content' style='display: none;'>
        <h1>XML_ATTRIBUTE_EXISTS</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that <strong>required XML attributes exist</strong> on specified elements. This rule is highly
        flexible and <strong>fails</strong> if required attributes or values are <strong>NOT found</strong>.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Ensure flow elements have required attributes (name, doc:id)</li>
        <li>Validate configuration completeness (cipher suites, protocols)</li>
        <li>Enforce naming conventions (e.g., specific values for specific attributes)</li>
        <li>Check that elements contain specific attribute combinations</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>filePatterns</code> </td>
          <td> List<String>
          </td>
          <td> Glob patterns to match XML files (e.g., <code>src/main/mule/*.xml</code>) </td>
        </tr>
        <br>
        <h3>Modes (Must configure at least one)</h3>
        <br>
        This rule supports three distinct validation modes. You can combine them in a single check.
        <br>
        <h4>Mode 1: Simple Attribute Existence</h4>
        Checks if a list of <code>elements</code> each contain all the specified <code>attributes</code>.
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>elements</code> </td>
          <td> List<String>
          </td>
          <td> XML element names to check </td>
        </tr>
        <tr>
          <td> <code>attributes</code> </td>
          <td> List<String>
          </td>
          <td> List of attributes that MUST exist on the elements </td>
        </tr>
        <br>
        <h4>Mode 2: Attribute Value Pairs</h4>
        Checks if elements contain specific attributes with specific <strong>values</strong>.
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>attributeValuePairs</code> </td>
          <td> List<Map> </td>
          <td> List of value checks </td>
        </tr>
        <br>
        <strong>Map Structure:</strong>
        <li><code>element</code>: Element name</li>
        <li><code>attribute</code>: Attribute name</li>
        <li><code>expectedValue</code>: The required value</li>
        <br>
        <h4>Mode 3: Element Attribute Sets</h4>
        Checks if an element contains a specific <strong>combination</strong> of attributes and values.
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>elementAttributeSets</code> </td>
          <td> List<Map> </td>
          <td> List of complex attribute set checks </td>
        </tr>
        <br>
        <strong>Map Structure:</strong>
        <li><code>element</code>: Element name</li>
        <li><code>attributes</code>: Map of <code>attributeName</code> -> <code>expectedValue</code></li>
        <br>
        <h3>Optional Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Default </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>caseSensitive</code> </td>
          <td> Boolean </td>
          <td> <code>true</code> </td>
          <td> Case sensitivity for values </td>
        </tr>
        <tr>
          <td> <code>propertyResolution</code> </td>
          <td> Boolean </td>
          <td> <code>false</code> </td>
          <td> If <code>true</code>, allows <code>${property}</code> placeholders as valid matches for expected values
          </td>
        </tr>
        <tr>
          <td> <code>shouldIgnorePath</code> </td>
          <td> Internal </td>
          <td> N/A </td>
          <td> Automatically ignores target, bin, .git, etc. </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Simple Existence (Mode 1)</h3>
        Ensure <code>crypto:jce-config</code> has a <code>type</code> attribute.
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-013"</li>
  name: "Check for 'type' attribute in crypto"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_ATTRIBUTE_EXISTS
      params:
        filePatterns: ["src/main/mule/*.xml"]
        elements: ["crypto:jce-config"]
        attributes: ["type"]
</code></pre>
        <br>
        <h3>Example 2: Attribute Value Validation (Mode 3)</h3>
        Ensure IBM MQ Connector uses a specific Cipher Suite. Note strict value checking.
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-005" </li>
  name: "Validate IBM MQ Connector Cipher Suite"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_ATTRIBUTE_EXISTS
      params:
        filePatterns: ["src/main/mule/*.xml"]
        propertyResolution: true
        elementAttributeSets:
          - element: "ibm:connection"
            attributes:
              cipherSuite: "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"
</code></pre>
        <br>
        <h3>Example 3: Property Placeholder Support</h3>
        Allow attributes to be set via property placeholders (e.g., <code>${http.port}</code>).
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-015" </li>
  name: "Validate HTTP Listener Path"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_ATTRIBUTE_EXISTS
      params:
        filePatterns: ["src/main/mule/*.xml"]
        propertyResolution: true
        elementAttributeSets:
          - element: "http:listener"
            attributes:
              path: "/test"
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
Element 'crypto:jce-config' missing attribute 'type' in file: src/main/mule/global.xml
Element 'ibm:connection' with required attributes {cipherSuite=TLS...} not found in file: src/main/mule/mq.xml
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[XML_ATTRIBUTE_NOT_EXISTS](XML_ATTRIBUTE_NOT_EXISTS.md)</strong> - Opposite: ensures attributes do
          NOT exist</li>
      </div>
      <div id='XML_ATTRIBUTE_NOT_EXISTS' class='rule-content' style='display: none;'>
        <h1>XML_ATTRIBUTE_NOT_EXISTS</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that <strong>forbidden XML attributes do NOT exist</strong> on specified elements. This rule
        <strong>fails</strong> if any of the specified forbidden attributes are found on the target elements.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Detect deprecated attributes (e.g., legacy code flags)</li>
        <li>Enforce cleanup of temporary or forbidden configuration</li>
        <li>Prevent usage of insecure or problematic attribute settings</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>filePatterns</code> </td>
          <td> List<String>
          </td>
          <td> Glob patterns to match XML files </td>
        </tr>
        <tr>
          <td> <code>elements</code> </td>
          <td> List<String>
          </td>
          <td> List of XML element names to scan </td>
        </tr>
        <tr>
          <td> <code>forbiddenAttributes</code> </td>
          <td> List<String>
          </td>
          <td> List of attributes that must NOT be present </td>
        </tr>
        <br>
        <h3>Optional Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Default </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>shouldIgnorePath</code> </td>
          <td> Internal </td>
          <td> N/A </td>
          <td> Automatically ignores target, bin, .git, etc. </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Remove Legacy Attributes</h3>
        Ensure no elements contain attributes related to legacy application code tracking.
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-010"</li>
  name: "Remove unsupported from/to ApplicationCode"
  description: "Scans for legacy tracking attributes"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_ATTRIBUTE_NOT_EXISTS
      params:
        filePatterns: ["src/main/mule/*.xml"]
        elements:
          - "request_in"
          - "request_out"
          - "ee:transform"
        forbiddenAttributes:
          - "fromApplicationCode"
          - "toApplicationCode"
          - "legacyFlag"
</code></pre>
        <br>
        <h3>Example 2: Clean up Connector Attributes</h3>
        Ensure <code>doc:id</code> is not present if manual ID management is forbidden (example).
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-099"</li>
  name: "No Manual IDs"
  enabled: true
  checks:
    - type: XML_ATTRIBUTE_NOT_EXISTS
      params:
        filePatterns: ["src/main/mule/*.xml"]
        elements: ["http:listener"]
        forbiddenAttributes: ["doc:id"]
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
Forbidden attribute 'fromApplicationCode' found on element 'request_in' in file: src/main/mule/common.xml
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[XML_ATTRIBUTE_EXISTS](XML_ATTRIBUTE_EXISTS.md)</strong> - Opposite: ensures attributes DO exist
        </li>
      </div>
      <div id='XML_ELEMENT_CONTENT_FORBIDDEN' class='rule-content' style='display: none;'>
        <h1>XML_ELEMENT_CONTENT_FORBIDDEN</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that XML elements do <strong>NOT contain forbidden content/tokens</strong>. This rule
        <strong>fails</strong> if forbidden content <strong>IS found</strong> in the element's text content.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Prevent deprecated values or patterns</li>
        <li>Block hardcoded credentials in element content</li>
        <li>Disallow specific configuration values</li>
        <li>Enforce content restrictions</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>filePatterns</code> </td>
          <td> List<String>
          </td>
          <td> Glob patterns to match XML files </td>
        </tr>
        <tr>
          <td> <code>elementContentPairs</code> </td>
          <td> List<Map> </td>
          <td> Element names with their forbidden content tokens </td>
        </tr>
        <br>
        <h4>Element Content Pair Map Structure</h4>
        <br>
        <tr>
          <td> Field </td>
          <td> Type </td>
          <td> Required </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>element</code> </td>
          <td> String </td>
          <td> Yes </td>
          <td> XML element name </td>
        </tr>
        <tr>
          <td> <code>forbiddenTokens</code> </td>
          <td> List<String>
          </td>
          <td> Yes </td>
          <td> Tokens that must NOT be present </td>
        </tr>
        <br>
        <h3>Optional Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Default </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>matchMode</code> </td>
          <td> String </td>
          <td> <code>SUBSTRING</code> </td>
          <td> <code>SUBSTRING</code> or <code>REGEX</code> </td>
        </tr>
        <tr>
          <td> <code>caseSensitive</code> </td>
          <td> Boolean </td>
          <td> <code>true</code> </td>
          <td> Case sensitivity for content matching </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Block Hardcoded Passwords</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-070"</li>
  name: "No Hardcoded Passwords in Config"
  description: "Prevent hardcoded passwords in configuration elements"
  enabled: true
  severity: CRITICAL
  checks:
    - type: XML_ELEMENT_CONTENT_FORBIDDEN
      params:
        filePatterns:
          - "**/*.xml"
        elementContentPairs:
          - element: "password"
            forbiddenTokens: ["admin", "password123", "default"]
          - element: "secret"
            forbiddenTokens: ["hardcoded"]
</code></pre>
        <br>
        <h3>Example 2: Block Deprecated Values</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-071"</li>
  name: "No Deprecated Log Levels"
  description: "Prevent usage of deprecated log level values"
  enabled: true
  severity: MEDIUM
  checks:
    - type: XML_ELEMENT_CONTENT_FORBIDDEN
      params:
        filePatterns:
          - "src/main/mule/**/*.xml"
        elementContentPairs:
          - element: "logger"
            forbiddenTokens: ["TRACE", "ALL"]
</code></pre>
        <br>
        <h3>Example 3: Block IP Addresses (Regex)</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-072"</li>
  name: "No Hardcoded IPs in Endpoints"
  description: "Prevent hardcoded IP addresses in endpoint URLs"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_ELEMENT_CONTENT_FORBIDDEN
      params:
        filePatterns:
          - "**/*.xml"
        elementContentPairs:
          - element: "http:request"
            forbiddenTokens: ["\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b"]
        matchMode: REGEX
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
config.xml element 'password' has forbidden content: admin
main-flow.xml element 'logger' has forbidden content: TRACE
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[XML_ELEMENT_CONTENT_REQUIRED](XML_ELEMENT_CONTENT_REQUIRED.md)</strong> - Opposite: ensures content
          DOES exist</li>
        <li><strong>[XML_XPATH_NOT_EXISTS](XML_XPATH_NOT_EXISTS.md)</strong> - More complex XPath-based validation</li>
      </div>
      <div id='XML_ELEMENT_CONTENT_REQUIRED' class='rule-content' style='display: none;'>
        <h1>XML_ELEMENT_CONTENT_REQUIRED</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that XML elements contain <strong>required content/tokens</strong>. This rule <strong>fails</strong>
        if required content is <strong>NOT found</strong> in the element's text content.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Ensure specific values or patterns exist in element content</li>
        <li>Validate configuration values</li>
        <li>Check for required documentation or comments</li>
        <li>Enforce content standards</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>filePatterns</code> </td>
          <td> List<String>
          </td>
          <td> Glob patterns to match XML files </td>
        </tr>
        <tr>
          <td> <code>elementContentPairs</code> </td>
          <td> List<Map> </td>
          <td> Element names with their required content tokens </td>
        </tr>
        <br>
        <h4>Element Content Pair Map Structure</h4>
        <br>
        <tr>
          <td> Field </td>
          <td> Type </td>
          <td> Required </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>element</code> </td>
          <td> String </td>
          <td> Yes </td>
          <td> XML element name </td>
        </tr>
        <tr>
          <td> <code>requiredTokens</code> </td>
          <td> List<String>
          </td>
          <td> Yes </td>
          <td> Tokens that must be present in element content </td>
        </tr>
        <br>
        <h3>Optional Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Default </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>matchMode</code> </td>
          <td> String </td>
          <td> <code>SUBSTRING</code> </td>
          <td> <code>SUBSTRING</code> or <code>REGEX</code> </td>
        </tr>
        <tr>
          <td> <code>caseSensitive</code> </td>
          <td> Boolean </td>
          <td> <code>true</code> </td>
          <td> Case sensitivity for content matching </td>
        </tr>
        <tr>
          <td> <code>requireAll</code> </td>
          <td> Boolean </td>
          <td> <code>true</code> </td>
          <td> If <code>true</code>, ALL tokens must be found. If <code>false</code>, at least ONE </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Validate Logger Messages</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-060"</li>
  name: "Logger Messages Must Be Descriptive"
  description: "Logger messages must contain specific keywords"
  enabled: true
  severity: LOW
  checks:
    - type: XML_ELEMENT_CONTENT_REQUIRED
      params:
        filePatterns:
          - "src/main/mule/**/*.xml"
        elementContentPairs:
          - element: "logger"
            requiredTokens: ["Flow", "Request", "Response"]
        requireAll: false  # At least one keyword
</code></pre>
        <br>
        <h3>Example 2: Validate Documentation</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-061"</li>
  name: "Flow Documentation Required"
  description: "Flow doc:description must contain specific information"
  enabled: true
  severity: MEDIUM
  checks:
    - type: XML_ELEMENT_CONTENT_REQUIRED
      params:
        filePatterns:
          - "**/*.xml"
        elementContentPairs:
          - element: "doc:description"
            requiredTokens: ["Purpose:", "Input:", "Output:"]
        requireAll: true
</code></pre>
        <br>
        <h3>Example 3: Regex Pattern Matching</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-062"</li>
  name: "Version Format in Description"
  description: "Description must include version number"
  enabled: true
  severity: LOW
  checks:
    - type: XML_ELEMENT_CONTENT_REQUIRED
      params:
        filePatterns:
          - "**/pom.xml"
        elementContentPairs:
          - element: "description"
            requiredTokens: ["v\\d+\\.\\d+"]  # Regex: vX.Y
        matchMode: REGEX
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        <pre><code>
config.xml element 'logger' is missing required tokens: Flow, Request, Response
main-flow.xml element 'doc:description' is missing required tokens: Purpose:, Input:, Output:
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[XML_ELEMENT_CONTENT_FORBIDDEN](XML_ELEMENT_CONTENT_FORBIDDEN.md)</strong> - Opposite: ensures
          content does NOT exist</li>
        <li><strong>[XML_XPATH_EXISTS](XML_XPATH_EXISTS.md)</strong> - More complex XPath-based validation</li>
      </div>
      <div id='XML_XPATH_EXISTS' class='rule-content' style='display: none;'>
        <h1>XML_XPATH_EXISTS</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that <strong>required XPath expressions match</strong> in XML files. This rule <strong>fails</strong>
        if any required XPath expression does <strong>NOT</strong> find matching nodes.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Verify specific XML elements or attributes exist</li>
        <li>Ensure required configuration is present in Mule flows</li>
        <li>Validate XML structure and hierarchy</li>
        <li>Check for mandatory namespaces or schemas</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>filePatterns</code> </td>
          <td> List<String>
          </td>
          <td> Glob patterns to match XML files </td>
        </tr>
        <tr>
          <td> <code>xpathExpressions</code> </td>
          <td> List<Map> </td>
          <td> List of XPath expressions with optional custom failure messages </td>
        </tr>
        <br>
        <h4>XPath Expression Map Structure</h4>
        <br>
        Each item in <code>xpathExpressions</code> can have:
        <br>
        <tr>
          <td> Field </td>
          <td> Type </td>
          <td> Required </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>xpath</code> </td>
          <td> String </td>
          <td> Yes </td>
          <td> The XPath expression to evaluate </td>
        </tr>
        <tr>
          <td> <code>failureMessage</code> </td>
          <td> String </td>
          <td> No </td>
          <td> Custom message if XPath doesn't match </td>
        </tr>
        <br>
        <h3>Optional Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Default </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>propertyResolution</code> </td>
          <td> Boolean </td>
          <td> <code>false</code> </td>
          <td> Enable <code>${property}</code> placeholder resolution </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Basic - Ensure Logger Exists</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-020"</li>
  name: "Logger Component Required"
  description: "Ensure all flows have a logger component"
  enabled: true
  severity: MEDIUM
  checks:
    - type: XML_XPATH_EXISTS
      params:
        filePatterns:
          - "src/main/mule/**/*.xml"
        xpathExpressions:
          - xpath: "//logger"
            failureMessage: "Flow must contain at least one logger component"
</code></pre>
        <br>
        <h3>Example 2: Check for Specific Attribute</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-021"</li>
  name: "Flow Name Attribute Required"
  description: "All flows must have a name attribute"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_EXISTS
      params:
        filePatterns:
          - "**/*-config.xml"
        xpathExpressions:
          - xpath: "//flow[@name]"
            failureMessage: "Flow element missing required 'name' attribute"
</code></pre>
        <br>
        <h3>Example 3: Multiple XPath Validations</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-022"</li>
  name: "Required Error Handling Structure"
  description: "Ensure proper error handling is configured"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_EXISTS
      params:
        filePatterns:
          - "src/main/mule/**/*.xml"
        xpathExpressions:
          - xpath: "//error-handler"
            failureMessage: "Missing error-handler element"
          - xpath: "//on-error-continue </td><td> //on-error-propagate"
            failureMessage: "Error handler must have on-error-continue or on-error-propagate"
</code></pre>
        <br>
        <h3>Example 4: Namespace-Aware XPath</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-023"</li>
  name: "HTTP Listener Configuration"
  description: "Ensure HTTP listener configuration exists"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_EXISTS
      params:
        filePatterns:
          - "**/global-config.xml"
        xpathExpressions:
          - xpath: "//*[local-name()='listener-config']"
            failureMessage: "Missing HTTP listener configuration"
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        When validation fails, you'll see messages like:
        <br>
        <pre><code>
config.xml: Flow must contain at least one logger component (found 0 occurrence(s))
main-flow.xml: Missing error-handler element (found 0 occurrence(s))
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[XML_XPATH_NOT_EXISTS](XML_XPATH_NOT_EXISTS.md)</strong> - Opposite: ensures XPath does NOT match
        </li>
        <li><strong>[XML_ATTRIBUTE_EXISTS](XML_ATTRIBUTE_EXISTS.md)</strong> - Simpler attribute validation</li>
        <li><strong>[XML_ELEMENT_CONTENT_REQUIRED](XML_ELEMENT_CONTENT_REQUIRED.md)</strong> - Validate element content
        </li>
      </div>
      <div id='XML_XPATH_NOT_EXISTS' class='rule-content' style='display: none;'>
        <h1>XML_XPATH_NOT_EXISTS</h1>
        <br>
        <h2>Overview</h2>
        <br>
        Validates that <strong>forbidden XPath expressions do NOT match</strong> in XML files. This rule
        <strong>fails</strong> if any forbidden XPath expression <strong>DOES</strong> find matching nodes.
        <br>
        <h2>Use Cases</h2>
        <br>
        <li>Prevent usage of deprecated XML elements</li>
        <li>Block specific configurations or patterns</li>
        <li>Enforce architectural constraints</li>
        <li>Disallow anti-patterns in Mule flows</li>
        <br>
        <h2>Parameters</h2>
        <br>
        <h3>Required Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>filePatterns</code> </td>
          <td> List<String>
          </td>
          <td> Glob patterns to match XML files </td>
        </tr>
        <tr>
          <td> <code>xpathExpressions</code> </td>
          <td> List<Map> </td>
          <td> List of XPath expressions that should NOT match </td>
        </tr>
        <br>
        <h4>XPath Expression Map Structure</h4>
        <br>
        <tr>
          <td> Field </td>
          <td> Type </td>
          <td> Required </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>xpath</code> </td>
          <td> String </td>
          <td> Yes </td>
          <td> The XPath expression to evaluate </td>
        </tr>
        <tr>
          <td> <code>failureMessage</code> </td>
          <td> String </td>
          <td> No </td>
          <td> Custom message if XPath matches (forbidden) </td>
        </tr>
        <br>
        <h3>Optional Parameters</h3>
        <br>
        <tr>
          <td> Parameter </td>
          <td> Type </td>
          <td> Default </td>
          <td> Description </td>
        </tr>
        <br>
        <tr>
          <td> <code>propertyResolution</code> </td>
          <td> Boolean </td>
          <td> <code>false</code> </td>
          <td> Enable <code>${property}</code> placeholder resolution </td>
        </tr>
        <br>
        <h2>Configuration Examples</h2>
        <br>
        <h3>Example 1: Block Deprecated Component</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-030"</li>
  name: "No Deprecated HTTP Transport"
  description: "Prevent usage of deprecated HTTP transport"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_NOT_EXISTS
      params:
        filePatterns:
          - "**/*.xml"
        xpathExpressions:
          - xpath: "//*[local-name()='http-transport']"
            failureMessage: "Deprecated HTTP transport found - use HTTP connector instead"
</code></pre>
        <br>
        <h3>Example 2: Prevent Hardcoded Values</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-031"</li>
  name: "No Hardcoded Hosts"
  description: "Prevent hardcoded host values in HTTP requests"
  enabled: true
  severity: MEDIUM
  checks:
    - type: XML_XPATH_NOT_EXISTS
      params:
        filePatterns:
          - "src/main/mule/**/*.xml"
        xpathExpressions:
          - xpath: "//http:request[@host='localhost']"
            failureMessage: "Hardcoded 'localhost' found - use property placeholders"
          - xpath: "//http:request[contains(@host, '192.168')]"
            failureMessage: "Hardcoded IP address found in host attribute"
</code></pre>
        <br>
        <h3>Example 3: Enforce Architectural Rules</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-032"</li>
  name: "No Direct Database Calls in API Layer"
  description: "API flows should not contain direct database operations"
  enabled: true
  severity: HIGH
  checks:
    - type: XML_XPATH_NOT_EXISTS
      params:
        filePatterns:
          - "src/main/mule/api-*.xml"
        xpathExpressions:
          - xpath: "//db:select </td><td> //db:insert </td><td> //db:update </td><td> //db:delete"
            failureMessage: "Direct database operations forbidden in API layer - use service layer"
</code></pre>
        <br>
        <h3>Example 4: Block Synchronous Processing</h3>
        <br>
        <pre><code class='language-yaml'>
<li>id: "RULE-033"</li>
  name: "No Synchronous VM Queues"
  description: "Prevent synchronous VM queue usage"
  enabled: true
  severity: MEDIUM
  checks:
    - type: XML_XPATH_NOT_EXISTS
      params:
        filePatterns:
          - "**/*.xml"
        xpathExpressions:
          - xpath: "//vm:publish[@sendCorrelationId='ALWAYS']"
            failureMessage: "Synchronous VM publish detected - use asynchronous pattern"
</code></pre>
        <br>
        <h2>Error Messages</h2>
        <br>
        When validation fails, you'll see messages like:
        <br>
        <pre><code>
config.xml: Deprecated HTTP transport found - use HTTP connector instead (found 2 occurrence(s))
api-main.xml: Direct database operations forbidden in API layer - use service layer (found 1 occurrence(s))
</code></pre>
        <br>
        <h2>Related Rule Types</h2>
        <br>
        <li><strong>[XML_XPATH_EXISTS](XML_XPATH_EXISTS.md)</strong> - Opposite: ensures XPath DOES match</li>
        <li><strong>[XML_ATTRIBUTE_NOT_EXISTS](XML_ATTRIBUTE_NOT_EXISTS.md)</strong> - Simpler attribute validation</li>
        <li><strong>[XML_ELEMENT_CONTENT_FORBIDDEN](XML_ELEMENT_CONTENT_FORBIDDEN.md)</strong> - Validate element
          content</li>
      </div>
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var path = window.location.pathname;
      var isMuleStatic = path.includes('/apiguard/muleguard/web/') || path.includes('/muleguard/web/');
      var isMuleReport = path.includes('/apiguard/muleguard/reports/') || path.includes('/muleguard/reports/');
      var dashboardBtn = document.getElementById('dashboardBtn');
      var mainPageBtn = document.getElementById('mainPageBtn');

      // Detect if we're in Mule wrapper (has /apiguard prefix) or standalone Java
      var isInMuleWrapper = path.includes('/apiguard/');
      var basePath = isInMuleWrapper ? '/apiguard/muleguard' : '/muleguard';

      // Session Handling
      var sessionId = new URLSearchParams(window.location.search).get('session');
      // If in report path, extract sessionId from path
      if (!sessionId && isMuleReport) {
        var reportPath = basePath + '/reports/';
        var parts = path.split(reportPath);
        if (parts.length > 1) {
          var subparts = parts[1].split('/');
          if (subparts.length > 0) sessionId = subparts[0];
        }
      }

      if (isMuleStatic || isMuleReport) {
        // We are in Mule Wrapper Environment
        if (mainPageBtn) {
          mainPageBtn.style.display = 'inline-block';
          // Build Main Page URL with correct base path
          var mainPageUrl = basePath + '/main';
          if (sessionId) mainPageUrl += '?session=' + sessionId;
          mainPageBtn.href = mainPageUrl;

          if (isMuleStatic) {
            mainPageBtn.style.right = '40px';
            if (dashboardBtn) dashboardBtn.style.display = 'none'; // No dashboard in static view
          } else {
            // In Mule Report
            mainPageBtn.style.right = '180px';
          }
        }
      } else {
        // Standalone Java or Local File - Main Page button stays hidden
        if (dashboardBtn) dashboardBtn.style.display = 'inline-block';
      }
    });
  </script>
</body>

</html>
```